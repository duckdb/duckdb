# name: test/issues/general/test_17891.test
# description: Issue 17891: JOIN fails on string columns in 1.3.0 but works in 1.2.2
# group: [general]

require parquet

statement ok
create view seqs_table_a as from 'data/parquet-testing/seqs_table.parquet';

statement ok
create view seqs_table_b as from 'data/parquet-testing/seqs_table.parquet';

query I
WITH orig AS (
    SELECT o.id
    FROM "seqs_table_a" AS o
    INNER JOIN "seqs_table_b" AS d
      ON d.key = o.key
),
dest AS (
    SELECT o.id
    FROM "seqs_table_b" AS o
    INNER JOIN "seqs_table_a" AS d
      ON d.key = o.key
),
orig_mm AS (
    SELECT a.id
    FROM "seqs_table_a" AS a
    LEFT JOIN orig AS o
      ON o.id = a.id
    WHERE o.id IS NULL
),
dest_mm AS (
    SELECT b.id
    FROM "seqs_table_b" AS b
    LEFT JOIN dest AS d
      ON d.id = b.id
    WHERE d.id IS NULL
)
SELECT CONCAT_WS(
         ' - ',
         'orig',
         o.id
       ) AS mismatch
FROM orig_mm AS o
UNION
SELECT CONCAT_WS(
         ' - ',
         'dest',
         d.id
       ) AS mismatch
FROM dest_mm AS d
----

