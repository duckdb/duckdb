# name: test/optimizer/join_elimination.test
# description: test join elimination 
# group: [optimizer]

statement ok
PRAGMA enable_verification;

statement ok
create table a(ida int, valuea int);

statement ok
create table b(idb int, valueb int);

statement ok
create table c(idc int, valuec int);

statement ok
insert into a values (1,1), (2,2), (1,1),(NUll, NULL),(3, NULL),(NULL,4);

statement ok
insert into b values (1,1), (2,2), (3,3),(4,4),(3,3),(NUll, NULL),(3, NULL),(NULL,4);

statement ok
insert into c values (1,1), (2,2), (3,3),(4,4),(3,3),(NUll, NULL),(3, NULL),(NULL,4);

query II
explain select distinct b.* from b left join a on a.ida=b.idb;
----
physical_plan	<!REGEX>:.*JOIN.*

query II
explain select distinct b.* from b left join a on a.ida=b.idb where b.valueb=1;
----
physical_plan	<!REGEX>:.*JOIN.*

query II
explain select distinct b.* from b left join a on a.ida=b.idb where a.valuea=1;
----
physical_plan	<REGEX>:.*JOIN.*

query II
explain select  b.* from b left join (select distinct ida as ida from a) as a1 on a1.ida=b.idb;
----
physical_plan	<!REGEX>:.*JOIN.*

query II
explain select  b.* from b left join (select * from a group by all) as a1 on b.idb=a1.ida;
----
physical_plan	<REGEX>:.*JOIN.*

query II
explain select  b.* from b left join (select distinct ida as ida from a) as a1 on a1.ida=b.idb and a1.ida = 1;
----
physical_plan	<REGEX>:.*JOIN.*

query II
explain select  b.* from b left join (select distinct ida as ida from a) as a1 on a1.ida=b.idb and a1.ida = b.valueb ;
----
physical_plan	<!REGEX>:.*JOIN.*

query II
explain select  b.* from b left join (select distinct ida as ida from a) as a1 on a1.ida=b.idb or a1.ida = 1 ;
----
physical_plan	<REGEX>:.*JOIN.*

query II
explain select b.*, a.* from b left join a on a.ida=b.idb;
----
physical_plan	<REGEX>:.*JOIN.*

query II
explain select b.* from b left join a on a.ida=b.idb+1;
----
physical_plan	<REGEX>:.*JOIN.*
