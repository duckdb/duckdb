# name: test/sql/copy/encryption/different_aes_engines.test
# group: [encryption]

foreach cipher GCM CTR

statement ok
ATTACH '__TEST_DIR__/enc_test_${cipher}.db' as enc (ENCRYPTION_KEY 'asdf', ENCRYPTION_CIPHER '${cipher}');

statement ok
CREATE TABLE enc.test (a INTEGER, b INTEGER);

statement ok
INSERT INTO enc.test VALUES (11, 22), (13, 22), (12, 21)

statement ok
DETACH enc

restart

require httpfs

statement ok
ATTACH '__TEST_DIR__/enc_test_${cipher}.db' as enc (ENCRYPTION_KEY 'asdf');


query II
FROM enc.test
----
11	22
13	22
12	21


restart

endloop


foreach cipher GCM CTR

require httpfs

statement ok
ATTACH '__TEST_DIR__/enc_test_${cipher}.db' as enc (ENCRYPTION_KEY 'asdf', ENCRYPTION_CIPHER '${cipher}');

statement ok
CREATE TABLE enc.test (a INTEGER, b INTEGER);

statement ok
INSERT INTO enc.test VALUES (11, 22), (13, 22), (12, 21)

statement ok
DETACH enc

restart

statement ok
ATTACH '__TEST_DIR__/enc_test_${cipher}.db' as enc (ENCRYPTION_KEY 'asdf');

query II
FROM enc.test
----
11	22
13	22
12	21


restart


endloop
