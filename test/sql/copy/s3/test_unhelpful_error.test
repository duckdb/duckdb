# name: test/sql/copy/s3/test_unhelpful_error.test
# group: [s3]

require parquet

#require httpfs

##single, non-existent table, https, parquet
statement error
SELECT * FROM read_parquet('https://<domain>/path/to/file.parquet');
----
IO Error: No files found that match the pattern "https://<domain>/path/to/file.parquet", because the httpfs extension is not loaded

##single, non-existent table, s3
statement error
SELECT * FROM parquet_scan('s3://bucket/file.extension');
----
IO Error: No files found that match the pattern "s3://bucket/file.extension", because the httpfs extension is not loaded

##single, existent table, https, parquet
statement error
SELECT * FROM read_parquet('https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet');
----
IO Error: No files found that match the pattern "https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet", because the httpfs extension is not loaded

##multiple tables, https
statement error
SELECT * FROM read_parquet(['https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet', 'https://github.com/lverdoes/duckdb/blob/master/data/parquet-testing/complex.parquet']);
----
IO Error: No files found that match the pattern "https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet", because the httpfs extension is not loaded

##multiple tables, http, parquet
statement error
SELECT * FROM read_parquet(['http://github.com/lverdoes/duckdb/blob/master/data/parquet-testing/complex.parquet', 'https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet']);
----
IO Error: No files found that match the pattern "http://github.com/lverdoes/duckdb/blob/master/data/parquet-testing/complex.parquet", because the httpfs extension is not loaded

statement error
Select * FROM 'https://github.com/lverdoes/duckdb/blob/master/data/csv/customer.csv';
----
IO Error: No files found that match the pattern "https://github.com/lverdoes/duckdb/blob/master/data/csv/customer.csv", because the httpfs extension is not loaded

require json

statement error
select * from read_json_objects('https://github.com/lverdoes/duckdb/blob/master/data/json/example_n.ndjson');
----
IO Error: No files found that match the pattern "https://github.com/lverdoes/duckdb/blob/master/data/json/example_n.ndjson", because the httpfs extension is not loaded



require httpfs

statement error
SELECT * FROM read_parquet('https://<domain>/path/to/file.parquet');
----
IO Error: Connection error for HTTP HEAD to 'https://<domain>/path/to/file.parquet'

statement ok
SELECT COUNT(*) FROM read_parquet('https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata1.parquet');

statement error
SELECT * FROM read_parquet("https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata42.parquet");
----
IO Error: Unable to connect to URL "https://raw.githubusercontent.com/cwida/duckdb/master/data/parquet-testing/userdata42.parquet": 404 (Not Found)

statement error
Select * FROM 'https://github.com/lverdoes/duckdb/blob/master/data/csv/customer.csv';
----
Invalid Input Error: Error in file "https://github.com/lverdoes/duckdb/blob/master/data/csv/customer.csv": CSV options could not be auto-detected. Consider setting parser options manually.

statement ok
select * from read_json_objects('https://github.com/lverdoes/duckdb/blob/master/data/json/example_n.ndjson');