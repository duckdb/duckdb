# name: test/sql/copy/parquet/aws_kinesis.test
# description: Read a file created by AWS Kinesis Firehose DeliveryStreams (#3981)
# group: [parquet]

require parquet

statement ok
PRAGMA enable_verification

query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM '{DATA_DIR}/parquet-testing/aws_kinesis.parquet'
----
2022	11	22	2022-11-22 00:01:00.871	2022-11-22 00:01:01	-129	Hamburg	NULL	Germany	53.6304	9.98823	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	http://localhost:3000/	/	t=tr&ts=1669075260871&u=http%253A%252F%252Flocalhost%253A3000%252F&hn=localhost&pa=%252F&en=tabVisible&pr=%257B%257D	495	200	Hit	0	3320	NULL	tabVisible	NULL	NULL	NULL	de3bc04229406da23ee45e234a42a66cc542b335517ab585ca43f55cd2dcf781	3bc2c0a60f9f2dd212db07ed80e817f9dd43aa999d16b0b2b8db91ab092a8102	ab40d20596d7595049399578929ffc598abdb8f539bdfa7637cb509f8613dcc7	track
2022	11	22	2022-11-22 00:01:07.67	2022-11-22 00:01:10	-2330	Hamburg	NULL	Germany	53.6304	9.98823	NULL	NULL	Chrome	107.0.0.0	Mac OS	10.15.7	Europe/Berlin	de-DE	NULL	NULL	3440x1440	1356x902	24.0	MacIntel	8.0	8.0	NULL	NULL	NULL	NULL	NULL	http://localhost:3000/azure	/azure	t=pv&ts=1669075267670&u=http%253A%252F%252Flocalhost%253A3000%252Fazure&hn=localhost&pa=%252Fazure&ua=Mozilla%252F5.0%2520(Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F107.0.0.0%2520Safari%252F537.36&iw=1356&ih=902&ti=Map%2520the%2520Cloud&w=3440&h=1440&d=24&l=de-DE&p=MacIntel&m=8&c=8&tz=Europe%252FBerlin	291	200	Hit	1	3320	NULL	NULL	NULL	NULL	NULL	cb7736f1c3ce9b9a21bb9a7b17edfd9507e7c6261ded2a8ebc7f19189d6de8c6	4e5aea60a9b73aa0f2aa69967e9de9a58b3341d5bc342f94d2eef07859b658da	ab40d20596d7595049399578929ffc598abdb8f539bdfa7637cb509f8613dcc7	pageview
2022	11	22	2022-11-22 00:01:13.175	2022-11-22 00:01:16	-2825	Hamburg	NULL	Germany	53.6304	9.98823	NULL	NULL	Chrome	107.0.0.0	Mac OS	10.15.7	Europe/Berlin	de-DE	NULL	NULL	3440x1440	1356x902	24.0	MacIntel	8.0	8.0	NULL	NULL	NULL	NULL	NULL	http://localhost:3000/aws	/aws	t=pv&ts=1669075273175&u=http%253A%252F%252Flocalhost%253A3000%252Faws&hn=localhost&pa=%252Faws&ua=Mozilla%252F5.0%2520(Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F107.0.0.0%2520Safari%252F537.36&iw=1356&ih=902&ti=Map%2520the%2520Cloud%2520-%2520Azure%2520Services%2520%2526%2520Regions&w=3440&h=1440&d=24&l=de-DE&p=MacIntel&m=8&c=8&tz=Europe%252FBerlin	315	200	Hit	0	3320	NULL	NULL	NULL	NULL	NULL	4326dbc4bbfbef6aec0584b3d6437625551ab22323ed0f81ff79ab54bcfb97db	cf7ee5dae81cbe75b0e78aaf200b8f1fb93349dc33fe65d3623df79ff31c53fd	ab40d20596d7595049399578929ffc598abdb8f539bdfa7637cb509f8613dcc7	pageview
2022	11	22	2022-11-22 00:01:20.2	2022-11-22 00:01:21	-800	Hamburg	NULL	Germany	53.6304	9.98823	NULL	NULL	Chrome	107.0.0.0	Mac OS	10.15.7	Europe/Berlin	de-DE	NULL	NULL	3440x1440	1356x902	24.0	MacIntel	8.0	8.0	NULL	NULL	NULL	NULL	NULL	http://localhost:3000/googlecloud	/googlecloud	t=pv&ts=1669075280200&u=http%253A%252F%252Flocalhost%253A3000%252Fgooglecloud&hn=localhost&pa=%252Fgooglecloud&ua=Mozilla%252F5.0%2520(Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F107.0.0.0%2520Safari%252F537.36&iw=1356&ih=902&ti=Map%2520the%2520Cloud%2520-%2520AWS%2520Services%2520%2526%2520Regions&w=3440&h=1440&d=24&l=de-DE&p=MacIntel&m=8&c=8&tz=Europe%252FBerlin	325	200	Hit	0	3320	NULL	NULL	NULL	NULL	NULL	949aa1b5dc5869b315686bb8ab1e211469af10ad8c5cc23c9fec3a43b3f39e5d	ee17f38d66e51fa2647ad07e21c847d82221baad23a587a51868d9ee5bf642f4	ab40d20596d7595049399578929ffc598abdb8f539bdfa7637cb509f8613dcc7	pageview


query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM '{DATA_DIR}/parquet-testing/aws_kinesis.parquet' WHERE event_timestamp=TIMESTAMP '2022-11-22 00:01:13.175';
----
2022	11	22	2022-11-22 00:01:13.175	2022-11-22 00:01:16	-2825	Hamburg	NULL	Germany	53.6304	9.98823	NULL	NULL	Chrome	107.0.0.0	Mac OS	10.15.7	Europe/Berlin	de-DE	NULL	NULL	3440x1440	1356x902	24.0	MacIntel	8.0	8.0	NULL	NULL	NULL	NULL	NULL	http://localhost:3000/aws	/aws	t=pv&ts=1669075273175&u=http%253A%252F%252Flocalhost%253A3000%252Faws&hn=localhost&pa=%252Faws&ua=Mozilla%252F5.0%2520(Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F107.0.0.0%2520Safari%252F537.36&iw=1356&ih=902&ti=Map%2520the%2520Cloud%2520-%2520Azure%2520Services%2520%2526%2520Regions&w=3440&h=1440&d=24&l=de-DE&p=MacIntel&m=8&c=8&tz=Europe%252FBerlin	315	200	Hit	0	3320	NULL	NULL	NULL	NULL	NULL	4326dbc4bbfbef6aec0584b3d6437625551ab22323ed0f81ff79ab54bcfb97db	cf7ee5dae81cbe75b0e78aaf200b8f1fb93349dc33fe65d3623df79ff31c53fd	ab40d20596d7595049399578929ffc598abdb8f539bdfa7637cb509f8613dcc7	pageview
