# name: test/sql/copy/parquet/file_metadata.test
# group: [parquet]

require parquet

statement ok
SET parquet_metadata_cache = true;

query IIIIIIIIII
SELECT * FROM parquet_file_metadata('{DATA_DIR}/parquet-testing/arrow/alltypes_dictionary.parquet')
----
{DATA_DIR}/parquet-testing/arrow/alltypes_dictionary.parquet	impala version 1.3.0-INTERNAL (build 8a48ddb1eff84592b3fc06bc6f51ec120e1fffc9)	2	1	1	NULL	NULL	1698	723	NULL

query IIIIIIIIII
SELECT * FROM parquet_file_metadata('{DATA_DIR}/parquet-testing/arrow/alltypes_dictionary.parquet')
----
{DATA_DIR}/parquet-testing/arrow/alltypes_dictionary.parquet	impala version 1.3.0-INTERNAL (build 8a48ddb1eff84592b3fc06bc6f51ec120e1fffc9)	2	1	1	NULL	NULL	1698	723	NULL

query IIIIIIIIII
SELECT unnest(parquet_file_metadata, recursive:=True) FROM parquet_full_metadata('data/parquet-testing/arrow/column_orders.parquet')
----
data/parquet-testing/arrow/column_orders.parquet	DuckDB version v1.5.0-dev4781 (build 8a469a87b9)	2	1	1	NULL	NULL	293	215	['ColumnOrder(TYPE_ORDER=TypeDefinedOrder())', 'ColumnOrder(TYPE_ORDER=TypeDefinedOrder())']
