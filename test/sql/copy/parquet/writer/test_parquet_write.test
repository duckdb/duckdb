# name: test/sql/copy/parquet/writer/test_parquet_write.test
# description: Parquet basic write
# group: [writer]

require parquet

statement ok
COPY (SELECT 42) TO '{TEMP_DIR}/scalar.parquet' (FORMAT 'parquet');

query I
SELECT * FROM parquet_scan('{TEMP_DIR}/scalar.parquet');
----
42

# empty result set, single thread
statement ok
CREATE TABLE empty(i INTEGER)

statement ok
COPY (SELECT * FROM empty) TO '{TEMP_DIR}/empty.parquet' (FORMAT 'parquet')

query I
SELECT COUNT(*) FROM parquet_scan('{TEMP_DIR}/empty.parquet')
----
0

statement ok
SET threads=4;

# empty result set, multi thread
statement ok
COPY (SELECT * FROM empty) TO '{TEMP_DIR}/empty_multithread' (FORMAT 'parquet', PER_THREAD_OUTPUT True)

query I
SELECT COUNT(*) FROM parquet_scan('{TEMP_DIR}/empty_multithread/*.parquet')
----
0
