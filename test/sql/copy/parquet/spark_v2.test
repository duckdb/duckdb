# name: test/sql/copy/parquet/spark_v2.test
# description: Tests reading from Spark's Parquet v2 writer
# group: [parquet]

require parquet

statement ok
PRAGMA enable_verification

query I
SELECT count(*) FROM '{DATA_DIR}/parquet-testing/spark-store.parquet'
----
12

query III
SELECT s_store_sk, s_floor_space, trim(s_street_name) FROM '{DATA_DIR}/parquet-testing/spark-store.parquet'
----
1	5250760	Spring
2	5285950	Sycamore
3	7557959	Park Laurel
4	9341467	Lake
5	9078805	Lee 6th
6	9026222	6th
7	8954883	Lee
8	6995995	12th
9	6995995	Hill
10	9294113	4th
11	9294113	Park Green
12	5219562	College


query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM '{DATA_DIR}/parquet-testing/spark-ontime.parquet'
----
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	30	11298	1129804	30194	DFW	Dallas/Fort Worth, TX	TX	48	Texas	74.0	10397	1039705	30397	ATL	Atlanta, GA	GA	13	Georgia	34.0	1715.0	1711.0	-4.0	0.0	0.0	-1.0	1700-1759	2024.0	2011.0	-13.0	0.0	0.0	-1.0	2000-2059	0	0	129.0	120.0	1.0	731.0	3
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	31	10397	1039705	30397	ATL	Atlanta, GA	GA	13	Georgia	34.0	11298	1129804	30194	DFW	Dallas/Fort Worth, TX	TX	48	Texas	74.0	1910.0	1924.0	14.0	14.0	0.0	0.0	1900-1959	2039.0	2059.0	20.0	20.0	1.0	1.0	2000-2059	0	0	149.0	155.0	1.0	731.0	3
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	32	13495	1349503	33495	MSY	New Orleans, LA	LA	22	Louisiana	72.0	10397	1039705	30397	ATL	Atlanta, GA	GA	13	Georgia	34.0	1940.0	1935.0	-5.0	0.0	0.0	-1.0	1900-1959	2205.0	2151.0	-14.0	0.0	0.0	-1.0	2200-2259	0	0	85.0	76.0	1.0	425.0	2
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	33	10397	1039705	30397	ATL	Atlanta, GA	GA	13	Georgia	34.0	13204	1320402	31454	MCO	Orlando, FL	FL	12	Florida	33.0	2220.0	2218.0	-2.0	0.0	0.0	-1.0	2200-2259	2350.0	2340.0	-10.0	0.0	0.0	-1.0	2300-2359	0	0	90.0	82.0	1.0	404.0	2
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	34	10299	1029904	30299	ANC	Anchorage, AK	AK	02	Alaska	1.0	14747	1474703	30559	SEA	Seattle, WA	WA	53	Washington	93.0	600.0	554.0	-6.0	0.0	0.0	-1.0	0600-0659	1041.0	958.0	-43.0	0.0	0.0	-2.0	1000-1059	0	0	221.0	184.0	1.0	1448.0	6
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	36	12889	1288903	32211	LAS	Las Vegas, NV	NV	32	Nevada	85.0	14747	1474703	30559	SEA	Seattle, WA	WA	53	Washington	93.0	1506.0	1532.0	26.0	26.0	1.0	1.0	1500-1559	1759.0	1756.0	-3.0	0.0	0.0	-1.0	1700-1759	0	0	173.0	144.0	1.0	867.0	4
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	38	14747	1474703	30559	SEA	Seattle, WA	WA	53	Washington	93.0	11433	1143302	31295	DTW	Detroit, MI	MI	26	Michigan	43.0	935.0	935.0	0.0	0.0	0.0	0.0	0900-0959	1655.0	1629.0	-26.0	0.0	0.0	-2.0	1600-1659	0	0	260.0	234.0	1.0	1927.0	8
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	39	11433	1143302	31295	DTW	Detroit, MI	MI	26	Michigan	43.0	14747	1474703	30559	SEA	Seattle, WA	WA	53	Washington	93.0	825.0	820.0	-5.0	0.0	0.0	-1.0	0800-0859	1038.0	1027.0	-11.0	0.0	0.0	-1.0	1000-1059	0	0	313.0	307.0	1.0	1927.0	8
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	40	12892	1289204	32575	LAX	Los Angeles, CA	CA	06	California	91.0	12478	1247803	31703	JFK	New York, NY	NY	36	New York	22.0	825.0	826.0	1.0	1.0	0.0	0.0	0800-0859	1659.0	1643.0	-16.0	0.0	0.0	-2.0	1600-1659	0	0	334.0	317.0	1.0	2475.0	10
2017	1	2	26	7	2017-02-26	DL	19790.0	DL	41	12478	1247803	31703	JFK	New York, NY	NY	36	New York	22.0	12892	1289204	32575	LAX	Los Angeles, CA	CA	06	California	91.0	1827.0	1825.0	-2.0	0.0	0.0	-1.0	1800-1859	2150.0	2133.0	-17.0	0.0	0.0	-2.0	2100-2159	0	0	383.0	368.0	1.0	2475.0	10
