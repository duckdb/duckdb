# name: test/sql/copy/csv/auto/test_sample_size.test
# description: Test optional parameters for read csv
# group: [auto]

require vector_size 512

# CSV file with irregularity in first column and default sample size
statement error
CREATE TABLE test AS SELECT * FROM read_csv_auto ('test/sql/copy/csv/data/auto/test_fallback.csv');

query IIII
SELECT typeof(TestDoubleError), typeof(TestDouble), typeof(TestText), typeof(TestInteger) FROM test LIMIT 1
----
VARCHAR	DOUBLE	VARCHAR INTEGER

statement ok
DROP TABLE test

# CSV file with irregularity in first column and small sample size
statement error
CREATE TABLE test AS SELECT * FROM read_csv_auto ('test/sql/copy/csv/data/auto/test_fallback.csv', SAMPLE_CHUNKS=2, SAMPLE_CHUNK_SIZE=2);

# CSV file with irregularity in first column, small sample size and fallback activated
statement error
CREATE TABLE test AS SELECT * FROM read_csv_auto ('test/sql/copy/csv/data/auto/test_fallback.csv', SAMPLE_CHUNK_SIZE=2, SAMPLE_CHUNKS=2, FALLBACK_TO_ALL_VARCHAR=1);

query IIII
SELECT typeof(TestDoubleError), typeof(TestDouble), typeof(TestText), typeof(TestInteger) FROM test LIMIT 1
----
VARCHAR	VARCHAR	VARCHAR VARCHAR

statement ok
DROP TABLE test
