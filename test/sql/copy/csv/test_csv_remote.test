# name: test/sql/copy/csv/test_csv_remote.test
# description: Test reading csv files over http
# group: [csv]

require httpfs

# regular csv file
query ITTTIITITTIIII nosort webpagecsv
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/real/web_page.csv') ORDER BY 1;
----

# file with gzip
query IIIIIIIIIIIIIII nosort lineitemcsv
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/lineitem1k.tbl.gz') ORDER BY ALL;
----

query ITTTIITITTIIII nosort webpagecsv
SELECT * FROM read_csv_auto('https://raw.githubusercontent.com/duckdb/duckdb/main/test/sql/copy/csv/data/real/web_page.csv') ORDER BY 1;
----

query IIIIIIIIIIIIIII nosort lineitemcsv
select * from read_csv_auto('https://raw.githubusercontent.com/duckdb/duckdb/main/test/sql/copy/csv/data/lineitem1k.tbl.gz') ORDER BY ALL;
----

statement ok
PRAGMA enable_verification

# Test load from url with query string
query IIIIIIIIIII
FROM sniff_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/customer.csv?v=1')
----
,	"	"	\n	0	0	{'column00': 'BIGINT', 'column01': 'VARCHAR', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'BIGINT', 'column06': 'BIGINT', 'column07': 'VARCHAR', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'VARCHAR', 'column11': 'BIGINT', 'column12': 'BIGINT', 'column13': 'BIGINT', 'column14': 'VARCHAR', 'column15': 'VARCHAR', 'column16': 'VARCHAR', 'column17': 'BIGINT'}	NULL	NULL	NULL	FROM read_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/customer.csv?v=1', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'VARCHAR', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'BIGINT', 'column06': 'BIGINT', 'column07': 'VARCHAR', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'VARCHAR', 'column11': 'BIGINT', 'column12': 'BIGINT', 'column13': 'BIGINT', 'column14': 'VARCHAR', 'column15': 'VARCHAR', 'column16': 'VARCHAR', 'column17': 'BIGINT'});

# Test load from remote gzip file with query string
query IIIIIIIIIII
FROM sniff_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/who.csv.gz?v=1')
----
,	"	"	\n	0	1	{'country': 'VARCHAR', 'iso2': 'VARCHAR', 'iso3': 'VARCHAR', 'year': 'BIGINT', 'new_sp_m014': 'BIGINT', 'new_sp_m1524': 'BIGINT', 'new_sp_m2534': 'BIGINT', 'new_sp_m3544': 'BIGINT', 'new_sp_m4554': 'BIGINT', 'new_sp_m5564': 'BIGINT', 'new_sp_m65': 'BIGINT', 'new_sp_f014': 'BIGINT', 'new_sp_f1524': 'BIGINT', 'new_sp_f2534': 'BIGINT', 'new_sp_f3544': 'BIGINT', 'new_sp_f4554': 'BIGINT', 'new_sp_f5564': 'BIGINT', 'new_sp_f65': 'BIGINT', 'new_sn_m014': 'BIGINT', 'new_sn_m1524': 'BIGINT', 'new_sn_m2534': 'BIGINT', 'new_sn_m3544': 'BIGINT', 'new_sn_m4554': 'BIGINT', 'new_sn_m5564': 'BIGINT', 'new_sn_m65': 'BIGINT', 'new_sn_f014': 'BIGINT', 'new_sn_f1524': 'BIGINT', 'new_sn_f2534': 'BIGINT', 'new_sn_f3544': 'BIGINT', 'new_sn_f4554': 'BIGINT', 'new_sn_f5564': 'BIGINT', 'new_sn_f65': 'BIGINT', 'new_ep_m014': 'BIGINT', 'new_ep_m1524': 'BIGINT', 'new_ep_m2534': 'BIGINT', 'new_ep_m3544': 'BIGINT', 'new_ep_m4554': 'BIGINT', 'new_ep_m5564': 'BIGINT', 'new_ep_m65': 'BIGINT', 'new_ep_f014': 'BIGINT', 'new_ep_f1524': 'BIGINT', 'new_ep_f2534': 'BIGINT', 'new_ep_f3544': 'BIGINT', 'new_ep_f4554': 'BIGINT', 'new_ep_f5564': 'BIGINT', 'new_ep_f65': 'BIGINT', 'newrel_m014': 'BIGINT', 'newrel_m1524': 'BIGINT', 'newrel_m2534': 'BIGINT', 'newrel_m3544': 'BIGINT', 'newrel_m4554': 'BIGINT', 'newrel_m5564': 'BIGINT', 'newrel_m65': 'BIGINT', 'newrel_f014': 'BIGINT', 'newrel_f1524': 'BIGINT', 'newrel_f2534': 'BIGINT', 'newrel_f3544': 'BIGINT', 'newrel_f4554': 'BIGINT', 'newrel_f5564': 'BIGINT', 'newrel_f65': 'BIGINT'}	NULL	NULL	NULL	FROM read_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/who.csv.gz?v=1', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=true, columns={'country': 'VARCHAR', 'iso2': 'VARCHAR', 'iso3': 'VARCHAR', 'year': 'BIGINT', 'new_sp_m014': 'BIGINT', 'new_sp_m1524': 'BIGINT', 'new_sp_m2534': 'BIGINT', 'new_sp_m3544': 'BIGINT', 'new_sp_m4554': 'BIGINT', 'new_sp_m5564': 'BIGINT', 'new_sp_m65': 'BIGINT', 'new_sp_f014': 'BIGINT', 'new_sp_f1524': 'BIGINT', 'new_sp_f2534': 'BIGINT', 'new_sp_f3544': 'BIGINT', 'new_sp_f4554': 'BIGINT', 'new_sp_f5564': 'BIGINT', 'new_sp_f65': 'BIGINT', 'new_sn_m014': 'BIGINT', 'new_sn_m1524': 'BIGINT', 'new_sn_m2534': 'BIGINT', 'new_sn_m3544': 'BIGINT', 'new_sn_m4554': 'BIGINT', 'new_sn_m5564': 'BIGINT', 'new_sn_m65': 'BIGINT', 'new_sn_f014': 'BIGINT', 'new_sn_f1524': 'BIGINT', 'new_sn_f2534': 'BIGINT', 'new_sn_f3544': 'BIGINT', 'new_sn_f4554': 'BIGINT', 'new_sn_f5564': 'BIGINT', 'new_sn_f65': 'BIGINT', 'new_ep_m014': 'BIGINT', 'new_ep_m1524': 'BIGINT', 'new_ep_m2534': 'BIGINT', 'new_ep_m3544': 'BIGINT', 'new_ep_m4554': 'BIGINT', 'new_ep_m5564': 'BIGINT', 'new_ep_m65': 'BIGINT', 'new_ep_f014': 'BIGINT', 'new_ep_f1524': 'BIGINT', 'new_ep_f2534': 'BIGINT', 'new_ep_f3544': 'BIGINT', 'new_ep_f4554': 'BIGINT', 'new_ep_f5564': 'BIGINT', 'new_ep_f65': 'BIGINT', 'newrel_m014': 'BIGINT', 'newrel_m1524': 'BIGINT', 'newrel_m2534': 'BIGINT', 'newrel_m3544': 'BIGINT', 'newrel_m4554': 'BIGINT', 'newrel_m5564': 'BIGINT', 'newrel_m65': 'BIGINT', 'newrel_f014': 'BIGINT', 'newrel_f1524': 'BIGINT', 'newrel_f2534': 'BIGINT', 'newrel_f3544': 'BIGINT', 'newrel_f4554': 'BIGINT', 'newrel_f5564': 'BIGINT', 'newrel_f65': 'BIGINT'});
