# name: test/sql/types/list/test_list_extract.test
# description: Test scalar lists
# group: [list]

statement ok
PRAGMA enable_verification

# this is underspecified for parallelism because the order in the list() aggr is arbitrary then
statement ok
PRAGMA threads=1

query I
SELECT LIST_EXTRACT(NULL, 0)
----
NULL

query I
SELECT LIST_EXTRACT(42, 0)
----
4

query I
SELECT LIST_EXTRACT(LIST_VALUE(), 0)
----
NULL

query I
SELECT LIST_EXTRACT(LIST_VALUE(NULL), 0)
----
NULL

query I
SELECT LIST_EXTRACT(LIST_VALUE(NULL), -1)
----
NULL

query I
SELECT LIST_EXTRACT(LIST_VALUE(42), NULL)
----
NULL

query I
SELECT LIST_EXTRACT(LIST_VALUE(42), 0)
----
42

# alias
query I
SELECT LIST_ELEMENT(LIST_VALUE(42), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42, 43), 1)
----
43

query I
SELECT LIST_EXTRACT(LIST_VALUE(42, 43, 44, 45), -1)
----
45

query I
SELECT LIST_EXTRACT(LIST_VALUE(42, 43, 44, 45), -2)
----
44

query I
SELECT LIST_EXTRACT(LIST_VALUE(42, 43, 44, 45), -4)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42, 43, 44, 45), -5)
----
NULL

query I
SELECT LIST_EXTRACT(LIST_VALUE(42), 1)
----
NULL

statement ok
CREATE TABLE list_extract_test(i INTEGER, g INTEGER);

statement ok
INSERT INTO list_extract_test VALUES (1, 1), (2, 1), (3, 2), (NULL, 3), (42, 3);

query I
SELECT LIST_EXTRACT(LIST(i), 0) FROM list_extract_test GROUP BY g;
----
1
3
NULL

query I
SELECT LIST_EXTRACT(LIST(i), 1) FROM list_extract_test GROUP BY g;
----
2
NULL
42

query I
SELECT LIST_EXTRACT(LIST(i), 2) FROM list_extract_test GROUP BY g;
----
NULL
NULL
NULL

# all them types woo

query I
SELECT LIST_EXTRACT(LIST_VALUE('Hello', 'World'), 0)
----
Hello

query I
SELECT LIST_EXTRACT(LIST_VALUE('Hello', 'World'), 1)
----
World

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::UTINYINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::TINYINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::USMALLINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::SMALLINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::UINTEGER), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::INTEGER), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::UBIGINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::BIGINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::HUGEINT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::FLOAT), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE(42::DOUBLE), 0)
----
42

query I
SELECT LIST_EXTRACT(LIST_VALUE('2019-11-26'::DATE), 0)
----
2019-11-26

query I
SELECT LIST_EXTRACT(LIST_VALUE('21:42:00'::TIME), 0)
----
21:42:00

query I
SELECT LIST_EXTRACT(LIST_VALUE('2019-11-26 09:42:00'::TIMESTAMP), 0)
----
2019-11-26 09:42:00
