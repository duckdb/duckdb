# name: test/sql/types/list/list_stats.test
# description: Test stats propagation for lists
# group: [list]

# list stats
query II
SELECT s.child_stats.min, s.child_stats.max FROM (SELECT STATS([3, 4]) s)
----
3	4

query I
SELECT [3, 4]
----
[3, 4]

query II
SELECT s.has_null, s.has_no_null FROM (SELECT STATS(NULL::INT[]) s)
----
true	false

query I
SELECT NULL::INT[]
----
NULL

statement ok
SELECT STATS(['hello', 'world'])

statement ok
SELECT STATS([interval 1 year, interval 2 year])

query I
SELECT ['hello', 'world']
----
[hello, world]

query I
SELECT [interval 1 year, interval 2 year]
----
[1 year, 2 years]

statement ok
CREATE TABLE integers(i integer)

statement ok
insert into integers values (3), (4);

query IIII
SELECT s.child_stats.min, s.child_stats.max, s.child_stats.has_null, s.has_null FROM (SELECT STATS([i]) s FROM integers LIMIT 1)
----
3	4	false	false

query I
SELECT [i] FROM integers
----
[3]
[4]

statement ok
insert into integers values (NULL);

query IIII
SELECT s.child_stats.min, s.child_stats.max, s.child_stats.has_null, s.has_null FROM (SELECT STATS([i]) s FROM integers LIMIT 1)
----
3	4	true	false

query I
SELECT [i] FROM integers
----
[3]
[4]
[NULL]

statement ok
CREATE TABLE lists AS SELECT [3, 4] l

# list_extract always propagates a null
query III
SELECT s.min, s.max, s.has_null FROM (SELECT STATS(l[1]) s FROM lists LIMIT 1)
----
3	4	true

query I
SELECT l[1] FROM lists
----
3

# empty list
statement ok
INSERT INTO lists VALUES ([])

query III
SELECT s.min, s.max, s.has_null FROM (SELECT STATS(l[1]) s FROM lists LIMIT 1)
----
3	4	true

query I
SELECT l[1] FROM lists
----
3
NULL

# null list
statement ok
INSERT INTO lists VALUES (NULL)

query III
SELECT s.min, s.max, s.has_null FROM (SELECT STATS(l[1]) s FROM lists LIMIT 1)
----
3	4	true

query I
SELECT l[1] FROM lists
----
3
NULL
NULL

# null IN list

statement ok
INSERT INTO lists VALUES ([NULL])

query III
SELECT s.min, s.max, s.has_null FROM (SELECT STATS(l[1]) s FROM lists LIMIT 1)
----
3	4	true

query I
SELECT l[1] FROM lists
----
3
NULL
NULL
NULL
