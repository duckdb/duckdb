# name: test/sql/types/custom/test_custom_table.test
# description: CUSTOM types used in table tests
# group: [custom]

statement ok
PRAGMA enable_verification

statement ok
CREATE TYPE box (input := 'to_base64', output := 'from_base64');

# Test with non existent custom type
statement error
CREATE TABLE person (
    name text,
    current_car car
);

statement ok
CREATE TABLE person (
    name text,
    current_box box
);

statement ok
INSERT INTO person VALUES ('Moe', 'happy'::BLOB);

query TT
select * from person
----
Moe	happy

statement ok
INSERT INTO person VALUES ('Pedro', 'ok'::BLOB);

statement ok
INSERT INTO person VALUES ('Mark', 'sad'::BLOB);

query TT
select * from person where current_box = 'sad'::BLOB
----
Mark	sad

statement ok
CREATE TABLE pets (
    name text,
    current_box box
);

statement ok
INSERT INTO pets VALUES ('Anne', 'happy'::BLOB);

statement ok
INSERT INTO pets VALUES ('Oogie Boogie', 'ok'::BLOB);

#Null Values in the column are allowed
statement ok
INSERT INTO pets VALUES ('Mr. Fluffles McFluffingstein', NULL);

query TT
select * from pets;
----
Anne	happy
Oogie Boogie	ok
Mr. Fluffles McFluffingstein	NULL

query TT
select person.name, pets.name from person inner join pets on  (person.current_box = pets.current_box)
----
Moe	Anne
Pedro	Oogie Boogie

statement ok
DROP TABLE person;

statement ok
DROP TABLE pets;

statement ok
DROP TYPE box;

# Creating a new table should not
statement error
CREATE TABLE aliens (
    name text,
    current_box box
);
