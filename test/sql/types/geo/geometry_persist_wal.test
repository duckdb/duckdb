# name: test/sql/types/geo/geometry_persist_wal.test
# group: [geo]

statement ok
SET checkpoint_threshold='1TB'

statement ok
PRAGMA disable_checkpoint_on_shutdown

statement ok
ATTACH '__TEST_DIR__/geometry_wal.db' AS geo_wal (STORAGE_VERSION 'v1.5.0')

statement ok
create table geo_wal.t1(g GEOMETRY);

statement ok
INSERT INTO geo_wal.t1 VALUES ('POINT(1 2)'::GEOMETRY);

statement ok
INSERT INTO geo_wal.t1 VALUES ('POINT(1 2)'::GEOMETRY);

query I
select * from geo_wal.t1;
----
POINT (1 2)
POINT (1 2)

statement ok
DETACH geo_wal

statement ok
ATTACH '__TEST_DIR__/geometry_wal.db' AS geo_wal

query I
select * from geo_wal.t1;
----
POINT (1 2)
POINT (1 2)