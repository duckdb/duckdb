# name: test/sql/types/bignum/test_bignum_comparisons.test
# description: Comparison testing for bignum type
# group: [bignum]

statement ok
PRAGMA enable_verification

# Create table with a variety of bignums
statement ok
CREATE TABLE bignum_comparisons(a bignum);

statement ok
insert into bignum_comparisons values
('9223372036854775807'::bignum),
('-9223372036854775808'::bignum),
('2147483647'::bignum),
('-2147483648'::bignum),
('32767'::bignum),
('-32768'::bignum),
('255'::bignum),
('0'::bignum),
('-1'::bignum),
('1'::bignum),
('340282366920938463463374607431768211455'::bignum),
('-170141183460469231731687303715884105727'::bignum),
('170141183460469231731687303715884105727'::bignum),
('340282366920938463463374607431768211455987'::bignum),
('-340282366920938463463374607431768211455987'::bignum);

# Basic comparisons
query II
select a, a < '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a <= '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	true
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a = '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	false

query II
select a, a > '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a >= '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a != '9223372036854775807'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	true

# More comparisons with different values
query II
select a, a < '2147483647'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	false
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a <= '2147483647'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a = '2147483647'::bignum from bignum_comparisons
----
9223372036854775807	false
-9223372036854775808	false
2147483647	true
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	false

query II
select a, a > '2147483647'::bignum from bignum_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a >= '2147483647'::bignum from bignum_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	true
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false
