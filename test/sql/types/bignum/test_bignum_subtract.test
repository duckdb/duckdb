# name: test/sql/types/bignum/test_bignum_subtract.test
# description: Test bignum implicit cast
# group: [bignum]

statement ok
PRAGMA enable_verification

query I
SELECT -(1::BIGNUM)
----
-1

query I
SELECT -(0::BIGNUM)
----
0

query I
SELECT -(-0::BIGNUM)
----
0

query I
SELECT -(NULL::BIGNUM)
----
NULL

query I
SELECT -('99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::BIGNUM)
----
-99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999

query I
SELECT 10::bignum - 7::bignum
----
3

statement ok
create table T (a bignum, b bignum);

statement ok
insert into T values (0,0), (NULL, 10), (10, NULL), (100, -10), (-10, 100), (888, 271);

query III
SELECT a-b,a,b FROM T
----
0	0	0
NULL	NULL	10
NULL	10	NULL
110	100	-10
-110	-10	100
617	888	271

query I
SELECT ('99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::BIGNUM) - ('1'::BIGNUM)
----
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999998

# Perform a substraction that increases the value
query I
SELECT ('1'::BIGNUM) - (-'9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::BIGNUM)
----
10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000