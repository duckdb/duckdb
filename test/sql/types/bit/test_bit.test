# name: test/sql/types/bit/test_bit.test
# description: BIT tests
# group: [bit]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE bits (b bit);

# insert valid bit strings
statement ok
INSERT INTO bits VALUES('101011010'), ('111'), ('1010010101111111001101')

query I
SELECT * FROM bits
----
101011010
111
1010010101111111001101

statement ok
INSERT INTO bits VALUES('0'), ('1'), ('0000000000000000000111')

query I
SELECT * FROM bits
----
101011010
111
1010010101111111001101
0
1
0000000000000000000111

query I
SELECT * FROM bits WHERE b = '111';
----
111

# insert invalid bit strings
statement error
INSERT INTO bits VALUES('101211010')
----
Conversion Error: Invalid character encountered in string -> bit conversion: '2'

statement error
INSERT INTO bits VALUES('1A10')
----
Conversion Error: Invalid character encountered in string -> bit conversion: 'A'

# bit null test and empty values
query I
SELECT NULL::BIT
----
NULL

statement ok
DELETE FROM bits

statement ok
INSERT INTO bits VALUES(''), (NULL)

query I
SELECT * FROM bits
----
(empty)
NULL

# try cast
query I
SELECT TRY_CAST('101' AS BIT)
----
101

query I
SELECT TRY_CAST('102' AS BIT)
----
NULL

# cast varchar column to bit type
statement ok
CREATE TABLE varchars (col VARCHAR);

statement ok
INSERT INTO varchars VALUES('1010010101010101100001111111001101'), ('0')

query I
SELECT col::BIT FROM varchars
----
1010010101010101100001111111001101
0

statement ok
INSERT INTO varchars VALUES('1011010'), ('0ðŸ¦†1'), ('1'), ('3')

query I
SELECT TRY_CAST(col AS BIT) FROM varchars
----
1010010101010101100001111111001101
0
1011010
NULL
1
NULL

# Huge bit string
statement ok
CREATE TABLE huge_bits (big bit);

# insert valid bit strings
statement ok
INSERT INTO huge_bits VALUES('101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101101011010010010100111000010101010100001001010010010100010101000001010010000010101010010101001010010010100100000010010010010010101010100010101001001001010010101010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011010110100100101001110000101010101000010010100100101000101010000010100100000101010100101010010100100101001000000100100100100101010101000101010010010010100101011')

query I
SELECT bit_length(big) FROM huge_bits
----
10017
