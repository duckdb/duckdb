# name: test/sql/types/variant/test_all_types.test
# group: [variant]

require json

query I
select struct_pack(*COLUMNS(*))::VARIANT::JSON from test_all_types();
----
{"bool":false,"tinyint":-128,"smallint":-32768,"int":-2147483648,"bigint":-9223372036854775808,"hugeint":-170141183460469231731687303715884105728,"uhugeint":0,"utinyint":0,"usmallint":0,"uint":0,"ubigint":0,"bignum":-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368,"date":"5877642-06-25 (BC)","time":"00:00:00","timestamp":"290309-12-22 (BC) 00:00:00","timestamp_s":"290309-12-22 (BC) 00:00:00","timestamp_ms":"290309-12-22 (BC) 00:00:00","timestamp_ns":"1677-09-22 00:00:00","time_tz":"00:00:00+15:59:59","timestamp_tz":"290309-12-22 (BC) 00:00:00+00","float":-3.4028234663852886e38,"double":-1.7976931348623157e308,"dec_4_1":-999.9,"dec_9_4":-99999.9999,"dec_18_6":-999999999999.999999,"dec38_10":-9999999999999999999999999999.9999999999,"uuid":"00000000-0000-0000-0000-000000000000","interval":"00:00:00","varchar":"","blob":"thisisalongblob\\x00withnullbytes","bit":"0010001001011100010101011010111","small_enum":"DUCK_DUCK_ENUM","medium_enum":"enum_0","large_enum":"enum_0","int_array":[],"double_array":[],"date_array":[],"timestamp_array":[],"timestamptz_array":[],"varchar_array":[],"nested_int_array":[],"struct":{"a":null,"b":null},"struct_of_arrays":{"a":null,"b":null},"array_of_structs":[],"map":[],"union":"Frank","fixed_int_array":[null,2,3],"fixed_varchar_array":["a",null,"c"],"fixed_nested_int_array":[[null,2,3],null,[null,2,3]],"fixed_nested_varchar_array":[["a",null,"c"],null,["a",null,"c"]],"fixed_struct_array":[{"a":null,"b":null},{"a":42,"b":""},{"a":null,"b":null}],"struct_of_fixed_array":{"a":[null,2,3],"b":["a",null,"c"]},"fixed_array_of_int_list":[[],[42,999,null,null,-42],[]],"list_of_fixed_int_array":[[null,2,3],[4,5,6],[null,2,3]]}
{"bool":true,"tinyint":127,"smallint":32767,"int":2147483647,"bigint":9223372036854775807,"hugeint":170141183460469231731687303715884105727,"uhugeint":340282366920938463463374607431768211455,"utinyint":255,"usmallint":65535,"uint":4294967295,"ubigint":18446744073709551615,"bignum":179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368,"date":"5881580-07-10","time":"24:00:00","timestamp":"294247-01-10 04:00:54.775806","timestamp_s":"294247-01-10 04:00:54","timestamp_ms":"294247-01-10 04:00:54.775","timestamp_ns":"2262-04-11 23:47:16.854775806","time_tz":"24:00:00-15:59:59","timestamp_tz":"294247-01-10 04:00:54.775806+00","float":3.4028234663852886e38,"double":1.7976931348623157e308,"dec_4_1":999.9,"dec_9_4":99999.9999,"dec_18_6":999999999999.999999,"dec38_10":9999999999999999999999999999.9999999999,"uuid":"ffffffff-ffff-ffff-ffff-ffffffffffff","interval":"83 years 3 months 999 days 00:16:39.999999","varchar":"goo\u0000se","blob":"\\x00\\x00\\x00a","bit":"10101","small_enum":"GOOSE","medium_enum":"enum_299","large_enum":"enum_69999","int_array":[42,999,null,null,-42],"double_array":[42.0,NaN,Infinity,-Infinity,null,-42.0],"date_array":["1970-01-01","infinity","-infinity",null,"2022-05-12"],"timestamp_array":["1970-01-01 00:00:00","infinity","-infinity",null,"2022-05-12 16:23:45"],"timestamptz_array":["1970-01-01 00:00:00+00","infinity","-infinity",null,"2022-05-12 23:23:45+00"],"varchar_array":["","goose",null,""],"nested_int_array":[[],[42,999,null,null,-42],null,[],[42,999,null,null,-42]],"struct":{"a":42,"b":""},"struct_of_arrays":{"a":[42,999,null,null,-42],"b":["","goose",null,""]},"array_of_structs":[{"a":null,"b":null},{"a":42,"b":""},null],"map":[{"key":"key1","value":""},{"key":"key2","value":"goose"}],"union":5,"fixed_int_array":[4,5,6],"fixed_varchar_array":["d","e","f"],"fixed_nested_int_array":[[4,5,6],[null,2,3],[4,5,6]],"fixed_nested_varchar_array":[["d","e","f"],["a",null,"c"],["d","e","f"]],"fixed_struct_array":[{"a":42,"b":""},{"a":null,"b":null},{"a":42,"b":""}],"struct_of_fixed_array":{"a":[4,5,6],"b":["d","e","f"]},"fixed_array_of_int_list":[[42,999,null,null,-42],[],[42,999,null,null,-42]],"list_of_fixed_int_array":[[4,5,6],[null,2,3],[4,5,6]]}
{"bool":null,"tinyint":null,"smallint":null,"int":null,"bigint":null,"hugeint":null,"uhugeint":null,"utinyint":null,"usmallint":null,"uint":null,"ubigint":null,"bignum":null,"date":null,"time":null,"timestamp":null,"timestamp_s":null,"timestamp_ms":null,"timestamp_ns":null,"time_tz":null,"timestamp_tz":null,"float":null,"double":null,"dec_4_1":null,"dec_9_4":null,"dec_18_6":null,"dec38_10":null,"uuid":null,"interval":null,"varchar":null,"blob":null,"bit":null,"small_enum":null,"medium_enum":null,"large_enum":null,"int_array":null,"double_array":null,"date_array":null,"timestamp_array":null,"timestamptz_array":null,"varchar_array":null,"nested_int_array":null,"struct":null,"struct_of_arrays":null,"array_of_structs":null,"map":null,"union":null,"fixed_int_array":null,"fixed_varchar_array":null,"fixed_nested_int_array":null,"fixed_nested_varchar_array":null,"fixed_struct_array":null,"struct_of_fixed_array":null,"fixed_array_of_int_list":null,"list_of_fixed_int_array":null}

query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
select {'var': COLUMNS(*)::VARIANT}::VARIANT from test_all_types();
----
{'var': false}	{'var': -128}	{'var': -32768}	{'var': -2147483648}	{'var': -9223372036854775808}	{'var': -170141183460469231731687303715884105728}	{'var': 0}	{'var': 0}	{'var': 0}	{'var': 0}	{'var': 0}	{'var': -179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368}	{'var': '5877642-06-25 (BC)'}	{'var': '00:00:00'}	{'var': '290309-12-22 (BC) 00:00:00'}	{'var': '290309-12-22 (BC) 00:00:00'}	{'var': '290309-12-22 (BC) 00:00:00'}	{'var': '1677-09-22 00:00:00'}	{'var': '00:00:00+15:59:59'}	{'var': '290309-12-22 (BC) 00:00:00+00'}	{'var': -3.4028235e+38}	{'var': -1.7976931348623157e+308}	{'var': -999.9}	{'var': -99999.9999}	{'var': -999999999999.999999}	{'var': -9999999999999999999999999999.9999999999}	{'var': 00000000-0000-0000-0000-000000000000}	{'var': '00:00:00'}	{'var': }	{'var': thisisalongblob\x00withnullbytes}	{'var': 0010001001011100010101011010111}	{'var': DUCK_DUCK_ENUM}	{'var': enum_0}	{'var': enum_0}	{'var': []}	{'var': []}	{'var': []}	{'var': []}	{'var': []}	{'var': []}	{'var': []}	{'var': {'a': NULL, 'b': NULL}}	{'var': {'a': NULL, 'b': NULL}}	{'var': []}	{'var': []}	{'var': Frank}	{'var': [NULL, 2, 3]}	{'var': [a, NULL, c]}	{'var': [[NULL, 2, 3], NULL, [NULL, 2, 3]]}	{'var': [[a, NULL, c], NULL, [a, NULL, c]]}	{'var': [{'a': NULL, 'b': NULL}, {'a': 42, 'b': }, {'a': NULL, 'b': NULL}]}	{'var': {'a': [NULL, 2, 3], 'b': [a, NULL, c]}}	{'var': [[], [42, 999, NULL, NULL, -42], []]}	{'var': [[NULL, 2, 3], [4, 5, 6], [NULL, 2, 3]]}
{'var': true}	{'var': 127}	{'var': 32767}	{'var': 2147483647}	{'var': 9223372036854775807}	{'var': 170141183460469231731687303715884105727}	{'var': 340282366920938463463374607431768211455}	{'var': 255}	{'var': 65535}	{'var': 4294967295}	{'var': 18446744073709551615}	{'var': 179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368}	{'var': 5881580-07-10}	{'var': '24:00:00'}	{'var': '294247-01-10 04:00:54.775806'}	{'var': '294247-01-10 04:00:54'}	{'var': '294247-01-10 04:00:54.775'}	{'var': '2262-04-11 23:47:16.854775806'}	{'var': '24:00:00-15:59:59'}	{'var': '294247-01-10 04:00:54.775806+00'}	{'var': 3.4028235e+38}	{'var': 1.7976931348623157e+308}	{'var': 999.9}	{'var': 99999.9999}	{'var': 999999999999.999999}	{'var': 9999999999999999999999999999.9999999999}	{'var': ffffffff-ffff-ffff-ffff-ffffffffffff}	{'var': '83 years 3 months 999 days 00:16:39.999999'}	{'var': goo\0se}	{'var': \x00\x00\x00a}	{'var': 10101}	{'var': GOOSE}	{'var': enum_299}	{'var': enum_69999}	{'var': [42, 999, NULL, NULL, -42]}	{'var': [42.0, nan, inf, -inf, NULL, -42.0]}	{'var': [1970-01-01, infinity, -infinity, NULL, 2022-05-12]}	{'var': [1970-01-01 00:00:00, infinity, -infinity, NULL, 2022-05-12 16:23:45]}	{'var': [1970-01-01 00:00:00+00, infinity, -infinity, NULL, 2022-05-12 23:23:45+00]}	{'var': [, goose, NULL, ]}	{'var': [[], [42, 999, NULL, NULL, -42], NULL, [], [42, 999, NULL, NULL, -42]]}	{'var': {'a': 42, 'b': }}	{'var': {'a': [42, 999, NULL, NULL, -42], 'b': [, goose, NULL, ]}}	{'var': [{'a': NULL, 'b': NULL}, {'a': 42, 'b': }, NULL]}	{'var': [{'key': key1, 'value': }, {'key': key2, 'value': goose}]}	{'var': 5}	{'var': [4, 5, 6]}	{'var': [d, e, f]}	{'var': [[4, 5, 6], [NULL, 2, 3], [4, 5, 6]]}	{'var': [[d, e, f], [a, NULL, c], [d, e, f]]}	{'var': [{'a': 42, 'b': }, {'a': NULL, 'b': NULL}, {'a': 42, 'b': }]}	{'var': {'a': [4, 5, 6], 'b': [d, e, f]}}	{'var': [[42, 999, NULL, NULL, -42], [], [42, 999, NULL, NULL, -42]]}	{'var': [[4, 5, 6], [NULL, 2, 3], [4, 5, 6]]}
{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}	{'var': NULL}

query II
select [COLUMNS(['tinyint', 'double'])::VARIANT, NULL, COLUMNS(['tinyint', 'double'])::VARIANT] from test_all_types();
----
[-128, NULL, -128]	[-1.7976931348623157e+308, NULL, -1.7976931348623157e+308]
[127, NULL, 127]	[1.7976931348623157e+308, NULL, 1.7976931348623157e+308]
[NULL, NULL, NULL]	[NULL, NULL, NULL]

query II
select [COLUMNS(['tinyint', 'double'])::JSON, NULL, COLUMNS(['tinyint', 'double'])::JSON] from test_all_types();
----
[-128, NULL, -128]	[-1.7976931348623157e308, NULL, -1.7976931348623157e308]
[127, NULL, 127]	[1.7976931348623157e308, NULL, 1.7976931348623157e308]
[NULL, NULL, NULL]	[NULL, NULL, NULL]
