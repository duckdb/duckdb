# name: test/sql/types/varint/test_varint_subtract.test
# description: Test varint implicit cast
# group: [varint]

statement ok
PRAGMA enable_verification

query I
SELECT -(1::VARINT)
----
-1

query I
SELECT -(0::VARINT)
----
0

query I
SELECT -(-0::VARINT)
----
0

query I
SELECT -(NULL::VARINT)
----
NULL

query I
SELECT -('99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::VARINT)
----
-99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999

query I
SELECT 10::varint - 7::varint
----
3

statement ok
create table T (a varint, b varint);

statement ok
insert into T values (0,0), (NULL, 10), (10, NULL), (100, -10), (-10, 100), (888, 271);

query III
SELECT a-b,a,b FROM T
----
0	0	0
NULL	NULL	10
NULL	10	NULL
110	100	-10
-110	-10	100
617	888	271

query I
SELECT ('99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::VARINT) - ('1'::VARINT)
----
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999998

# Perform a substraction that increases the value
query I
SELECT ('1'::VARINT) - (-'9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'::VARINT)
----
10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000