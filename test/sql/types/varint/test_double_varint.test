# name: test/sql/types/varint/test_double_varint.test
# description: Test double of varint type
# group: [varint]

statement ok
PRAGMA enable_verification

query I
select 179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368::double::varint
----
179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368


query I
select (-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368)::double::varint
----
-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368


query I
select 33999999014383402399481480781255147520::float::varint
----
33999999014383402399481480781255147520

query I
select 33999999014383402399481480781255147520::double::varint
----
33999999014383402399481480781255147520

query I
select  0::double::varint
----
0

query I
select  (-0)::double::varint
----
0

query I
select 1::double::varint
----
1

query I
select 100000::double::varint
----
100000


query I
select 100000.595::double::varint
----
100000

# Test Inf
statement error
select 1797693134862315708145274237317043567980705675258449965989174768031572607800285387605895586327668781715404589535143824642343213268894641827684675467035375169860499105765512820762454900903893289440758685084551339423045832369032229481658085593321233482747978262041447231687381771809192998812504040261841248583700::varint
----
Type DOUBLE with value inf can't be cast to the destination

# Test -Inf
statement error
select '-1e310'::double::varint
----
Type DOUBLE with value -inf can't be cast to the destination