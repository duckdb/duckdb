# name: test/sql/types/varint/test_varint_comparisons.test
# description: Comparison testing for varint type
# group: [varint]

statement ok
PRAGMA enable_verification

# Create table with a variety of varints
statement ok
CREATE TABLE varint_comparisons(a varint);

statement ok
insert into varint_comparisons values
('9223372036854775807'::varint),
('-9223372036854775808'::varint),
('2147483647'::varint),
('-2147483648'::varint),
('32767'::varint),
('-32768'::varint),
('255'::varint),
('0'::varint),
('-1'::varint),
('1'::varint),
('340282366920938463463374607431768211455'::varint),
('-170141183460469231731687303715884105727'::varint),
('170141183460469231731687303715884105727'::varint),
('340282366920938463463374607431768211455987'::varint),
('-340282366920938463463374607431768211455987'::varint);

# Basic comparisons
query II
select a, a < '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a <= '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	true
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a = '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	false

query II
select a, a > '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a >= '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a != '9223372036854775807'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	true

# More comparisons with different values
query II
select a, a < '2147483647'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	false
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a <= '2147483647'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	true
2147483647	true
-2147483648	true
32767	true
-32768	true
255	true
0	true
-1	true
1	true
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	true
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	true

query II
select a, a = '2147483647'::varint from varint_comparisons
----
9223372036854775807	false
-9223372036854775808	false
2147483647	true
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	false
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	false
340282366920938463463374607431768211455987	false
-340282366920938463463374607431768211455987	false

query II
select a, a > '2147483647'::varint from varint_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	false
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false

query II
select a, a >= '2147483647'::varint from varint_comparisons
----
9223372036854775807	true
-9223372036854775808	false
2147483647	true
-2147483648	false
32767	false
-32768	false
255	false
0	false
-1	false
1	false
340282366920938463463374607431768211455	true
-170141183460469231731687303715884105727	false
170141183460469231731687303715884105727	true
340282366920938463463374607431768211455987	true
-340282366920938463463374607431768211455987	false
