# name: test/sql/types/varint/test_varint_double.test
# description: Test varint double
# group: [varint]

statement ok
PRAGMA enable_verification

query I
select '100'::varint::double
----
100

query I
select '100000'::varint::double
----
100000

query I
select '1000000000000000'::varint::double
----
1000000000000000

query I
select '340282366920938463463374607431768211455'::varint::double
----
340282366920938463463374607431768211455


query I
select '-100'::varint::double
----
-100

query I
select '-100000'::varint::double
----
-100000

query I
select '-1000000000000000'::varint::double
----
-1000000000000000

query I
select '-340282366920938463463374607431768211455'::varint::double
----
-340282366920938463463374607431768211455

query I
select 179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368::varint::double
----
179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368

# Test Overflow
statement error
select 1797693134862315708145274237317043567980705675258449965989174768031572607800285387605895586327668781715404589535143824642343213268894641827684675467035375169860499105765512820762454900903893289440758685084551339423045832369032229481658085593321233482747978262041447231687381771809192998812504040261841248583700::varint::double
----
Type DOUBLE with value inf can't be cast to the destination type

# Test Overflow
statement error
select '1797693134862315708145274237317043567980705675258449965989174768031572607800285387605895586327668781715404589535143824642343213268894641827684675467035375169860499105765512820762454900903893289440758685084551339423045832369032229481658085593321233482747978262041447231687381771809192998812504040261841248583700'::varint::double
----
Could not convert varint '1797693134862315708145274237317043567980705675258449965989174768031572607800285387605895586327668781715404589535143824642343213268894641827684675467035375169860499105765512820762454900903893289440758685084551339423045832369032229481658085593321233482747978262041447231687381771809192998812504040261841248583700' to Double