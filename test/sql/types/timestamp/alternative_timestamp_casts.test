# name: test/sql/types/timestamp/alternative_timestamp_casts.test
# description: Test timestamp casts
# group: [timestamp]

statement ok
PRAGMA enable_verification

query I
SELECT DATE '1992-01-01'::TIMESTAMP_MS
----
1992-01-01 00:00:00

query I
SELECT DATE '1992-01-01'::TIMESTAMP_S
----
1992-01-01 00:00:00

query I
SELECT DATE '1992-01-01'::TIMESTAMP_NS
----
1992-01-01 00:00:00

query I
select '2023-12-08 08:51:39.123456'::TIMESTAMP_MS::TIME;
----
08:51:39.123

query I
select '2023-12-08 08:51:39.123456'::TIMESTAMP_S::TIME;
----
08:51:39

query I
select '2023-12-08 08:51:39.123456'::TIMESTAMP_NS::TIME;
----
08:51:39.123456

# Rounding
query I
select '2024-05-10 11:06:33.446'::TIMESTAMP_S;
----
2024-05-10 11:06:33

query I
select '2024-05-10 11:06:33.846'::TIMESTAMP_S;
----
2024-05-10 11:06:34

query I
select '2024-05-10 11:06:33.123446'::TIMESTAMP_MS;
----
2024-05-10 11:06:33.123

query I
select '2024-05-10 11:06:33.123846'::TIMESTAMP_MS;
----
2024-05-10 11:06:33.124

# Rounding
statement ok
CREATE TABLE issue11995 (t TIMESTAMP);

statement ok
INSERT INTO issue11995 VALUES 
	('2024-05-10 11:06:33.446'), 
	('2024-05-10 11:06:33.846'),
	('2024-05-10 11:06:33.123446'),
	('2024-05-10 11:06:33.523846')
;

query III
SELECT t, t::TIMESTAMP_MS, t::TIMESTAMP_S
FROM issue11995
----
2024-05-10 11:06:33.446	2024-05-10 11:06:33.446	2024-05-10 11:06:33
2024-05-10 11:06:33.846	2024-05-10 11:06:33.846	2024-05-10 11:06:34
2024-05-10 11:06:33.123446	2024-05-10 11:06:33.123	2024-05-10 11:06:33
2024-05-10 11:06:33.523846	2024-05-10 11:06:33.524	2024-05-10 11:06:34

# Negative rounding
query I
select '1900-01-01 03:08:47'::TIMESTAMP::TIMESTAMP_MS;
----
1900-01-01 03:08:47
