# name: test/sql/types/decimal/decimal_aggregates.test
# description: Test decimal aggregates
# group: [decimal]

statement ok
PRAGMA enable_verification

query I
SELECT typeof(FIRST('0.1'::DECIMAL(4,1)))
----
DECIMAL(4,1)

# scalar aggregates
# first
query IIIII
SELECT FIRST(NULL::DECIMAL),
       FIRST('0.1'::DECIMAL(4,1))::VARCHAR,
       FIRST('4938245.1'::DECIMAL(9,1))::VARCHAR,
       FIRST('45672564564938245.1'::DECIMAL(18,1))::VARCHAR,
       FIRST('4567645908450368043562342564564938245.1'::DECIMAL(38,1))::VARCHAR
----
NULL
0.1
4938245.1
45672564564938245.1
4567645908450368043562342564564938245.1

# min
query IIIII
SELECT MIN(NULL::DECIMAL),
       MIN('0.1'::DECIMAL(4,1))::VARCHAR,
       MIN('4938245.1'::DECIMAL(9,1))::VARCHAR,
       MIN('45672564564938245.1'::DECIMAL(18,1))::VARCHAR,
       MIN('4567645908450368043562342564564938245.1'::DECIMAL(38,1))::VARCHAR
----
NULL
0.1
4938245.1
45672564564938245.1
4567645908450368043562342564564938245.1

query IIIII
SELECT MAX(NULL::DECIMAL),
       MAX('0.1'::DECIMAL(4,1))::VARCHAR,
       MAX('4938245.1'::DECIMAL(9,1))::VARCHAR,
       MAX('45672564564938245.1'::DECIMAL(18,1))::VARCHAR,
       MAX('4567645908450368043562342564564938245.1'::DECIMAL(38,1))::VARCHAR
----
NULL
0.1
4938245.1
45672564564938245.1
4567645908450368043562342564564938245.1

# sum
query IIIII
SELECT SUM(NULL::DECIMAL),
       SUM('0.1'::DECIMAL(4,1))::VARCHAR,
       SUM('4938245.1'::DECIMAL(9,1))::VARCHAR,
       SUM('45672564564938245.1'::DECIMAL(18,1))::VARCHAR,
       SUM('4567645908450368043562342564564938245.1'::DECIMAL(38,1))::VARCHAR
----
NULL
0.1
4938245.1
45672564564938245.1
4567645908450368043562342564564938245.1

# decimal aggregates over a table
statement ok
CREATE TABLE decimals AS SELECT i::DECIMAL(4,1) AS d1, (i * i)::DECIMAL(9,1) AS d2, (i * i * i)::DECIMAL(18,1) AS d3, (i * i * i * i)::DECIMAL(38,1) AS d4 FROM range(1000) tbl(i);

query IIII
SELECT SUM(d1)::VARCHAR, SUM(d2)::VARCHAR, SUM(d3)::VARCHAR, SUM(d4)::VARCHAR FROM decimals;
----
499500.0
332833500.0
249500250000.0
199500333333300.0

statement ok
INSERT INTO decimals VALUES ('0.1', '0.1', '0.1', '0.1'), ('0.2', '0.2', '0.2', '0.2')

query IIII
SELECT SUM(d1)::VARCHAR, SUM(d2)::VARCHAR, SUM(d3)::VARCHAR, SUM(d4)::VARCHAR FROM decimals;
----
499500.3
332833500.3
249500250000.3
199500333333300.3
