# name: test/sql/types/struct/struct_stats.test
# description: Test stats propagation for structs
# group: [struct]

# struct stats
query II
SELECT s.child_stats.i.min, s.child_stats.j.min FROM (SELECT STATS({'i': 3, 'j': 4}) s)
----
3	4

query I
SELECT STATS(NULL::ROW(i INTEGER)).has_null
----
true

statement ok
CREATE TABLE integers AS SELECT 3 i, 4 j

query II
SELECT s.child_stats.i.min, s.child_stats.j.min FROM (SELECT STATS({'i': i, 'j': j}) s FROM integers)
----
3	4

statement ok
CREATE TABLE structs AS SELECT {'i': 3, 'j': 4} s

query II
SELECT s.min, s.max FROM (SELECT STATS(s['i']) s FROM structs)
----
3	3
