# name: test/sql/json/issues/issue13212.test
# description: Test issue 13212 - Trying to read an empty compressed JSON file deadlocks
# group: [issues]

require json

statement ok
copy (select range::int64 as id, range::varchar as name from range(0)) to '{TEMP_DIR}/t1.json.gz' (format json, compression gzip)

statement ok
copy (select id, name from values (1, 'bob'), (2, 'tom') tbl(id, name)) to '{TEMP_DIR}/t2.json.gz' (format json, compression gzip)

query II
SELECT * FROM read_ndjson_auto(['{TEMP_DIR}/t1.json.gz', '{TEMP_DIR}/t2.json.gz']);
----
1	bob
2	tom

query II
SELECT * FROM read_ndjson(['{TEMP_DIR}/t1.json.gz', '{TEMP_DIR}/t2.json.gz'], columns={id: 'int64', name: 'varchar'});
----
1	bob
2	tom
