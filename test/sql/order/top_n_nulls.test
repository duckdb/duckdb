# name: test/sql/order/top_n_nulls.test
# description: Issue #3015: Wrong result on using limit after order by on null data
# group: [order]

require parquet

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE orders_small AS SELECT * FROM parquet_scan('{DATA_DIR}/parquet-testing/orders_small_parquet.test');

query IIII nosort
select o_orderkey, o_clerk, o_orderstatus, o_totalprice from orders_small
                    order by o_orderkey NULLS FIRST,
                    o_clerk NULLS FIRST, o_orderstatus NULLS FIRST,
                    o_totalprice DESC NULLS LAST limit 360
----
NULL	NULL	NULL	340307.430000
NULL	NULL	NULL	328268.960000
NULL	NULL	NULL	311077.000000
NULL	NULL	NULL	296731.500000
NULL	NULL	NULL	287540.740000
NULL	NULL	NULL	282895.800000
NULL	NULL	NULL	281298.110000
NULL	NULL	NULL	280581.420000
NULL	NULL	NULL	276437.190000
NULL	NULL	NULL	260191.440000
NULL	NULL	NULL	255481.810000
NULL	NULL	NULL	251755.620000
NULL	NULL	NULL	238936.970000
NULL	NULL	NULL	235488.940000
NULL	NULL	NULL	230766.480000
NULL	NULL	NULL	221161.270000
NULL	NULL	NULL	219740.510000
NULL	NULL	NULL	214573.210000
NULL	NULL	NULL	210796.750000
NULL	NULL	NULL	206883.430000
NULL	NULL	NULL	204126.000000
NULL	NULL	NULL	198265.350000
NULL	NULL	NULL	193082.890000
NULL	NULL	NULL	192187.210000
NULL	NULL	NULL	191412.290000
NULL	NULL	NULL	189947.500000
NULL	NULL	NULL	189469.700000
NULL	NULL	NULL	183980.860000
NULL	NULL	NULL	181677.640000
NULL	NULL	NULL	174652.870000
NULL	NULL	NULL	174059.570000
NULL	NULL	NULL	173183.720000
NULL	NULL	NULL	170431.860000
NULL	NULL	NULL	160457.990000
NULL	NULL	NULL	160015.960000
NULL	NULL	NULL	153975.860000
NULL	NULL	NULL	151788.070000
NULL	NULL	NULL	150238.370000
NULL	NULL	NULL	145402.270000
NULL	NULL	NULL	143916.630000
NULL	NULL	NULL	136488.480000
NULL	NULL	NULL	131805.810000
NULL	NULL	NULL	128850.630000
NULL	NULL	NULL	123049.400000
NULL	NULL	NULL	121868.460000
NULL	NULL	NULL	119830.710000
NULL	NULL	NULL	117567.130000
NULL	NULL	NULL	117093.370000
NULL	NULL	NULL	116790.600000
NULL	NULL	NULL	114017.090000
NULL	NULL	NULL	112280.850000
NULL	NULL	NULL	108964.770000
NULL	NULL	NULL	105069.160000
NULL	NULL	NULL	100327.500000
NULL	NULL	NULL	91474.220000
NULL	NULL	NULL	91157.110000
NULL	NULL	NULL	89944.360000
NULL	NULL	NULL	89260.550000
NULL	NULL	NULL	81688.190000
NULL	NULL	NULL	77790.850000
NULL	NULL	NULL	72973.350000
NULL	NULL	NULL	72294.020000
NULL	NULL	NULL	70595.250000
NULL	NULL	NULL	68764.000000
NULL	NULL	NULL	66378.020000
NULL	NULL	NULL	60710.700000
NULL	NULL	NULL	59559.860000
NULL	NULL	NULL	56336.190000
NULL	NULL	NULL	53129.160000
NULL	NULL	NULL	51239.440000
NULL	NULL	NULL	50790.560000
NULL	NULL	NULL	49809.520000
NULL	NULL	NULL	39928.110000
NULL	NULL	NULL	37660.850000
NULL	NULL	NULL	35837.020000
NULL	NULL	NULL	35221.510000
NULL	NULL	NULL	33490.570000
NULL	NULL	NULL	32591.640000
NULL	NULL	NULL	30177.050000
NULL	NULL	NULL	29118.170000
NULL	NULL	NULL	28303.130000
NULL	NULL	NULL	26876.620000
NULL	NULL	NULL	26831.140000
NULL	NULL	NULL	25872.660000
NULL	NULL	NULL	24616.040000
NULL	NULL	NULL	16314.050000
NULL	NULL	NULL	11312.690000
NULL	NULL	NULL	9014.680000
NULL	NULL	NULL	7503.460000
NULL	NULL	NULL	3871.100000
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
NULL	NULL	F	349989.590000
NULL	NULL	F	335735.690000
NULL	NULL	F	334041.320000
NULL	NULL	F	331669.090000
NULL	NULL	F	324398.570000
NULL	NULL	F	317411.930000
NULL	NULL	F	310895.320000
NULL	NULL	F	307954.380000
NULL	NULL	F	307926.950000
NULL	NULL	F	307456.010000
NULL	NULL	F	301166.380000
NULL	NULL	F	299823.740000
NULL	NULL	F	297072.030000
NULL	NULL	F	290385.740000
NULL	NULL	F	287405.920000
NULL	NULL	F	286773.610000
NULL	NULL	F	283529.640000
NULL	NULL	F	282014.470000
NULL	NULL	F	280603.770000
NULL	NULL	F	280405.880000
NULL	NULL	F	277061.220000
NULL	NULL	F	275521.330000
NULL	NULL	F	275281.660000
NULL	NULL	F	274822.480000
NULL	NULL	F	274538.860000
NULL	NULL	F	271586.860000
NULL	NULL	F	271217.930000
NULL	NULL	F	267185.150000
NULL	NULL	F	265957.830000
NULL	NULL	F	265607.080000
NULL	NULL	F	264533.250000
NULL	NULL	F	262449.110000
NULL	NULL	F	261300.360000
NULL	NULL	F	261050.210000
NULL	NULL	F	261039.730000
NULL	NULL	F	260351.140000
NULL	NULL	F	259840.310000
NULL	NULL	F	259657.840000
NULL	NULL	F	259404.300000
NULL	NULL	F	259087.990000
NULL	NULL	F	258684.610000
NULL	NULL	F	258579.980000
NULL	NULL	F	255602.240000
NULL	NULL	F	254618.410000
NULL	NULL	F	254548.570000
NULL	NULL	F	251805.990000
NULL	NULL	F	251406.480000
NULL	NULL	F	249275.230000
NULL	NULL	F	248725.100000
NULL	NULL	F	247746.980000
NULL	NULL	F	245039.860000
NULL	NULL	F	243023.190000
NULL	NULL	F	242643.430000
NULL	NULL	F	240655.790000
NULL	NULL	F	237034.940000
NULL	NULL	F	236460.550000
NULL	NULL	F	235617.950000
NULL	NULL	F	234010.760000
NULL	NULL	F	233966.350000
NULL	NULL	F	232113.320000
NULL	NULL	F	231373.450000
NULL	NULL	F	230457.040000
NULL	NULL	F	230024.970000
NULL	NULL	F	229414.590000
NULL	NULL	F	229288.880000
NULL	NULL	F	227618.780000
NULL	NULL	F	226055.660000
NULL	NULL	F	224525.850000
NULL	NULL	F	224312.920000
NULL	NULL	F	221370.780000
NULL	NULL	F	220339.470000
NULL	NULL	F	218914.010000
NULL	NULL	F	217495.070000
NULL	NULL	F	216985.390000
NULL	NULL	F	216810.390000
NULL	NULL	F	215663.160000
NULL	NULL	F	213374.730000
NULL	NULL	F	212335.410000
NULL	NULL	F	210283.090000
NULL	NULL	F	210208.890000
NULL	NULL	F	209585.840000
NULL	NULL	F	208296.890000
NULL	NULL	F	206582.090000
NULL	NULL	F	205314.640000
NULL	NULL	F	204582.020000
NULL	NULL	F	203543.550000
NULL	NULL	F	203411.630000
NULL	NULL	F	201576.660000
NULL	NULL	F	201176.510000
NULL	NULL	F	200947.270000
NULL	NULL	F	200545.740000
NULL	NULL	F	199261.930000
NULL	NULL	F	198914.570000
NULL	NULL	F	197486.590000
NULL	NULL	F	197033.240000
NULL	NULL	F	195414.010000
NULL	NULL	F	194761.080000
NULL	NULL	F	192862.200000
NULL	NULL	F	192520.790000
NULL	NULL	F	192441.180000
NULL	NULL	F	192381.000000
NULL	NULL	F	191444.080000
NULL	NULL	F	190905.510000
NULL	NULL	F	190592.950000
NULL	NULL	F	190482.600000
NULL	NULL	F	190126.760000
NULL	NULL	F	189290.690000
NULL	NULL	F	189280.540000
NULL	NULL	F	189039.370000
NULL	NULL	F	188680.090000
NULL	NULL	F	188324.420000
NULL	NULL	F	186916.290000
NULL	NULL	F	185390.890000
NULL	NULL	F	184643.070000
NULL	NULL	F	184613.750000
NULL	NULL	F	184004.000000
NULL	NULL	F	183526.660000
NULL	NULL	F	182684.960000
NULL	NULL	F	182121.850000
NULL	NULL	F	181182.020000
NULL	NULL	F	180412.050000
NULL	NULL	F	180382.950000
NULL	NULL	F	179741.160000
NULL	NULL	F	177448.830000
NULL	NULL	F	175911.010000
NULL	NULL	F	174955.380000
NULL	NULL	F	174222.720000
NULL	NULL	F	174106.780000
NULL	NULL	F	172746.640000
NULL	NULL	F	171924.730000
NULL	NULL	F	170743.710000
NULL	NULL	F	167759.370000
NULL	NULL	F	167610.730000
NULL	NULL	F	165444.940000
NULL	NULL	F	164345.780000
NULL	NULL	F	164210.980000
NULL	NULL	F	163944.310000
NULL	NULL	F	163621.130000
NULL	NULL	F	163139.720000
NULL	NULL	F	162738.140000
NULL	NULL	F	162711.120000
NULL	NULL	F	161834.180000
NULL	NULL	F	159414.900000
NULL	NULL	F	158465.110000
NULL	NULL	F	158152.500000
NULL	NULL	F	157920.790000
NULL	NULL	F	156943.760000
NULL	NULL	F	156784.600000
NULL	NULL	F	156284.740000
NULL	NULL	F	154704.520000
NULL	NULL	F	154168.110000
NULL	NULL	F	153286.520000
NULL	NULL	F	152816.280000
NULL	NULL	F	151336.470000
NULL	NULL	F	150115.300000
NULL	NULL	F	149905.600000
NULL	NULL	F	148433.120000
NULL	NULL	F	148101.930000
NULL	NULL	F	147915.500000
NULL	NULL	F	147468.300000
NULL	NULL	F	147137.150000
NULL	NULL	F	146549.030000
NULL	NULL	F	146314.600000
NULL	NULL	F	145156.930000
NULL	NULL	F	144953.970000
NULL	NULL	F	144682.770000
NULL	NULL	F	144609.160000
NULL	NULL	F	143556.160000
NULL	NULL	F	143512.900000
NULL	NULL	F	143497.600000
NULL	NULL	F	142891.770000
NULL	NULL	F	141951.070000
NULL	NULL	F	140798.730000
NULL	NULL	F	137584.680000
NULL	NULL	F	137271.360000
NULL	NULL	F	137213.650000
NULL	NULL	F	136725.440000
NULL	NULL	F	136031.060000
NULL	NULL	F	136029.040000
NULL	NULL	F	135615.450000

query IIII
select o_orderkey, o_clerk, o_orderstatus, o_totalprice from orders_small
                    order by o_orderkey NULLS FIRST,
                    o_clerk NULLS FIRST, o_orderstatus NULLS FIRST,
                    o_totalprice DESC NULLS LAST limit 10 offset 440
----
NULL	NULL	F	74729.940000
NULL	NULL	F	73548.220000
NULL	NULL	F	71831.320000
NULL	NULL	F	71567.380000
NULL	NULL	F	71439.220000
NULL	NULL	F	71204.140000
NULL	NULL	F	71112.310000
NULL	NULL	F	71109.080000
NULL	NULL	F	70261.720000
NULL	NULL	F	68763.210000
