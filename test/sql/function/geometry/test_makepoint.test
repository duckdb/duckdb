# name: test/sql/function/geometry/test_makepoint.test
# description: ST_MAKEPOINT test
# group: [geometry]

require geo

statement ok
PRAGMA enable_verification

# test basic 2D make point
query I
SELECT ST_MAKEPOINT(5, 6)
----
010100000000000000000014400000000000001840

# test basic #D make point
query I
SELECT ST_MAKEPOINT(5, 6, 7)
----
0101000080000000000000144000000000000018400000000000001C40

# test invalid decodes
statement error
SELECT ST_MAKEPOINT(5, 'a')

# test make point with table 
statement ok
CREATE TABLE tbl_doubles(p1 DOUBLE, p2 DOUBLE)

statement ok
INSERT INTO tbl_doubles VALUES (42.123456, 10.54), (-73.34343, 50.3432242)

query R
SELECT ST_MAKEPOINT(p1, p2) from tbl_doubles
----
01010000005B3FFD67CD0F454014AE47E17A142540
0101000000C79DD2C1FA5552C00F1945C5EE2B4940

#test make point with null value 
#statement ok
#DELETE FROM tbl_doubles

statement ok
INSERT INTO tbl_doubles VALUES(1.0, NULL), (-73.34343, 50.3432242)

query R
SELECT ST_MAKEPOINT(p1, p2) from tbl_doubles
----
01010000005B3FFD67CD0F454014AE47E17A142540
0101000000C79DD2C1FA5552C00F1945C5EE2B4940
NULL
0101000000C79DD2C1FA5552C00F1945C5EE2B4940

