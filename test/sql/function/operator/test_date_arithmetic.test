# name: test/sql/function/operator/test_date_arithmetic.test
# description: Test DATE + TIME
# group: [operator]

statement ok
SET default_null_order='nulls_first';

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE dates(d DATE);

statement ok
INSERT INTO dates VALUES
	('1992-01-01'),
	('1992-03-03'),
	('1992-05-05'),
	('2022-01-01'),
	('044-03-15 (BC)'),
	(NULL);

statement ok
CREATE TABLE times(t TIME)

statement ok
INSERT INTO times VALUES
	('00:01:20'),
	('20:08:10.998'),
	('20:08:10.33'),
	('20:08:10.001'),
	(NULL);

query III
SELECT d, t, d + t
FROM dates, times
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20	NULL
NULL	20:08:10.001	NULL
NULL	20:08:10.33	NULL
NULL	20:08:10.998	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20	0044-03-15 (BC) 00:01:20
0044-03-15 (BC)	20:08:10.001	0044-03-15 (BC) 20:08:10.001
0044-03-15 (BC)	20:08:10.33	0044-03-15 (BC) 20:08:10.33
0044-03-15 (BC)	20:08:10.998	0044-03-15 (BC) 20:08:10.998
1992-01-01	NULL	NULL
1992-01-01	00:01:20	1992-01-01 00:01:20
1992-01-01	20:08:10.001	1992-01-01 20:08:10.001
1992-01-01	20:08:10.33	1992-01-01 20:08:10.33
1992-01-01	20:08:10.998	1992-01-01 20:08:10.998
1992-03-03	NULL	NULL
1992-03-03	00:01:20	1992-03-03 00:01:20
1992-03-03	20:08:10.001	1992-03-03 20:08:10.001
1992-03-03	20:08:10.33	1992-03-03 20:08:10.33
1992-03-03	20:08:10.998	1992-03-03 20:08:10.998
1992-05-05	NULL	NULL
1992-05-05	00:01:20	1992-05-05 00:01:20
1992-05-05	20:08:10.001	1992-05-05 20:08:10.001
1992-05-05	20:08:10.33	1992-05-05 20:08:10.33
1992-05-05	20:08:10.998	1992-05-05 20:08:10.998
2022-01-01	NULL	NULL
2022-01-01	00:01:20	2022-01-01 00:01:20
2022-01-01	20:08:10.001	2022-01-01 20:08:10.001
2022-01-01	20:08:10.33	2022-01-01 20:08:10.33
2022-01-01	20:08:10.998	2022-01-01 20:08:10.998

query III
SELECT d, t, t + d
FROM dates, times
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20	NULL
NULL	20:08:10.001	NULL
NULL	20:08:10.33	NULL
NULL	20:08:10.998	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20	0044-03-15 (BC) 00:01:20
0044-03-15 (BC)	20:08:10.001	0044-03-15 (BC) 20:08:10.001
0044-03-15 (BC)	20:08:10.33	0044-03-15 (BC) 20:08:10.33
0044-03-15 (BC)	20:08:10.998	0044-03-15 (BC) 20:08:10.998
1992-01-01	NULL	NULL
1992-01-01	00:01:20	1992-01-01 00:01:20
1992-01-01	20:08:10.001	1992-01-01 20:08:10.001
1992-01-01	20:08:10.33	1992-01-01 20:08:10.33
1992-01-01	20:08:10.998	1992-01-01 20:08:10.998
1992-03-03	NULL	NULL
1992-03-03	00:01:20	1992-03-03 00:01:20
1992-03-03	20:08:10.001	1992-03-03 20:08:10.001
1992-03-03	20:08:10.33	1992-03-03 20:08:10.33
1992-03-03	20:08:10.998	1992-03-03 20:08:10.998
1992-05-05	NULL	NULL
1992-05-05	00:01:20	1992-05-05 00:01:20
1992-05-05	20:08:10.001	1992-05-05 20:08:10.001
1992-05-05	20:08:10.33	1992-05-05 20:08:10.33
1992-05-05	20:08:10.998	1992-05-05 20:08:10.998
2022-01-01	NULL	NULL
2022-01-01	00:01:20	2022-01-01 00:01:20
2022-01-01	20:08:10.001	2022-01-01 20:08:10.001
2022-01-01	20:08:10.33	2022-01-01 20:08:10.33
2022-01-01	20:08:10.998	2022-01-01 20:08:10.998

statement ok
CREATE TABLE timetzs(ttz TIMETZ)

statement ok
INSERT INTO timetzs VALUES
	('00:01:20+00'),
	('20:08:10.998-07'),
	('20:08:10.33+12'),
	('20:08:10.001-1559'),
	(NULL);

query III
SELECT d, ttz, d + ttz
FROM dates, timetzs
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20+00	NULL
NULL	20:08:10.33+12	NULL
NULL	20:08:10.998-07	NULL
NULL	20:08:10.001-15:59	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20+00	0044-03-15 (BC) 00:01:20+00
0044-03-15 (BC)	20:08:10.33+12	0044-03-15 (BC) 08:08:10.33+00
0044-03-15 (BC)	20:08:10.998-07	0044-03-16 (BC) 03:08:10.998+00
0044-03-15 (BC)	20:08:10.001-15:59	0044-03-16 (BC) 12:07:10.001+00
1992-01-01	NULL	NULL
1992-01-01	00:01:20+00	1992-01-01 00:01:20+00
1992-01-01	20:08:10.33+12	1992-01-01 08:08:10.33+00
1992-01-01	20:08:10.998-07	1992-01-02 03:08:10.998+00
1992-01-01	20:08:10.001-15:59	1992-01-02 12:07:10.001+00
1992-03-03	NULL	NULL
1992-03-03	00:01:20+00	1992-03-03 00:01:20+00
1992-03-03	20:08:10.33+12	1992-03-03 08:08:10.33+00
1992-03-03	20:08:10.998-07	1992-03-04 03:08:10.998+00
1992-03-03	20:08:10.001-15:59	1992-03-04 12:07:10.001+00
1992-05-05	NULL	NULL
1992-05-05	00:01:20+00	1992-05-05 00:01:20+00
1992-05-05	20:08:10.33+12	1992-05-05 08:08:10.33+00
1992-05-05	20:08:10.998-07	1992-05-06 03:08:10.998+00
1992-05-05	20:08:10.001-15:59	1992-05-06 12:07:10.001+00
2022-01-01	NULL	NULL
2022-01-01	00:01:20+00	2022-01-01 00:01:20+00
2022-01-01	20:08:10.33+12	2022-01-01 08:08:10.33+00
2022-01-01	20:08:10.998-07	2022-01-02 03:08:10.998+00
2022-01-01	20:08:10.001-15:59	2022-01-02 12:07:10.001+00

query III
SELECT d, ttz, ttz + d
FROM dates, timetzs
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20+00	NULL
NULL	20:08:10.33+12	NULL
NULL	20:08:10.998-07	NULL
NULL	20:08:10.001-15:59	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20+00	0044-03-15 (BC) 00:01:20+00
0044-03-15 (BC)	20:08:10.33+12	0044-03-15 (BC) 08:08:10.33+00
0044-03-15 (BC)	20:08:10.998-07	0044-03-16 (BC) 03:08:10.998+00
0044-03-15 (BC)	20:08:10.001-15:59	0044-03-16 (BC) 12:07:10.001+00
1992-01-01	NULL	NULL
1992-01-01	00:01:20+00	1992-01-01 00:01:20+00
1992-01-01	20:08:10.33+12	1992-01-01 08:08:10.33+00
1992-01-01	20:08:10.998-07	1992-01-02 03:08:10.998+00
1992-01-01	20:08:10.001-15:59	1992-01-02 12:07:10.001+00
1992-03-03	NULL	NULL
1992-03-03	00:01:20+00	1992-03-03 00:01:20+00
1992-03-03	20:08:10.33+12	1992-03-03 08:08:10.33+00
1992-03-03	20:08:10.998-07	1992-03-04 03:08:10.998+00
1992-03-03	20:08:10.001-15:59	1992-03-04 12:07:10.001+00
1992-05-05	NULL	NULL
1992-05-05	00:01:20+00	1992-05-05 00:01:20+00
1992-05-05	20:08:10.33+12	1992-05-05 08:08:10.33+00
1992-05-05	20:08:10.998-07	1992-05-06 03:08:10.998+00
1992-05-05	20:08:10.001-15:59	1992-05-06 12:07:10.001+00
2022-01-01	NULL	NULL
2022-01-01	00:01:20+00	2022-01-01 00:01:20+00
2022-01-01	20:08:10.33+12	2022-01-01 08:08:10.33+00
2022-01-01	20:08:10.998-07	2022-01-02 03:08:10.998+00
2022-01-01	20:08:10.001-15:59	2022-01-02 12:07:10.001+00

# Overflow
statement error
SELECT '294247-01-10'::DATE + '04:00:54.775808'::TIME;
----
