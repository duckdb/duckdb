# name: test/sql/function/operator/test_date_arithmetic.test
# description: Test DATE + TIME
# group: [operator]

statement ok
SET default_null_order='nulls_first';

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE dates(d DATE);

statement ok
INSERT INTO dates VALUES
	('1992-01-01'),
	('1992-03-03'),
	('1992-05-05'),
	('2022-01-01'),
	('044-03-15 (BC)'),
	(NULL);

statement ok
CREATE TABLE times(t TIME)

statement ok
INSERT INTO times VALUES
	('00:01:20'),
	('20:08:10.998'),
	('20:08:10.33'),
	('20:08:10.001'),
	(NULL);

query III
SELECT d, t, d + t
FROM dates, times
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20	NULL
NULL	20:08:10.001	NULL
NULL	20:08:10.33	NULL
NULL	20:08:10.998	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20	0044-03-15 (BC) 00:01:20
0044-03-15 (BC)	20:08:10.001	0044-03-15 (BC) 20:08:10.001
0044-03-15 (BC)	20:08:10.33	0044-03-15 (BC) 20:08:10.33
0044-03-15 (BC)	20:08:10.998	0044-03-15 (BC) 20:08:10.998
1992-01-01	NULL	NULL
1992-01-01	00:01:20	1992-01-01 00:01:20
1992-01-01	20:08:10.001	1992-01-01 20:08:10.001
1992-01-01	20:08:10.33	1992-01-01 20:08:10.33
1992-01-01	20:08:10.998	1992-01-01 20:08:10.998
1992-03-03	NULL	NULL
1992-03-03	00:01:20	1992-03-03 00:01:20
1992-03-03	20:08:10.001	1992-03-03 20:08:10.001
1992-03-03	20:08:10.33	1992-03-03 20:08:10.33
1992-03-03	20:08:10.998	1992-03-03 20:08:10.998
1992-05-05	NULL	NULL
1992-05-05	00:01:20	1992-05-05 00:01:20
1992-05-05	20:08:10.001	1992-05-05 20:08:10.001
1992-05-05	20:08:10.33	1992-05-05 20:08:10.33
1992-05-05	20:08:10.998	1992-05-05 20:08:10.998
2022-01-01	NULL	NULL
2022-01-01	00:01:20	2022-01-01 00:01:20
2022-01-01	20:08:10.001	2022-01-01 20:08:10.001
2022-01-01	20:08:10.33	2022-01-01 20:08:10.33
2022-01-01	20:08:10.998	2022-01-01 20:08:10.998

query III
SELECT d, t, t + d
FROM dates, times
ORDER BY 1, 2
----
NULL	NULL	NULL
NULL	00:01:20	NULL
NULL	20:08:10.001	NULL
NULL	20:08:10.33	NULL
NULL	20:08:10.998	NULL
0044-03-15 (BC)	NULL	NULL
0044-03-15 (BC)	00:01:20	0044-03-15 (BC) 00:01:20
0044-03-15 (BC)	20:08:10.001	0044-03-15 (BC) 20:08:10.001
0044-03-15 (BC)	20:08:10.33	0044-03-15 (BC) 20:08:10.33
0044-03-15 (BC)	20:08:10.998	0044-03-15 (BC) 20:08:10.998
1992-01-01	NULL	NULL
1992-01-01	00:01:20	1992-01-01 00:01:20
1992-01-01	20:08:10.001	1992-01-01 20:08:10.001
1992-01-01	20:08:10.33	1992-01-01 20:08:10.33
1992-01-01	20:08:10.998	1992-01-01 20:08:10.998
1992-03-03	NULL	NULL
1992-03-03	00:01:20	1992-03-03 00:01:20
1992-03-03	20:08:10.001	1992-03-03 20:08:10.001
1992-03-03	20:08:10.33	1992-03-03 20:08:10.33
1992-03-03	20:08:10.998	1992-03-03 20:08:10.998
1992-05-05	NULL	NULL
1992-05-05	00:01:20	1992-05-05 00:01:20
1992-05-05	20:08:10.001	1992-05-05 20:08:10.001
1992-05-05	20:08:10.33	1992-05-05 20:08:10.33
1992-05-05	20:08:10.998	1992-05-05 20:08:10.998
2022-01-01	NULL	NULL
2022-01-01	00:01:20	2022-01-01 00:01:20
2022-01-01	20:08:10.001	2022-01-01 20:08:10.001
2022-01-01	20:08:10.33	2022-01-01 20:08:10.33
2022-01-01	20:08:10.998	2022-01-01 20:08:10.998

# Overflow
statement error
SELECT '294247-01-10'::DATE + '04:00:54.775808'::TIME;
