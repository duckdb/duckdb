# name: test/sql/function/numeric/test_gcd_lcm.test
# description: Test gcd and lcm
# group: [numeric]

statement ok
PRAGMA enable_verification

query IIIIII
SELECT a, b, gcd(a, b), gcd(a, -b), gcd(b, a), gcd(-b, a)
FROM (VALUES (0::int8, 0::int8),
             (0::int8, 29893644334::int8),
             (288484263558::int8, 29893644334::int8),
             (-288484263558::int8, 29893644334::int8),
             ((-9223372036854775808)::int8, 1::int8),
             ((-9223372036854775808)::int8, 9223372036854775807::int8),
             ((-9223372036854775808)::int8, 4611686018427387904::int8)) AS v(a, b);
----
0	0	0	0	0	0
0	29893644334	29893644334	29893644334	29893644334	29893644334
288484263558	29893644334	6835958	6835958	6835958	6835958
-288484263558	29893644334	6835958	6835958	6835958	6835958
-9223372036854775808	1	1	1	1	1
-9223372036854775808	9223372036854775807	1	1	1	1
-9223372036854775808	4611686018427387904	4611686018427387904	4611686018427387904	4611686018427387904	4611686018427387904

query I
SELECT gcd(42, NULL)
----
NULL

statement error
SELECT gcd(42, 'abcd')

query I
select lcm(120,25);
----
600

query IIIIII
SELECT a, b, lcm(a, b), lcm(a, -b), lcm(b, a), lcm(-b, a)
FROM (VALUES (0::int8, 0::int8),
             (0::int8, 29893644334::int8),
             (29893644334::int8, 29893644334::int8),
             (288484263558::int8, 29893644334::int8),
             (-288484263558::int8, 29893644334::int8),
             ((-9223372036854775808)::int8, 0::int8)) AS v(a, b);
----
0	0	0	0	0	0
0	29893644334	0	0	0	0
29893644334	29893644334	29893644334	29893644334	29893644334	29893644334
288484263558	29893644334	1261541684539134	1261541684539134	1261541684539134	1261541684539134
-288484263558	29893644334	1261541684539134	1261541684539134	1261541684539134	1261541684539134
-9223372036854775808	0	0	0	0	0

query I
SELECT lcm(42, NULL)
----
NULL

statement error
SELECT lcm(42, 'abcd')

statement error
select lcm(4200000000000000000,5700000000000000000)
