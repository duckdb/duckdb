# name: test/sql/function/string/test_translate.test
# description: TRANSLATE test
# group: [string]

statement ok
PRAGMA enable_verification

# test translate on NULLs
query T
select TRANSLATE('This is the main test string', NULL, 'ALT')
----
NULL

query T
select TRANSLATE(NULL, 'main', 'ALT')
----
NULL

query T
select TRANSLATE('This is the main test string', 'main', NULL)
----
NULL

# test translate on scalars
query T
select TRANSLATE('12', '2', 'a')
----
1a

query T
select TRANSLATE('abcde', 'abcde', 'fghij')
----
fghij

query T
select TRANSLATE('abcde', 'aabcc', '14235')
----
123de

query T
select TRANSLATE('https://dxyzdb.org', 'zyx.orghttps:/', 'kcu')
----
duckdb

query T
select TRANSLATE('12345', '14367', 'ax')
----
a2x5

query T
select TRANSLATE('hacco worcdxxx', 'acx2', 'el')
----
hello world

query T
select TRANSLATE('hacCo worcd', 'acC', 'ellaabb')
----
hello world

# test translate on tables
statement ok
CREATE TABLE strings(a STRING, b STRING)

statement ok
INSERT INTO strings VALUES ('Hello', 'World'), ('HuLlD', NULL), ('MotörHead','RÄcks'), ('', NULL)

query T
select TRANSLATE(a, 'Hl', 'A-') FROM strings
----
Ae--o
AuL-D
MotörAead
(empty)

query T
select TRANSLATE(b, 'Wl', 'w') FROM strings
----
word
NULL
RÄcks
NULL

query T
select TRANSLATE(a, 'oel', 'OEL') FROM strings WHERE b IS NOT NULL
----
HELLO
MOtörHEad

# test incorrect usage of translate
statement error
select TRANSLATE(1)

statement error
select TRANSLATE(1, 2)

statement error
select TRANSLATE(1, 2, 3, 4)

