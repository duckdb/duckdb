# name: test/sql/function/string/test_translate.test
# description: TRANSLATE test
# group: [string]

statement ok
PRAGMA enable_verification

# test translate on NULLs
query T
select TRANSLATE('This is the main test string', NULL, 'ALT')
----
NULL

query T
select TRANSLATE(NULL, 'main', 'ALT')
----
NULL

query T
select TRANSLATE('This is the main test string', 'main', NULL)
----
NULL

# test translate on scalars
query T
select TRANSLATE('12', '2', 'a')
----
1a

query T
select TRANSLATE('abcde', 'abcde', 'fghij')
----
fghij

query T
select TRANSLATE('abcde', 'aabcc', '14235')
----
123de

query T
select TRANSLATE('https://dxyzdb.org', 'zyx.orghttps:/', 'kcu')
----
duckdb

query T
select TRANSLATE('12345', '14367', 'ax')
----
a2x5

query T
select TRANSLATE('hacco worcdxxx', 'acx2', 'el')
----
hello world

query T
select TRANSLATE('hacCo worcd', 'acC', 'ellaabb')
----
hello world

query T
select TRANSLATE('RÃ„cks', 'Ã„', 'A')
----
RAcks

query T
select TRANSLATE('ðŸ¦†', 'ðŸ¦†', 'D')
----
D

query T
select TRANSLATE('MotÃ¶rHeadÎ©', 'aeÎ©', 'eÃ„')
----
MotÃ¶rHÃ„ed

query T
select TRANSLATE('This is ðŸ±.', 'ðŸ±', 'ðŸ¦†')
----
This is ðŸ¦†.

query T
select TRANSLATE('Ã„aÃ±tâ‚¡XÃ¡ä½ å¥½ä¸–ç•Œæˆ‘', 'Ã±Ã¡ä¸–ç•Œæˆ‘xyz', 'naDBÃ¡')
----
Ã„antâ‚¡Xaä½ å¥½DBÃ¡

# test translate on tables
statement ok
CREATE TABLE strings(a STRING, b STRING)

statement ok
INSERT INTO strings VALUES ('Hello', 'World'), ('HuLlD', NULL), ('MotÃ¶rHead','RÃ„cks'), ('', NULL), ('Hi', 'ðŸ¦†')

query T
select TRANSLATE(a, 'Ã¶Hl', 'oA-') FROM strings
----
Ae--o
AuL-D
MotorAead
(empty)
Ai

query T
select TRANSLATE(a, 'loD', 'ðŸ¦†') FROM strings
----
HeðŸ¦†ðŸ¦†
HuLðŸ¦†
MtÃ¶rHead
(empty)
Hi

query T
select TRANSLATE(b, 'Ã„WðŸ¦†l', 'owðŸ±') FROM strings
----
word
NULL
Rocks
NULL
ðŸ±

query T
select TRANSLATE(a, 'oel', 'OEL') FROM strings WHERE b IS NOT NULL
----
HELLO
MOtÃ¶rHEad
Hi

# test incorrect usage of translate
statement error
select TRANSLATE(1)
----
Binder Error: No function matches the given name and argument types 'translate(INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	translate(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR

statement error
select TRANSLATE(1, 2)
----
Binder Error: No function matches the given name and argument types 'translate(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	translate(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR

statement error
select TRANSLATE(1, 2, 3, 4)
----
PLACEHOLDER_ERROR_MESSAGE2409

