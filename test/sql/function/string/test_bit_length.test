# name: test/sql/function/string/test_bit_length.test
# description: BIT_LENGTH test
# group: [string]

statement ok
PRAGMA enable_verification

# test on scalars
query IIIIII
select BIT_LENGTH(NULL), BIT_LENGTH(''), BIT_LENGTH('$'), BIT_LENGTH('Â¢'), BIT_LENGTH('â‚¬'), BIT_LENGTH('ðˆ')
----
NULL	0	8	16	24	32

# test on tables
statement ok
CREATE TABLE strings(a STRING, b STRING)

statement ok
INSERT INTO strings VALUES ('', 'Zero'), ('$', NULL), ('Â¢','Two'), ('â‚¬', NULL), ('ðˆ','Four')

query I
select BIT_LENGTH(a) FROM strings
----
0
8
16
24
32

query I
select BIT_LENGTH(b) FROM strings
----
32
NULL
24
NULL
32

query I
select BIT_LENGTH(a) FROM strings WHERE b IS NOT NULL
----
0
16
32

# test incorrect usage
statement error
select BIT_LENGTH()
----
Binder Error: No function matches the given name and argument types 'bit_length()'. You might need to add explicit type casts.
	Candidate functions:
	bit_length(VARCHAR) -> BIGINT
	bit_length(BIT) -> BIGINT

statement error
select BIT_LENGTH(1, 2)
----
Binder Error: No function matches the given name and argument types 'bit_length(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	bit_length(VARCHAR) -> BIGINT
	bit_length(BIT) -> BIGINT

