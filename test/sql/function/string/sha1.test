# name: test/sql/function/string/sha1.test
# description: Test the sha1 function
# group: [string]

statement ok
PRAGMA enable_verification

query II
SELECT sha1('hello'), sha1(NULL)
----
aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d
NULL

query I
SELECT sha1('')
----
da39a3ee5e6b4b0d3255bfef95601890afd80709

query I
SELECT sha1('\xff\xff'::BLOB)
----
a19f987b885f5a96069f4bc7f12b9e84ceba7dfa

statement ok
CREATE TABLE strings AS SELECT s::VARCHAR s FROM generate_series(0,10,1) t(s)

query II
SELECT sha1(s), sha1('1') FROM strings ORDER BY s
----
b6589fc6ab0dc82cf12099d1c2d40ab994e8410c	356a192b7913b04c54574d18c28d46e6395428ab
356a192b7913b04c54574d18c28d46e6395428ab	356a192b7913b04c54574d18c28d46e6395428ab
b1d5781111d84f7b3fe45a0852e59758cd7a87e5	356a192b7913b04c54574d18c28d46e6395428ab
da4b9237bacccdf19c0760cab7aec4a8359010b0	356a192b7913b04c54574d18c28d46e6395428ab
77de68daecd823babbb58edb1c8e14d7106e83bb	356a192b7913b04c54574d18c28d46e6395428ab
1b6453892473a467d07372d45eb05abc2031647a	356a192b7913b04c54574d18c28d46e6395428ab
ac3478d69a3c81fa62e60f5c3696165a4e5e6ac4	356a192b7913b04c54574d18c28d46e6395428ab
c1dfd96eea8cc2b62785275bca38ac261256e278	356a192b7913b04c54574d18c28d46e6395428ab
902ba3cda1883801594b6e1b452790cc53948fda	356a192b7913b04c54574d18c28d46e6395428ab
fe5dbbcea5ce7e2988b8c69bcfdfde8904aabc1f	356a192b7913b04c54574d18c28d46e6395428ab
0ade7c2cf97f75d009975f4d720d1fa6c19f4897	356a192b7913b04c54574d18c28d46e6395428ab

query II
SELECT sha1(s), sha1('1') FROM strings WHERE s::INTEGER BETWEEN 1 AND 3 ORDER BY s
----
356a192b7913b04c54574d18c28d46e6395428ab	356a192b7913b04c54574d18c28d46e6395428ab
da4b9237bacccdf19c0760cab7aec4a8359010b0	356a192b7913b04c54574d18c28d46e6395428ab
77de68daecd823babbb58edb1c8e14d7106e83bb	356a192b7913b04c54574d18c28d46e6395428ab

statement error
SELECT sha1()
----

query I
SELECT sha1(''::blob)
----
da39a3ee5e6b4b0d3255bfef95601890afd80709

statement error
SELECT sha1(42)
----
