# name: test/sql/create/create_table_lakehouse_options.test
# description: Test CREATE OR REPLACE TABLE
# group: [create]

statement ok
pragma enable_verification

statement error
CREATE TABLE integers(i INTEGER) PARTITIONED BY (i);
----
<REGEX>:.*PARTITIONED BY is not supported for DuckDB tables.*

statement error
CREATE TABLE integers(i INTEGER) SORTED BY (i);
----
<REGEX>:.*SORTED BY is not supported for DuckDB tables.*

statement error
CREATE TABLE integers(i INTEGER) PARTITIONED BY (i) SORTED BY (i);
----
<REGEX>:.*PARTITIONED BY, SORTED BY are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder';
----
<REGEX>:.*LOCATION is not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*TBLPROPERTIES is not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
PARTITIONED BY (id)
SORTED BY (date)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
SORTED BY (date)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*TBLPROPERTIES is not supported for DuckDB tables.*


# different orders
statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
SORTED BY (date)
PARTITIONED BY (id)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
SORTED BY (date)
PARTITIONED BY (id)
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
SORTED BY (date)
PARTITIONED BY (id);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
LOCATION 's3://amzn-s3-demo-bucket/iceberg-folder'
TBLPROPERTIES (
  'table_type'='ICEBERG',
  'format'='parquet'
)
SORTED BY (date)
PARTITIONED BY (id);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, LOCATION, TBLPROPERTIES are not supported for DuckDB tables.*