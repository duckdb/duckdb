# name: test/sql/create/create_table_extra_options.test
# description: Test CREATE OR REPLACE TABLE
# group: [create]

statement ok
pragma enable_verification

statement error
CREATE TABLE integers(i INTEGER) PARTITIONED BY (i);
----
<REGEX>:.*PARTITIONED BY is not supported for DuckDB tables.*

statement error
CREATE TABLE integers(i INTEGER) SORTED BY (i);
----
<REGEX>:.*SORTED BY is not supported for DuckDB tables.*

statement error
CREATE TABLE integers(i INTEGER) PARTITIONED BY (i) SORTED BY (i);
----
<REGEX>:.*PARTITIONED BY, SORTED BY are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
WITH (location='s3://amzn-s3-demo-bucket/iceberg-folder');
----
<REGEX>:.*WITH is not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
WITH (
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*WITH is not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
PARTITIONED BY (id)
SORTED BY (date)
WITH (
  location='s3://amzn-s3-demo-bucket/iceberg-folder',
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, WITH are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
SORTED BY (date)
WITH (
  location='s3://amzn-s3-demo-bucket/iceberg-folder',
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*SORTED BY, WITH are not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
WITH (
  location='s3://amzn-s3-demo-bucket/iceberg-folder',
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*WITH is not supported for DuckDB tables.*

statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
WITH (
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*WITH is not supported for DuckDB tables.*


# different orders
statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
SORTED BY (date)
PARTITIONED BY (id)
WITH (
  location='s3://amzn-s3-demo-bucket/iceberg-folder',
  table_type='ICEBERG',
  format='parquet'
);
----
<REGEX>:.*PARTITIONED BY, SORTED BY, WITH are not supported for DuckDB tables.*

# WITH must come after sorted and partition options
statement error
CREATE TABLE iceberg_table (
  id int,
  data string,
  category string)
WITH (
  location='s3://amzn-s3-demo-bucket/iceberg-folder',
  table_type='ICEBERG',
  format='parquet'
)
SORTED BY (date)
PARTITIONED BY (id);
----
<REGEX>:.*Parser Error.*
