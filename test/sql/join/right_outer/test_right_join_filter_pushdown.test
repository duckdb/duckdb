# name: test/sql/join/right_outer/test_right_join_filter_pushdown.test
# description: Test RIGHT JOIN filter pushdown correctness
# group: [right_outer]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE left_table (id INTEGER, val INTEGER);

statement ok
INSERT INTO left_table VALUES (1, 1), (2, 1), (3, 2);

statement ok
CREATE TABLE right_table (id INTEGER, category INTEGER);

statement ok
INSERT INTO right_table VALUES (1, 1), (2, 2), (3, 1), (4, 1);

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND l.val > 1 AND r.category = 1;
----
3	2	3	1
NULL	NULL	1	1
NULL	NULL	2	2
NULL	NULL	4	1

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND r.category = 1;
----
1	1	1	1
3	2	3	1
NULL	NULL	2	2
NULL	NULL	4	1

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND l.val > 1;
----
3	2	3	1
NULL	NULL	1	1
NULL	NULL	2	2
NULL	NULL	4	1

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND true;
----
1	1	1	1
2	1	2	2
3	2	3	1
NULL	NULL	4	1

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND false;
----
NULL	NULL	1	1
NULL	NULL	2	2
NULL	NULL	3	1
NULL	NULL	4	1

query IIII rowsort
SELECT * FROM left_table l
RIGHT JOIN right_table r ON l.id = r.id AND l.val + r.category > 2;
----
2	1	2	2
3	2	3	1
NULL	NULL	1	1
NULL	NULL	4	1