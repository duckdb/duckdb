# name: test/sql/join/set_operators/test_set_operator_reordering.test
# description: Test reodering set operators
# group: [set_operators]

#
#statement ok
#create table big as select range%50 a from range(100000);
#
#statement ok
#create table small as select range b from range(55);
#
#statement ok
#select a, count(a) from small, big where a=b group by a;
#
#
#
#mode skip
#
#statement ok
#pragma disabled_optimizers='column_lifetime';

#statement ok
#attach 'tpch_sf1.db' as tpch
#
#statement ok
#use tpch;
#
#statement ok
#SELECT
#    l_orderkey,
#    sum(l_extendedprice * (1 - l_discount)) AS revenue,
#    o_orderdate,
#    o_shippriority
#FROM
#    customer,
#    orders,
#    lineitem
#WHERE
#    c_mktsegment = 'BUILDING'
#    AND c_custkey = o_custkey
#    AND l_orderkey = o_orderkey
#    AND o_orderdate < CAST('1995-03-15' AS date)
#    AND l_shipdate > CAST('1995-03-15' AS date)
#GROUP BY
#    l_orderkey,
#    o_orderdate,
#    o_shippriority
#ORDER BY
#    revenue DESC,
#    o_orderdate
#LIMIT 10;
#
#
#mode skip

statement ok
create or replace table xx as select w from (values ('a'),('b'),('c'),('d'),('e')) t(w);

statement ok
select w from (from xx limit 4)
CROSS JOIN (select 1 as f1) p
WHERE
   w IN (
	  SELECT 'a'
	  UNION -- with 'UNION ALL' it works also using 'limit 4'
	  SELECT 'b'
	  UNION
	  SELECT 'c' WHERE p.f1 = 1
	  UNION
	  SELECT 'd' WHERE p.f1 = 1
);