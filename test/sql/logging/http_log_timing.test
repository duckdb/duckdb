# name: test/sql/logging/http_log_timing.test
# description: Test basic logging functionality
# group: [logging]

require noforcestorage

require httpfs

statement ok
CALL enable_logging('HTTP')

statement ok
SET http_retries=2

statement error
FROM "http://localhost:2338/test.csv"
----

# Confirm that our request timing returns something reasonable
query  III
SELECT 
	request.type, 
	request.duration_ms >= 0,
	request.duration_ms <= 1000 * 1000
FROM 
	duckdb_logs_parsed('HTTP')
WHERE 
	request.type='HEAD'
----
HEAD	true	true
HEAD	true	true
HEAD	true	true
