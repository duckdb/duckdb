# name: test/sql/window/test_window_fusion.test
# description: Prefix sort fusion
# group: [window]

statement ok
PRAGMA enable_verification

# Subset of lineitem with only two partitions
statement ok
create table lineitem (
    l_extendedprice decimal(15,2),
    l_partkey integer,
    l_orderkey integer
);

statement ok
insert into lineitem (values 
	(29733.00, 1, 2883),
	(1802.00, 1, 5121),
	(4505.00, 1, 6179),
	(29733.00, 1, 6273),
	(30634.00, 1, 8645),
	(41446.00, 1, 12005),
	(36040.00, 1, 16135),
	(29733.00, 1, 16198),
	(26129.00, 1, 20199),
	(24327.00, 1, 22117),
	(19822.00, 1, 24866),
	(24327.00, 1, 26756),
	(9010.00, 1, 27558),
	(45050.00, 1, 29859),
	(2703.00, 1, 34692),
	(11713.00, 1, 36611),
	(18020.00, 1, 38051),
	(21624.00, 1, 42465),
	(36040.00, 1, 42758),
	(39644.00, 1, 47620),
	(28832.00, 1, 50498),
	(12614.00, 1, 51970),
	(2703.00, 1, 53189),
	(22525.00, 1, 53825),
	(21624.00, 1, 54592),
	(36941.00, 1, 59202),
	(18942.00, 2, 548),
	(17138.00, 2, 807),
	(24354.00, 2, 2117),
	(9020.00, 2, 2528),
	(28864.00, 2, 4102),
	(42394.00, 2, 4452),
	(11726.00, 2, 7458),
	(39688.00, 2, 27969),
	(37884.00, 2, 28900),
	(9922.00, 2, 30278),
	(12628.00, 2, 30597),
	(7216.00, 2, 33058),
	(41492.00, 2, 37026),
	(40590.00, 2, 37123),
	(36982.00, 2, 39809),
	(36080.00, 2, 41415),
	(18942.00, 2, 42147),
	(24354.00, 2, 42533),
	(41492.00, 2, 43650),
	(45100.00, 2, 44103),
	(17138.00, 2, 46913),
	(31570.00, 2, 50499),
	(37884.00, 2, 54086),
	(26158.00, 2, 54436),
	(4510.00, 2, 54436),
	(3608.00, 2, 54630),
	(41492.00, 2, 55136),
);

#
# Unpartitioned
#

# Single functions
query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(), 
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice
----
29733.00	1	2883	1314442.00
1802.00	1	5121	1314442.00
4505.00	1	6179	1314442.00
29733.00	1	6273	1314442.00
30634.00	1	8645	1314442.00
41446.00	1	12005	1314442.00
36040.00	1	16135	1314442.00
29733.00	1	16198	1314442.00
26129.00	1	20199	1314442.00
24327.00	1	22117	1314442.00
19822.00	1	24866	1314442.00
24327.00	1	26756	1314442.00
9010.00	1	27558	1314442.00
45050.00	1	29859	1314442.00
2703.00	1	34692	1314442.00
11713.00	1	36611	1314442.00
18020.00	1	38051	1314442.00
21624.00	1	42465	1314442.00
36040.00	1	42758	1314442.00
39644.00	1	47620	1314442.00
28832.00	1	50498	1314442.00
12614.00	1	51970	1314442.00
2703.00	1	53189	1314442.00
22525.00	1	53825	1314442.00
21624.00	1	54592	1314442.00
36941.00	1	59202	1314442.00
18942.00	2	548	1314442.00
17138.00	2	807	1314442.00
24354.00	2	2117	1314442.00
9020.00	2	2528	1314442.00
28864.00	2	4102	1314442.00
42394.00	2	4452	1314442.00
11726.00	2	7458	1314442.00
39688.00	2	27969	1314442.00
37884.00	2	28900	1314442.00
9922.00	2	30278	1314442.00
12628.00	2	30597	1314442.00
7216.00	2	33058	1314442.00
41492.00	2	37026	1314442.00
40590.00	2	37123	1314442.00
36982.00	2	39809	1314442.00
36080.00	2	41415	1314442.00
18942.00	2	42147	1314442.00
24354.00	2	42533	1314442.00
41492.00	2	43650	1314442.00
45100.00	2	44103	1314442.00
17138.00	2	46913	1314442.00
31570.00	2	50499	1314442.00
37884.00	2	54086	1314442.00
4510.00	2	54436	1314442.00
26158.00	2	54436	1314442.00
3608.00	2	54630	1314442.00
41492.00	2	55136	1314442.00

query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(order by l_partkey), 
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice
----
29733.00	1	2883	607274.00
1802.00	1	5121	607274.00
4505.00	1	6179	607274.00
29733.00	1	6273	607274.00
30634.00	1	8645	607274.00
41446.00	1	12005	607274.00
36040.00	1	16135	607274.00
29733.00	1	16198	607274.00
26129.00	1	20199	607274.00
24327.00	1	22117	607274.00
19822.00	1	24866	607274.00
24327.00	1	26756	607274.00
9010.00	1	27558	607274.00
45050.00	1	29859	607274.00
2703.00	1	34692	607274.00
11713.00	1	36611	607274.00
18020.00	1	38051	607274.00
21624.00	1	42465	607274.00
36040.00	1	42758	607274.00
39644.00	1	47620	607274.00
28832.00	1	50498	607274.00
12614.00	1	51970	607274.00
2703.00	1	53189	607274.00
22525.00	1	53825	607274.00
21624.00	1	54592	607274.00
36941.00	1	59202	607274.00
18942.00	2	548	1314442.00
17138.00	2	807	1314442.00
24354.00	2	2117	1314442.00
9020.00	2	2528	1314442.00
28864.00	2	4102	1314442.00
42394.00	2	4452	1314442.00
11726.00	2	7458	1314442.00
39688.00	2	27969	1314442.00
37884.00	2	28900	1314442.00
9922.00	2	30278	1314442.00
12628.00	2	30597	1314442.00
7216.00	2	33058	1314442.00
41492.00	2	37026	1314442.00
40590.00	2	37123	1314442.00
36982.00	2	39809	1314442.00
36080.00	2	41415	1314442.00
18942.00	2	42147	1314442.00
24354.00	2	42533	1314442.00
41492.00	2	43650	1314442.00
45100.00	2	44103	1314442.00
17138.00	2	46913	1314442.00
31570.00	2	50499	1314442.00
37884.00	2	54086	1314442.00
4510.00	2	54436	1314442.00
26158.00	2	54436	1314442.00
3608.00	2	54630	1314442.00
41492.00	2	55136	1314442.00

query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(order by l_partkey, l_orderkey), 
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	29733.00
1802.00	1	5121	31535.00
4505.00	1	6179	36040.00
29733.00	1	6273	65773.00
30634.00	1	8645	96407.00
41446.00	1	12005	137853.00
36040.00	1	16135	173893.00
29733.00	1	16198	203626.00
26129.00	1	20199	229755.00
24327.00	1	22117	254082.00
19822.00	1	24866	273904.00
24327.00	1	26756	298231.00
9010.00	1	27558	307241.00
45050.00	1	29859	352291.00
2703.00	1	34692	354994.00
11713.00	1	36611	366707.00
18020.00	1	38051	384727.00
21624.00	1	42465	406351.00
36040.00	1	42758	442391.00
39644.00	1	47620	482035.00
28832.00	1	50498	510867.00
12614.00	1	51970	523481.00
2703.00	1	53189	526184.00
22525.00	1	53825	548709.00
21624.00	1	54592	570333.00
36941.00	1	59202	607274.00
18942.00	2	548	626216.00
17138.00	2	807	643354.00
24354.00	2	2117	667708.00
9020.00	2	2528	676728.00
28864.00	2	4102	705592.00
42394.00	2	4452	747986.00
11726.00	2	7458	759712.00
39688.00	2	27969	799400.00
37884.00	2	28900	837284.00
9922.00	2	30278	847206.00
12628.00	2	30597	859834.00
7216.00	2	33058	867050.00
41492.00	2	37026	908542.00
40590.00	2	37123	949132.00
36982.00	2	39809	986114.00
36080.00	2	41415	1022194.00
18942.00	2	42147	1041136.00
24354.00	2	42533	1065490.00
41492.00	2	43650	1106982.00
45100.00	2	44103	1152082.00
17138.00	2	46913	1169220.00
31570.00	2	50499	1200790.00
37884.00	2	54086	1238674.00
26158.00	2	54436	1269342.00
4510.00	2	54436	1269342.00
3608.00	2	54630	1272950.00
41492.00	2	55136	1314442.00

query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(order by l_partkey, l_orderkey desc), 
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	607274.00
1802.00	1	5121	577541.00
4505.00	1	6179	575739.00
29733.00	1	6273	571234.00
30634.00	1	8645	541501.00
41446.00	1	12005	510867.00
36040.00	1	16135	469421.00
29733.00	1	16198	433381.00
26129.00	1	20199	403648.00
24327.00	1	22117	377519.00
19822.00	1	24866	353192.00
24327.00	1	26756	333370.00
9010.00	1	27558	309043.00
45050.00	1	29859	300033.00
2703.00	1	34692	254983.00
11713.00	1	36611	252280.00
18020.00	1	38051	240567.00
21624.00	1	42465	222547.00
36040.00	1	42758	200923.00
39644.00	1	47620	164883.00
28832.00	1	50498	125239.00
12614.00	1	51970	96407.00
2703.00	1	53189	83793.00
22525.00	1	53825	81090.00
21624.00	1	54592	58565.00
36941.00	1	59202	36941.00
18942.00	2	548	1314442.00
17138.00	2	807	1295500.00
24354.00	2	2117	1278362.00
9020.00	2	2528	1254008.00
28864.00	2	4102	1244988.00
42394.00	2	4452	1216124.00
11726.00	2	7458	1173730.00
39688.00	2	27969	1162004.00
37884.00	2	28900	1122316.00
9922.00	2	30278	1084432.00
12628.00	2	30597	1074510.00
7216.00	2	33058	1061882.00
41492.00	2	37026	1054666.00
40590.00	2	37123	1013174.00
36982.00	2	39809	972584.00
36080.00	2	41415	935602.00
18942.00	2	42147	899522.00
24354.00	2	42533	880580.00
41492.00	2	43650	856226.00
45100.00	2	44103	814734.00
17138.00	2	46913	769634.00
31570.00	2	50499	752496.00
37884.00	2	54086	720926.00
26158.00	2	54436	683042.00
4510.00	2	54436	683042.00
3608.00	2	54630	652374.00
41492.00	2	55136	648766.00

# Combined
query IIIIIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(), 
	sum(l_extendedprice) over(order by l_partkey), 
	sum(l_extendedprice) over(order by l_partkey, l_orderkey), 
	sum(l_extendedprice) over(order by l_partkey, l_orderkey desc), 
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	1314442.00	607274.00	29733.00	607274.00
1802.00	1	5121	1314442.00	607274.00	31535.00	577541.00
4505.00	1	6179	1314442.00	607274.00	36040.00	575739.00
29733.00	1	6273	1314442.00	607274.00	65773.00	571234.00
30634.00	1	8645	1314442.00	607274.00	96407.00	541501.00
41446.00	1	12005	1314442.00	607274.00	137853.00	510867.00
36040.00	1	16135	1314442.00	607274.00	173893.00	469421.00
29733.00	1	16198	1314442.00	607274.00	203626.00	433381.00
26129.00	1	20199	1314442.00	607274.00	229755.00	403648.00
24327.00	1	22117	1314442.00	607274.00	254082.00	377519.00
19822.00	1	24866	1314442.00	607274.00	273904.00	353192.00
24327.00	1	26756	1314442.00	607274.00	298231.00	333370.00
9010.00	1	27558	1314442.00	607274.00	307241.00	309043.00
45050.00	1	29859	1314442.00	607274.00	352291.00	300033.00
2703.00	1	34692	1314442.00	607274.00	354994.00	254983.00
11713.00	1	36611	1314442.00	607274.00	366707.00	252280.00
18020.00	1	38051	1314442.00	607274.00	384727.00	240567.00
21624.00	1	42465	1314442.00	607274.00	406351.00	222547.00
36040.00	1	42758	1314442.00	607274.00	442391.00	200923.00
39644.00	1	47620	1314442.00	607274.00	482035.00	164883.00
28832.00	1	50498	1314442.00	607274.00	510867.00	125239.00
12614.00	1	51970	1314442.00	607274.00	523481.00	96407.00
2703.00	1	53189	1314442.00	607274.00	526184.00	83793.00
22525.00	1	53825	1314442.00	607274.00	548709.00	81090.00
21624.00	1	54592	1314442.00	607274.00	570333.00	58565.00
36941.00	1	59202	1314442.00	607274.00	607274.00	36941.00
18942.00	2	548	1314442.00	1314442.00	626216.00	1314442.00
17138.00	2	807	1314442.00	1314442.00	643354.00	1295500.00
24354.00	2	2117	1314442.00	1314442.00	667708.00	1278362.00
9020.00	2	2528	1314442.00	1314442.00	676728.00	1254008.00
28864.00	2	4102	1314442.00	1314442.00	705592.00	1244988.00
42394.00	2	4452	1314442.00	1314442.00	747986.00	1216124.00
11726.00	2	7458	1314442.00	1314442.00	759712.00	1173730.00
39688.00	2	27969	1314442.00	1314442.00	799400.00	1162004.00
37884.00	2	28900	1314442.00	1314442.00	837284.00	1122316.00
9922.00	2	30278	1314442.00	1314442.00	847206.00	1084432.00
12628.00	2	30597	1314442.00	1314442.00	859834.00	1074510.00
7216.00	2	33058	1314442.00	1314442.00	867050.00	1061882.00
41492.00	2	37026	1314442.00	1314442.00	908542.00	1054666.00
40590.00	2	37123	1314442.00	1314442.00	949132.00	1013174.00
36982.00	2	39809	1314442.00	1314442.00	986114.00	972584.00
36080.00	2	41415	1314442.00	1314442.00	1022194.00	935602.00
18942.00	2	42147	1314442.00	1314442.00	1041136.00	899522.00
24354.00	2	42533	1314442.00	1314442.00	1065490.00	880580.00
41492.00	2	43650	1314442.00	1314442.00	1106982.00	856226.00
45100.00	2	44103	1314442.00	1314442.00	1152082.00	814734.00
17138.00	2	46913	1314442.00	1314442.00	1169220.00	769634.00
31570.00	2	50499	1314442.00	1314442.00	1200790.00	752496.00
37884.00	2	54086	1314442.00	1314442.00	1238674.00	720926.00
26158.00	2	54436	1314442.00	1314442.00	1269342.00	683042.00
4510.00	2	54436	1314442.00	1314442.00	1269342.00	683042.00
3608.00	2	54630	1314442.00	1314442.00	1272950.00	652374.00
41492.00	2	55136	1314442.00	1314442.00	1314442.00	648766.00

#
# Partitioned
#

# Single functions
query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(partition by l_partkey),
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	607274.00
1802.00	1	5121	607274.00
4505.00	1	6179	607274.00
29733.00	1	6273	607274.00
30634.00	1	8645	607274.00
41446.00	1	12005	607274.00
36040.00	1	16135	607274.00
29733.00	1	16198	607274.00
26129.00	1	20199	607274.00
24327.00	1	22117	607274.00
19822.00	1	24866	607274.00
24327.00	1	26756	607274.00
9010.00	1	27558	607274.00
45050.00	1	29859	607274.00
2703.00	1	34692	607274.00
11713.00	1	36611	607274.00
18020.00	1	38051	607274.00
21624.00	1	42465	607274.00
36040.00	1	42758	607274.00
39644.00	1	47620	607274.00
28832.00	1	50498	607274.00
12614.00	1	51970	607274.00
2703.00	1	53189	607274.00
22525.00	1	53825	607274.00
21624.00	1	54592	607274.00
36941.00	1	59202	607274.00
18942.00	2	548	707168.00
17138.00	2	807	707168.00
24354.00	2	2117	707168.00
9020.00	2	2528	707168.00
28864.00	2	4102	707168.00
42394.00	2	4452	707168.00
11726.00	2	7458	707168.00
39688.00	2	27969	707168.00
37884.00	2	28900	707168.00
9922.00	2	30278	707168.00
12628.00	2	30597	707168.00
7216.00	2	33058	707168.00
41492.00	2	37026	707168.00
40590.00	2	37123	707168.00
36982.00	2	39809	707168.00
36080.00	2	41415	707168.00
18942.00	2	42147	707168.00
24354.00	2	42533	707168.00
41492.00	2	43650	707168.00
45100.00	2	44103	707168.00
17138.00	2	46913	707168.00
31570.00	2	50499	707168.00
37884.00	2	54086	707168.00
26158.00	2	54436	707168.00
4510.00	2	54436	707168.00
3608.00	2	54630	707168.00
41492.00	2	55136	707168.00

query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(partition by l_partkey order by l_orderkey),
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	29733.00
1802.00	1	5121	31535.00
4505.00	1	6179	36040.00
29733.00	1	6273	65773.00
30634.00	1	8645	96407.00
41446.00	1	12005	137853.00
36040.00	1	16135	173893.00
29733.00	1	16198	203626.00
26129.00	1	20199	229755.00
24327.00	1	22117	254082.00
19822.00	1	24866	273904.00
24327.00	1	26756	298231.00
9010.00	1	27558	307241.00
45050.00	1	29859	352291.00
2703.00	1	34692	354994.00
11713.00	1	36611	366707.00
18020.00	1	38051	384727.00
21624.00	1	42465	406351.00
36040.00	1	42758	442391.00
39644.00	1	47620	482035.00
28832.00	1	50498	510867.00
12614.00	1	51970	523481.00
2703.00	1	53189	526184.00
22525.00	1	53825	548709.00
21624.00	1	54592	570333.00
36941.00	1	59202	607274.00
18942.00	2	548	18942.00
17138.00	2	807	36080.00
24354.00	2	2117	60434.00
9020.00	2	2528	69454.00
28864.00	2	4102	98318.00
42394.00	2	4452	140712.00
11726.00	2	7458	152438.00
39688.00	2	27969	192126.00
37884.00	2	28900	230010.00
9922.00	2	30278	239932.00
12628.00	2	30597	252560.00
7216.00	2	33058	259776.00
41492.00	2	37026	301268.00
40590.00	2	37123	341858.00
36982.00	2	39809	378840.00
36080.00	2	41415	414920.00
18942.00	2	42147	433862.00
24354.00	2	42533	458216.00
41492.00	2	43650	499708.00
45100.00	2	44103	544808.00
17138.00	2	46913	561946.00
31570.00	2	50499	593516.00
37884.00	2	54086	631400.00
26158.00	2	54436	662068.00
4510.00	2	54436	662068.00
3608.00	2	54630	665676.00
41492.00	2	55136	707168.00

query IIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(partition by l_partkey order by l_orderkey desc),
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	607274.00
1802.00	1	5121	577541.00
4505.00	1	6179	575739.00
29733.00	1	6273	571234.00
30634.00	1	8645	541501.00
41446.00	1	12005	510867.00
36040.00	1	16135	469421.00
29733.00	1	16198	433381.00
26129.00	1	20199	403648.00
24327.00	1	22117	377519.00
19822.00	1	24866	353192.00
24327.00	1	26756	333370.00
9010.00	1	27558	309043.00
45050.00	1	29859	300033.00
2703.00	1	34692	254983.00
11713.00	1	36611	252280.00
18020.00	1	38051	240567.00
21624.00	1	42465	222547.00
36040.00	1	42758	200923.00
39644.00	1	47620	164883.00
28832.00	1	50498	125239.00
12614.00	1	51970	96407.00
2703.00	1	53189	83793.00
22525.00	1	53825	81090.00
21624.00	1	54592	58565.00
36941.00	1	59202	36941.00
18942.00	2	548	707168.00
17138.00	2	807	688226.00
24354.00	2	2117	671088.00
9020.00	2	2528	646734.00
28864.00	2	4102	637714.00
42394.00	2	4452	608850.00
11726.00	2	7458	566456.00
39688.00	2	27969	554730.00
37884.00	2	28900	515042.00
9922.00	2	30278	477158.00
12628.00	2	30597	467236.00
7216.00	2	33058	454608.00
41492.00	2	37026	447392.00
40590.00	2	37123	405900.00
36982.00	2	39809	365310.00
36080.00	2	41415	328328.00
18942.00	2	42147	292248.00
24354.00	2	42533	273306.00
41492.00	2	43650	248952.00
45100.00	2	44103	207460.00
17138.00	2	46913	162360.00
31570.00	2	50499	145222.00
37884.00	2	54086	113652.00
26158.00	2	54436	75768.00
4510.00	2	54436	75768.00
3608.00	2	54630	45100.00
41492.00	2	55136	41492.00

# Combined
query IIIIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(partition by l_partkey),
	sum(l_extendedprice) over(partition by l_partkey order by l_orderkey),
	sum(l_extendedprice) over(partition by l_partkey order by l_orderkey desc),
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	607274.00	29733.00	607274.00
1802.00	1	5121	607274.00	31535.00	577541.00
4505.00	1	6179	607274.00	36040.00	575739.00
29733.00	1	6273	607274.00	65773.00	571234.00
30634.00	1	8645	607274.00	96407.00	541501.00
41446.00	1	12005	607274.00	137853.00	510867.00
36040.00	1	16135	607274.00	173893.00	469421.00
29733.00	1	16198	607274.00	203626.00	433381.00
26129.00	1	20199	607274.00	229755.00	403648.00
24327.00	1	22117	607274.00	254082.00	377519.00
19822.00	1	24866	607274.00	273904.00	353192.00
24327.00	1	26756	607274.00	298231.00	333370.00
9010.00	1	27558	607274.00	307241.00	309043.00
45050.00	1	29859	607274.00	352291.00	300033.00
2703.00	1	34692	607274.00	354994.00	254983.00
11713.00	1	36611	607274.00	366707.00	252280.00
18020.00	1	38051	607274.00	384727.00	240567.00
21624.00	1	42465	607274.00	406351.00	222547.00
36040.00	1	42758	607274.00	442391.00	200923.00
39644.00	1	47620	607274.00	482035.00	164883.00
28832.00	1	50498	607274.00	510867.00	125239.00
12614.00	1	51970	607274.00	523481.00	96407.00
2703.00	1	53189	607274.00	526184.00	83793.00
22525.00	1	53825	607274.00	548709.00	81090.00
21624.00	1	54592	607274.00	570333.00	58565.00
36941.00	1	59202	607274.00	607274.00	36941.00
18942.00	2	548	707168.00	18942.00	707168.00
17138.00	2	807	707168.00	36080.00	688226.00
24354.00	2	2117	707168.00	60434.00	671088.00
9020.00	2	2528	707168.00	69454.00	646734.00
28864.00	2	4102	707168.00	98318.00	637714.00
42394.00	2	4452	707168.00	140712.00	608850.00
11726.00	2	7458	707168.00	152438.00	566456.00
39688.00	2	27969	707168.00	192126.00	554730.00
37884.00	2	28900	707168.00	230010.00	515042.00
9922.00	2	30278	707168.00	239932.00	477158.00
12628.00	2	30597	707168.00	252560.00	467236.00
7216.00	2	33058	707168.00	259776.00	454608.00
41492.00	2	37026	707168.00	301268.00	447392.00
40590.00	2	37123	707168.00	341858.00	405900.00
36982.00	2	39809	707168.00	378840.00	365310.00
36080.00	2	41415	707168.00	414920.00	328328.00
18942.00	2	42147	707168.00	433862.00	292248.00
24354.00	2	42533	707168.00	458216.00	273306.00
41492.00	2	43650	707168.00	499708.00	248952.00
45100.00	2	44103	707168.00	544808.00	207460.00
17138.00	2	46913	707168.00	561946.00	162360.00
31570.00	2	50499	707168.00	593516.00	145222.00
37884.00	2	54086	707168.00	631400.00	113652.00
26158.00	2	54436	707168.00	662068.00	75768.00
4510.00	2	54436	707168.00	662068.00	75768.00
3608.00	2	54630	707168.00	665676.00	45100.00
41492.00	2	55136	707168.00	707168.00	41492.00

#
# Mixing partitioned and unpartitioned
#
query IIIIIII
select 
	l_extendedprice, 
	l_partkey, 
	l_orderkey, 
	sum(l_extendedprice) over(),
	sum(l_extendedprice) over(order by l_partkey),
	sum(l_extendedprice) over(order by l_partkey, l_orderkey),
	sum(l_extendedprice) over(partition by l_partkey order by l_orderkey desc),
from lineitem 
order by l_partkey, l_orderkey, l_extendedprice desc
----
29733.00	1	2883	1314442.00	607274.00	29733.00	607274.00
1802.00	1	5121	1314442.00	607274.00	31535.00	577541.00
4505.00	1	6179	1314442.00	607274.00	36040.00	575739.00
29733.00	1	6273	1314442.00	607274.00	65773.00	571234.00
30634.00	1	8645	1314442.00	607274.00	96407.00	541501.00
41446.00	1	12005	1314442.00	607274.00	137853.00	510867.00
36040.00	1	16135	1314442.00	607274.00	173893.00	469421.00
29733.00	1	16198	1314442.00	607274.00	203626.00	433381.00
26129.00	1	20199	1314442.00	607274.00	229755.00	403648.00
24327.00	1	22117	1314442.00	607274.00	254082.00	377519.00
19822.00	1	24866	1314442.00	607274.00	273904.00	353192.00
24327.00	1	26756	1314442.00	607274.00	298231.00	333370.00
9010.00	1	27558	1314442.00	607274.00	307241.00	309043.00
45050.00	1	29859	1314442.00	607274.00	352291.00	300033.00
2703.00	1	34692	1314442.00	607274.00	354994.00	254983.00
11713.00	1	36611	1314442.00	607274.00	366707.00	252280.00
18020.00	1	38051	1314442.00	607274.00	384727.00	240567.00
21624.00	1	42465	1314442.00	607274.00	406351.00	222547.00
36040.00	1	42758	1314442.00	607274.00	442391.00	200923.00
39644.00	1	47620	1314442.00	607274.00	482035.00	164883.00
28832.00	1	50498	1314442.00	607274.00	510867.00	125239.00
12614.00	1	51970	1314442.00	607274.00	523481.00	96407.00
2703.00	1	53189	1314442.00	607274.00	526184.00	83793.00
22525.00	1	53825	1314442.00	607274.00	548709.00	81090.00
21624.00	1	54592	1314442.00	607274.00	570333.00	58565.00
36941.00	1	59202	1314442.00	607274.00	607274.00	36941.00
18942.00	2	548	1314442.00	1314442.00	626216.00	707168.00
17138.00	2	807	1314442.00	1314442.00	643354.00	688226.00
24354.00	2	2117	1314442.00	1314442.00	667708.00	671088.00
9020.00	2	2528	1314442.00	1314442.00	676728.00	646734.00
28864.00	2	4102	1314442.00	1314442.00	705592.00	637714.00
42394.00	2	4452	1314442.00	1314442.00	747986.00	608850.00
11726.00	2	7458	1314442.00	1314442.00	759712.00	566456.00
39688.00	2	27969	1314442.00	1314442.00	799400.00	554730.00
37884.00	2	28900	1314442.00	1314442.00	837284.00	515042.00
9922.00	2	30278	1314442.00	1314442.00	847206.00	477158.00
12628.00	2	30597	1314442.00	1314442.00	859834.00	467236.00
7216.00	2	33058	1314442.00	1314442.00	867050.00	454608.00
41492.00	2	37026	1314442.00	1314442.00	908542.00	447392.00
40590.00	2	37123	1314442.00	1314442.00	949132.00	405900.00
36982.00	2	39809	1314442.00	1314442.00	986114.00	365310.00
36080.00	2	41415	1314442.00	1314442.00	1022194.00	328328.00
18942.00	2	42147	1314442.00	1314442.00	1041136.00	292248.00
24354.00	2	42533	1314442.00	1314442.00	1065490.00	273306.00
41492.00	2	43650	1314442.00	1314442.00	1106982.00	248952.00
45100.00	2	44103	1314442.00	1314442.00	1152082.00	207460.00
17138.00	2	46913	1314442.00	1314442.00	1169220.00	162360.00
31570.00	2	50499	1314442.00	1314442.00	1200790.00	145222.00
37884.00	2	54086	1314442.00	1314442.00	1238674.00	113652.00
26158.00	2	54436	1314442.00	1314442.00	1269342.00	75768.00
4510.00	2	54436	1314442.00	1314442.00	1269342.00	75768.00
3608.00	2	54630	1314442.00	1314442.00	1272950.00	45100.00
41492.00	2	55136	1314442.00	1314442.00	1314442.00	41492.00
