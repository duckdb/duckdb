# name: test/sql/cast/union_cast.test
# description: Test union casts
# group: [cast]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE t1 (i UNION(a INT));

statement ok
INSERT INTO t1 VALUES (1),(2),(3);

# UNION -> UNION
query I
SELECT i::UNION(a UNION(a INT)) FROM t1;
----
1
2
3

# Make sure that the value ends up in the right union member
query I
SELECT (i::UNION(a INT, b UNION(a INT))).a FROM t1;
----
1
2
3