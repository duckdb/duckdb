# name: test/sql/table_function/duckdb_settings_in_bytes.test
# description: Test duckdb_settings(in_bytes=...) returns bytes for memory-like settings
# group: [table_function]

# Configuring a setting
statement ok
PRAGMA wal_autocheckpoint='1 KiB';

# Default behavior unchanged (VARCHAR)
query I
SELECT typeof(value) FROM duckdb_settings() WHERE name IN ('wal_autocheckpoint') LIMIT 1;
----
VARCHAR

# in_bytes=false should behave like default (VARCHAR)
query I
SELECT typeof(value) FROM duckdb_settings(in_bytes=false) WHERE name IN ('wal_autocheckpoint') LIMIT 1;
----
VARCHAR

# In bytes mode the value should be a number (UBIGINT) for memory-like settings
query I
SELECT typeof(value) FROM duckdb_settings(in_bytes=true) WHERE name IN ('wal_autocheckpoint') LIMIT 1;
----
UBIGINT

# The numeric value should match 1024 for the memory-like setting we just set
query I
SELECT value FROM duckdb_settings(in_bytes=true) WHERE name IN ('wal_autocheckpoint') LIMIT 1;
----
1024

# Non-byte settings should not be returned at all
statement ok
SET default_collation='nfc';

query I
SELECT value IS NULL FROM duckdb_settings(in_bytes=true) WHERE name='default_collation';
----

# Incorrect inputs should error
# - in_bytes must be boolean true/false
statement error
SELECT * FROM duckdb_settings(in_bytes=42);
----
Invalid Input Error: duckdb_settings: named parameter 'in_bytes' must be a non-NULL BOOLEAN (true/false)

# - unknown named parameter
statement error
SELECT * FROM duckdb_settings(hello=true);
----
Binder Error: Invalid named parameter "hello" for function duckdb_settings

# single value
statement error
SELECT * FROM duckdb_settings(true);
----

# 0/1/NULL should be rejected
statement error
SELECT * FROM duckdb_settings(in_bytes=0);
----
Invalid Input Error: duckdb_settings: named parameter 'in_bytes' must be a non-NULL BOOLEAN (true/false)

statement error
SELECT * FROM duckdb_settings(in_bytes=1);
----
Invalid Input Error: duckdb_settings: named parameter 'in_bytes' must be a non-NULL BOOLEAN (true/false)

statement error
SELECT * FROM duckdb_settings(in_bytes=NULL);
----
Invalid Input Error: duckdb_settings: named parameter 'in_bytes' must be a non-NULL BOOLEAN (true/false)
