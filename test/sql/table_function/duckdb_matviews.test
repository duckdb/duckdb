# name: test/sql/table_function/duckdb_matviews.test
# description: Test duckdb_matviews function
# group: [table_function]

query I
SELECT COUNT(*) FROM duckdb_matviews();
----
0

statement ok
CREATE TABLE t1(id INTEGER, j VARCHAR);

query I
INSERT INTO t1 VALUES (1, 'a'), (2, 'b'), (3, 'c');
----
3

statement ok
CREATE MATERIALIZED VIEW mv1 AS SELECT * FROM t1;

query I
SELECT COUNT(*) FROM mv1;
----
3

query I
SELECT COUNT(*) FROM duckdb_matviews();
----
1

query IIIII
SELECT schema_name, matview_name, internal, temporary, column_count FROM duckdb_matviews();
----
main	mv1	0	0	2