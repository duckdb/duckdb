# name: test/sql/aggregate/aggregates/arg_min_max_nulls_last.test
# description: Test arg_min_nulls_last and arg_max_nulls_last
# group: [aggregates]

statement ok
CREATE TABLE tbl AS SELECT * FROM VALUES (1, 5, 1), (1, NULL, 2), (1, 3, NULL), (2, NULL, NULL), (3, 1, NULL) t(grp, arg, val)

query I
SELECT arg_max_nulls_last(arg, val) FROM tbl
----
NULL

query I
SELECT arg_max_nulls_last(arg, val, 1) FROM tbl
----
[NULL]

query I
SELECT arg_max_nulls_last(val, val, 4) FROM tbl
----
[2, 1, NULL, NULL]

query II
SELECT grp, arg_max_nulls_last(arg, val) FROM tbl GROUP BY grp ORDER BY grp
----
1	NULL
2	NULL
3	1

query II
SELECT grp, arg_max_nulls_last(arg, val, 2) FROM tbl GROUP BY grp ORDER BY grp
----
1	[NULL, 5]
2	[NULL]
3	[1]

query I
SELECT arg_min_nulls_last(arg, val) FROM tbl
----
5

query I
SELECT arg_min_nulls_last(arg, val, 1) FROM tbl
----
[5]

query I
SELECT arg_min_nulls_last(val, val, 4) FROM tbl
----
[1, 2, NULL, NULL]

query II
SELECT grp, arg_min_nulls_last(arg, val) FROM tbl GROUP BY grp ORDER BY grp
----
1	5
2	NULL
3	1

query II
SELECT grp, arg_min_nulls_last(arg, val, 2) FROM tbl GROUP BY grp ORDER BY grp
----
1	[5, NULL]
2	[NULL]
3	[1]
