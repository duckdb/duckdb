# name: test/sql/catalog/function/python_style_macro_parameters.test
# description: Test Python-style macro parameters
# group: [function]

statement ok
create or replace macro m(a := 'a', b := 'b') as a || b

query I
select m()
----
ab

# we can supply arguments in any order as long as they are named
query I
select m(b := 'a', a := 'b')
----
ba

query I
select m(a := 'b', b := 'a')
----
ba

query I
select m('c')
----
cb

query I
select m('c', 'd')
----
cd

query I
select m('c', b := 'd')
----
cd

# 'a' is already supplied as positional, so cannot be used as named
statement error
select m('c', a:= 'd')
----
does not support the supplied arguments

statement error
select m('c', 'd', b := 'e')
----
does not support the supplied arguments

# now without default arguments
statement ok
create or replace macro m(a, b) as a || b

statement error
select m()
----
does not support the supplied arguments

query I
select m(b := 'a', a := 'b')
----
ba

query I
select m(a := 'b', b := 'a')
----
ba

statement error
select m('c')
----
does not support the supplied arguments

query I
select m('c', 'd')
----
cd

query I
select m('c', b := 'd')
----
cd

# replicate tests above but with a table macro
statement ok
create or replace macro m(a := 'a', b := 'b') as table (select a || b)

query I
select * from m()
----
ab

query I
select * from m(b := 'a', a := 'b')
----
ba

query I
select * from m(a := 'b', b := 'a')
----
ba

query I
select * from m('c')
----
cb

query I
select * from m('c', 'd')
----
cd

query I
select * from m('c', b := 'd')
----
cd

statement error
select * from m('c', a:= 'd')
----
does not support the supplied arguments

statement error
select * from m('c', 'd', b := 'e')
----
does not support the supplied arguments

statement ok
create or replace macro m(a, b) as table (select a || b)

statement error
select * from m()
----
does not support the supplied arguments

query I
select * from m(b := 'a', a := 'b')
----
ba

query I
select * from m(a := 'b', b := 'a')
----
ba

statement error
select * from m('c')
----
does not support the supplied arguments

query I
select * from m('c', 'd')
----
cd

query I
select * from m('c', b := 'd')
----
cd
