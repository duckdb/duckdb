# name: test/sql/settings/secret_validation.test
# description: Test that SET secret_validation works
# group: [settings]

require no_extension_autoloading "EXPECTED: Tests failures on loading extensions

# check default=exists
query I
SELECT value FROM duckdb_settings() WHERE name='secret_validation';
----
exists

# set to none
statement ok
SET secret_validation = 'none';

statement ok
SELECT value FROM duckdb_settings() WHERE name='secret_validation' AND value='none';

# reset to exists
statement ok
RESET secret_validation;

statement ok
SELECT value FROM duckdb_settings() WHERE name='secret_validation' AND value='exists';

# disallowed value
statement error
SET secret_validation = 'junk';
----
Invalid Input Error
