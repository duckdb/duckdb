# name: test/sql/pragma/test_pragma_version.test
# description: Test version pragma
# group: [pragma]

tags release

statement ok
PRAGMA version;

statement ok
select * from pragma_version();

statement ok
select library_version from pragma_version();

statement ok
PRAGMA platform;

statement ok
select * from pragma_platform();

statement ok
select platform from pragma_platform();

query I
SELECT count(*) FROM pragma_version() WHERE library_version LIKE 'v%';
----
1

statement ok
pragma extension_versions;

statement ok
SET VARIABLE v = (select library_version  from pragma_version());

statement ok
SET VARIABLE v_or_latest = (select CASE WHEN getvariable('v') ILIKE 'v%-dev%' THEN 'latest' WHEN getvariable('v') ILIKE 'v0.0.1' THEN 'latest' ELSE getvariable('v') END);

statement ok
SET VARIABLE codename = (select CASE WHEN getvariable('v') ILIKE 'v%-dev%' THEN 'Development Version' WHEN getvariable('v') ILIKE 'v0.0.1' THEN 'Unknown Version' ELSE '%' END);

query I
select count(*) FROM (select codename from pragma_version() WHERE codename LIKE getvariable('codename'));
----
1

