# name: test/sql/error/incorrect_sql.test
# description: Test various incorrect SQL strings
# group: [error]

# typo
statement error
SELEC 42;
----
Parser Error: syntax error at or near "SELEC"

statement error
SELEC 42, 'thisisareallylongstringloremipsumblablathisisareallylongstringloremipsumblablalthisisareallylongstringloremipsumblablalthisisareallylongstringloremipsumblablal';
----
Parser Error: syntax error at or near "SELEC"

statement error
SELEC 42, 'ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†';
----
Parser Error: syntax error at or near "SELEC"

# unrecognized column
statement error
SELECT 'ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†', x, 'ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†';
----
Binder Error: Referenced column "x" not found in FROM clause!

# unrecognized scalar function
statement error
SELECT FUNFUNFUN();
----
Catalog Error: Scalar Function with name funfunfun does not exist!

statement error
CREATE VIEW v1
AS SELECT FUNFUNFUN();
----
Catalog Error: Scalar Function with name funfunfun does not exist!

# unrecognized aggregate parameters
statement error
SELECT SUM(42, 84, 11, 'hello')
----
Binder Error: No function matches the given name and argument types 'sum(INTEGER, INTEGER, INTEGER, VARCHAR)'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

# no matching function
statement error
SELECT cos(0, 1, 2, 3);
----
Binder Error: No function matches the given name and argument types 'cos(INTEGER, INTEGER, INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	cos(DOUBLE) -> DOUBLE

# unrecognized table function
statement error
SELECT * FROM RANG();
----
Catalog Error: Table Function with name rang does not exist!

# unknown named parameters
statement error
SELECT * FROM RANGE(1, hello=3);
----
Binder Error: Invalid named parameter "hello" for function range
Function does not accept any named parameters.

statement error
SELECT * FROM READ_CSV('x', hello=3);
----
Binder Error: Invalid named parameter "hello" for function read_csv

# multiple where clauses
statement error
SELECT 42 WHERE 1=1 WHERE 1=0;
----
Parser Error: syntax error at or near "WHERE"

# multiple statements without semi colon
statement error
SELECT 42
SELECT 42;
----
Parser Error: syntax error at or near "SELECT"

# multiple statements, but error is only in second statement
statement error
SELECT 42; SELEC 42;
----
Parser Error: syntax error at or near "SELEC"

# non-existent table
statement error
SELECT * FROM integers2;
----
Catalog Error: Table with name integers2 does not exist!

# non-existent schema
statement error
SELECT * FROM bla.integers2;
----
Catalog Error: Table with name integers2 does not exist!

# non-existent table in view
statement error
CREATE VIEW v1 AS SELECT * FROM integers2;
----
Catalog Error: Table with name integers2 does not exist!

# non-existent table in long single
statement error
with cte1 as (select 42 as j), cte2 as (select ref.j as k from cte1 as ref), cte3 as (select ref2.j+1 as i from cte1 as ref2) SELECT * FROM integers9;
----
Catalog Error: Table with name integers9 does not exist!

statement error
with cte1 as (select 42 as j), cte2 as (select ref.j as k from cte1 as ref), cte3 as (select ref2.j+1 as i from cte1 as ref2) SELECT * FROM integers9 where x=3 order by x+1+1+1+1+1+1+1+1+1+1+1;
----
Catalog Error: Table with name integers9 does not exist!

# non-existent table in multi
statement error
SELECT
    l_returnflag,
    l_linestatus,
    sum(l_quantity) AS sum_qty,
    sum(l_extendedprice) AS sum_base_price,
    sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price,
    sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge,
    avg(l_quantity) AS avg_qty,
    avg(l_extendedprice) AS avg_price,
    avg(l_discount) AS avg_disc,
    count(*) AS count_order
FROM
    lineitem
WHERE
    l_shipdate <= CAST('1998-09-02' AS date)
GROUP BY
    l_returnflag,
    l_linestatus
ORDER BY
    l_returnflag,
    l_linestatus;
----
Catalog Error: Table with name lineitem does not exist!

# now with unicode
# short unicode error
statement error
select ðŸ¦†ðŸž from ðŸ¦†ðŸž;
----
Catalog Error: Table with name ðŸ¦†ðŸž does not exist!

# long unicode error
statement error
with ðŸžðŸž as (select 'bread' as ðŸž), ðŸ¦†ðŸ¦† as (select ref.ðŸž as "ðŸž" from ðŸžðŸž as ref) SELECT * FROM integers9 where x LIKE 'ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†ðŸ¦†' order by x+1+1+1+1+1+1+1+1+1+1+1;
----
Catalog Error: Table with name integers9 does not exist!

statement ok
CREATE TABLE integers(integ INTEGER);

statement ok
CREATE TABLE strings(str VARCHAR);

statement ok
CREATE TABLE chickens(feather INTEGER, beak INTEGER);

# non-existent table, with several tables available
statement error
SELECT * FROM integres;
----
Catalog Error: Table with name integres does not exist!

# non-existent column
statement error
SELECT feathe FROM chickens;
----
Binder Error: Referenced column "feathe" not found in FROM clause!

# non-existent column, with multiple tables
statement error
SELECT feathe FROM chickens, integers, strings;
----
Binder Error: Referenced column "feathe" not found in FROM clause!

statement error
SELECT st FROM chickens, integers, strings;
----
Binder Error: Referenced column "st" not found in FROM clause!

statement error
SELECT chicken.feather FROM chickens
----
Binder Error: Referenced table "chicken" not found!
Candidate tables: "chickens"

# table-qualified non-existent column
statement error
SELECT chicken.st FROM chickens, integers, strings;
----
Binder Error: Referenced table "chicken" not found!
Candidate tables: "chickens"

# now with unicode
statement ok
CREATE TABLE ðŸ¦†ðŸž(ðŸ¦†ðŸ¦†ðŸ¦† INTEGER, ðŸžðŸžðŸž INTEGER);

statement error
SELECT ðŸ¦†.ðŸ¦†ðŸ¦†ðŸ¦† FROM ðŸ¦†ðŸž
----
Binder Error: Referenced table "ðŸ¦†" not found!
Candidate tables: "ðŸ¦†ðŸž"

statement error
SELECT ðŸ¦†ðŸ¦† FROM ðŸ¦†ðŸž, chickens
----
Binder Error: Referenced column "ðŸ¦†ðŸ¦†" not found in FROM clause!
