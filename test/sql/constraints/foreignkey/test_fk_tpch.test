# name: test/sql/constraints/foreignkey/test_fk_tpch.test
# description: enable foreign keys in the TPC-H schema
# group: [foreignkey]

require tpch

statement ok
CALL dbgen(sf=0.01);

statement ok
CREATE TABLE pkt AS (SELECT l_orderkey, l_partkey, l_suppkey, l_linenumber, l_quantity FROM lineitem LIMIT 10);

statement ok
CREATE TABLE fkt(id INTEGER, FOREIGN KEY (id) REFERENCES pkt(l_partkey))

query IIIII
SELECT * FROM pkt
----
1	1552	93	1	17	
1	674	75	2	36	
1	637	38	3	8	
1	22	48	4	28	
1	241	23	5	24	
1	157	10	6	32	
2	1062	33	1	38	
3	43	19	1	45	
3	191	70	2	49	
3	1285	60	3	27	

statement error
DROP TABLE pkt;

statement ok
DROP TABLE fkt;

statement ok
DROP TABLE pkt;
