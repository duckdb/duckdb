# name: test/sql/parser/let_expr.test
# group: [parser]

# Simple reuse
query I
select let x := 2 in x * x as square_of_x
----
4

# Multiple let bindings
query I
select let a := 3, b := 4 in a + b as sum_ab
----
7

# Nested let expressions
query I
select let x := 2 in let y := x + 3 in y + 5 as result
----
10

query I
select let x := 2 in let y := 3 in y + x + 5 as result
----
10

# Let with row constructor
query II
SELECT unnest(let x := 2, y := 3 in row(x,y));
----
2	3

# Let with different types
query I
SELECT let name := 'Alice, ', age := 30 in name || age;
----
Alice, 30

# Let with lambda
query I
SELECT LET x := 1 in list_transform([1,2,3], LAMBDA y: y + x);
----
[2, 3, 4]

# Naming is correct
query I
select let x := 1 in alias(x);
----
x

# Let in non-SELECT context
query I rowsort
SELECT * FROM range(0, 10) as r(i) WHERE LET x := i % 2 == 0 IN x ORDER BY ALL;
----
0
2
4
6
8
