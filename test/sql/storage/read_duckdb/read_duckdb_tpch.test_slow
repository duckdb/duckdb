# name: test/sql/storage/read_duckdb/read_duckdb_tpch.test_slow
# group: [read_duckdb]

require tpch

statement ok
CALL dbgen(sf=1, suffix='_original');

foreach tbl lineitem nation orders supplier part partsupp region customer

statement ok
ATTACH '__TEST_DIR__/${tbl}_sf1.db' AS ${tbl}

statement ok
CREATE TABLE ${tbl}.${tbl} AS FROM ${tbl}_original

statement ok
DETACH ${tbl}

statement ok
CREATE VIEW ${tbl} AS FROM read_duckdb('__TEST_DIR__/${tbl}_sf1.db')

endloop

loop i 1 9

query I
PRAGMA tpch(${i})
----
<FILE>:extension/tpch/dbgen/answers/sf1/q0${i}.csv

endloop

loop i 10 23

query I
PRAGMA tpch(${i})
----
<FILE>:extension/tpch/dbgen/answers/sf1/q${i}.csv

endloop

