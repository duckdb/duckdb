# name: test/sql/storage/wal/wal_promote_version.test
# description: WAL promote version
# group: [wal]

statement ok
PRAGMA disable_checkpoint_on_shutdown;

statement ok
SET checkpoint_threshold='1TB'

statement ok
ATTACH '{LOCAL_TEMP_DIR}/wal_promote.db';

statement ok
CREATE TABLE wal_promote.T AS (FROM range(10));

statement ok
DETACH wal_promote;

statement ok
ATTACH '{LOCAL_TEMP_DIR}/wal_promote.db' (STORAGE_VERSION 'latest');

statement ok
INSERT INTO wal_promote.T VALUES (42);

statement ok
DETACH wal_promote;

statement ok
ATTACH '{LOCAL_TEMP_DIR}/wal_promote.db' (STORAGE_VERSION 'latest');

statement ok
INSERT INTO wal_promote.T VALUES (42);

statement ok
DETACH wal_promote;
