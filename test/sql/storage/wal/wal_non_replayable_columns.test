statement ok
PRAGMA disable_checkpoint_on_shutdown;

statement ok
SET wal_autocheckpoint='1TB'

statement ok
ATTACH '__TEST_DIR__/foo.db';

statement ok
CREATE TABLE foo.t AS SELECT range::INT AS id FROM range(2);

statement ok
ALTER TABLE foo.t ADD COLUMN d TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP;

statement ok
CREATE TABLE original AS SELECT d FROM foo.t LIMIT 1;

statement ok
DETACH foo;

statement ok
ATTACH '__TEST_DIR__/foo.db';

query I
SELECT COUNT(*) != 0 FROM foo.t JOIN original ON foo.t.d = original.d;
----
True