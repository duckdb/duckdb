# name: test/sql/storage/compression/rle/rle_filter.test
# description: Test filtering from RLE compression
# group: [rle]

# load the DB from disk
load __TEST_DIR__/test_rle_filter.db

statement ok
pragma enable_verification

statement ok
PRAGMA force_compression = 'rle'

statement ok
CREATE TABLE tbl AS SELECT i id, i // 50 rle_val, case when i%8=0 then null else i // 50 end rle_val_null FROM range(100000) t(i);

query III
SELECT * FROM tbl WHERE id = 5040 AND rle_val=100
----
5040	100	NULL

query III
SELECT * FROM tbl WHERE id >= 5020 AND rle_val=100
----
5020	100	100
5021	100	100
5022	100	100
5023	100	100
5024	100	NULL
5025	100	100
5026	100	100
5027	100	100
5028	100	100
5029	100	100
5030	100	100
5031	100	100
5032	100	NULL
5033	100	100
5034	100	100
5035	100	100
5036	100	100
5037	100	100
5038	100	100
5039	100	100
5040	100	NULL
5041	100	100
5042	100	100
5043	100	100
5044	100	100
5045	100	100
5046	100	100
5047	100	100
5048	100	NULL
5049	100	100

query III
SELECT * FROM tbl WHERE rle_val=100
----
5000	100	NULL
5001	100	100
5002	100	100
5003	100	100
5004	100	100
5005	100	100
5006	100	100
5007	100	100
5008	100	NULL
5009	100	100
5010	100	100
5011	100	100
5012	100	100
5013	100	100
5014	100	100
5015	100	100
5016	100	NULL
5017	100	100
5018	100	100
5019	100	100
5020	100	100
5021	100	100
5022	100	100
5023	100	100
5024	100	NULL
5025	100	100
5026	100	100
5027	100	100
5028	100	100
5029	100	100
5030	100	100
5031	100	100
5032	100	NULL
5033	100	100
5034	100	100
5035	100	100
5036	100	100
5037	100	100
5038	100	100
5039	100	100
5040	100	NULL
5041	100	100
5042	100	100
5043	100	100
5044	100	100
5045	100	100
5046	100	100
5047	100	100
5048	100	NULL
5049	100	100
