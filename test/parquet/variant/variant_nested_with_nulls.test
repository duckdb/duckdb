# name: test/parquet/variant/variant_nested_with_nulls.test
# group: [variant]

require parquet

query IIIIII
describe from parquet_scan('data/parquet-testing/variant_unshredded_nested_nulls.parquet')
----
id	BIGINT	YES	NULL	NULL	NULL
v	VARIANT	YES	NULL	NULL	NULL
array_of_variants	VARIANT[]	YES	NULL	NULL	NULL
struct_of_variants	STRUCT(v VARIANT)	YES	NULL	NULL	NULL
map_of_variants	MAP(VARCHAR, VARIANT)	YES	NULL	NULL	NULL
array_of_struct_of_variants	STRUCT(v VARIANT)[]	YES	NULL	NULL	NULL
struct_of_array_of_variants	STRUCT(v VARIANT[])	YES	NULL	NULL	NULL

query I
select struct_of_variants from parquet_scan('data/parquet-testing/variant_unshredded_nested_nulls.parquet') order by id limit 10;
----
{'v': {'key': 0}}
{'v': {'key': 0}}
{'v': {'key': 1}}
{'v': {'key': 1}}
{'v': {'key': 2}}
{'v': {'key': 3}}
{'v': {'key': 4}}
{'v': {'key': 5}}
{'v': {'key': 6}}
{'v': {'key': 7}}

query IIIIIII
select * from parquet_scan('data/parquet-testing/variant_unshredded_nested_nulls.parquet') order by id limit 10;
----
0	{'key': 0}	[{'key': 0}, NULL, {'key': 0}, NULL, {'key': 0}]	{'v': {'key': 0}}	{0={'key': 0}, nullKey=NULL}	[{'v': {'key': 0}}, {'v': NULL}, NULL, {'v': {'key': 0}}, NULL, {'v': {'key': 0}}]	{'v': [NULL, {'key': 0}]}
0	{'key': 0}	[{'key': 0}, NULL, {'key': 0}, NULL, {'key': 0}]	{'v': {'key': 0}}	{0={'key': 0}, nullKey=NULL}	[{'v': {'key': 0}}, {'v': NULL}, NULL, {'v': {'key': 0}}, NULL, {'v': {'key': 0}}]	{'v': [NULL, {'key': 0}]}
1	{'key': 1}	[{'key': 1}, NULL, {'key': 1}, NULL, {'key': 1}]	{'v': {'key': 1}}	{1={'key': 1}, nullKey=NULL}	[{'v': {'key': 1}}, {'v': NULL}, NULL, {'v': {'key': 1}}, NULL, {'v': {'key': 1}}]	{'v': [NULL, {'key': 1}]}
1	{'key': 1}	[{'key': 1}, NULL, {'key': 1}, NULL, {'key': 1}]	{'v': {'key': 1}}	{1={'key': 1}, nullKey=NULL}	[{'v': {'key': 1}}, {'v': NULL}, NULL, {'v': {'key': 1}}, NULL, {'v': {'key': 1}}]	{'v': [NULL, {'key': 1}]}
2	{'key': 2}	[{'key': 2}, NULL, {'key': 2}, NULL, {'key': 2}]	{'v': {'key': 2}}	{2={'key': 2}, nullKey=NULL}	[{'v': {'key': 2}}, {'v': NULL}, NULL, {'v': {'key': 2}}, NULL, {'v': {'key': 2}}]	{'v': [NULL, {'key': 2}]}
3	{'key': 3}	[{'key': 3}, NULL, {'key': 3}, NULL, {'key': 3}]	{'v': {'key': 3}}	{3={'key': 3}, nullKey=NULL}	[{'v': {'key': 3}}, {'v': NULL}, NULL, {'v': {'key': 3}}, NULL, {'v': {'key': 3}}]	{'v': [NULL, {'key': 3}]}
4	{'key': 4}	[{'key': 4}, NULL, {'key': 4}, NULL, {'key': 4}]	{'v': {'key': 4}}	{4={'key': 4}, nullKey=NULL}	[{'v': {'key': 4}}, {'v': NULL}, NULL, {'v': {'key': 4}}, NULL, {'v': {'key': 4}}]	{'v': [NULL, {'key': 4}]}
5	{'key': 5}	[{'key': 5}, NULL, {'key': 5}, NULL, {'key': 5}]	{'v': {'key': 5}}	{5={'key': 5}, nullKey=NULL}	[{'v': {'key': 5}}, {'v': NULL}, NULL, {'v': {'key': 5}}, NULL, {'v': {'key': 5}}]	{'v': [NULL, {'key': 5}]}
6	{'key': 6}	[{'key': 6}, NULL, {'key': 6}, NULL, {'key': 6}]	{'v': {'key': 6}}	{6={'key': 6}, nullKey=NULL}	[{'v': {'key': 6}}, {'v': NULL}, NULL, {'v': {'key': 6}}, NULL, {'v': {'key': 6}}]	{'v': [NULL, {'key': 6}]}
7	{'key': 7}	[{'key': 7}, NULL, {'key': 7}, NULL, {'key': 7}]	{'v': {'key': 7}}	{7={'key': 7}, nullKey=NULL}	[{'v': {'key': 7}}, {'v': NULL}, NULL, {'v': {'key': 7}}, NULL, {'v': {'key': 7}}]	{'v': [NULL, {'key': 7}]}
