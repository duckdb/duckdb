# name: test/parquet/variant/variant_comparison.test
# group: [variant]

require parquet

statement ok
create table tbl(col VARIANT);

statement ok
insert into tbl select * from (VALUES
	('test'::VARIANT),
	('99'::VARIANT),
	('1'::VARIANT),
	('101'::VARIANT),
	(-123::VARIANT),
	((-100.5::decimal(5,1))::VARIANT),
	((100.5::decimal(5,1))::VARIANT)
) t(col)

statement error
select col from tbl where col > 100
----
Invalid Input Error: Can't compare values of type VARCHAR (test) and type INTEGER (100) - an explicit cast is required

query I
select col from tbl where variant_typeof(col) != 'VARCHAR' and col > 0
----
100.5

query I
select col from tbl where variant_typeof(col) != 'VARCHAR' and col == -123
----
-123
