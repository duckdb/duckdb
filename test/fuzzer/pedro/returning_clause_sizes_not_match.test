# name: test/fuzzer/pedro/returning_clause_sizes_not_match.test
# group: [pedro]

statement ok
PRAGMA enable_verification;

statement ok
CREATE TABLE test (x INT, INT AS(x + 100));

query II
INSERT INTO test VALUES (1), (2) RETURNING *;
----
1	101
2	102

query IIII
INSERT INTO test VALUES (1), (2) RETURNING *, *;
----
1	101	1	101
2	102	2	102

query II
DELETE FROM test WHERE x=2 RETURNING *;
----
2	102
2	102

query II
UPDATE test SET x=0 WHERE x = 1 RETURNING *;
----
0	100
0	100

# Error: Binder Error: Referenced table "y" not found!
statement error
INSERT INTO test VALUES(1) RETURNING y.int;

# Error: Binder Error: Referenced table "y" not found!
statement error
INSERT INTO test VALUES(1) RETURNING y.*;

query I
INSERT INTO test VALUES(1) RETURNING test;
----
{'x': 1, 'int': 101}

query I
INSERT INTO test VALUES(1) RETURNING test.int;
----
101

query I
INSERT INTO test VALUES(1) RETURNING {'i' : x, 'j' : int};
----
{'i': 1, 'j': 101}