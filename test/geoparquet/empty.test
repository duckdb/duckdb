# name: test/geoparquet/empty.test
# group: [geoparquet]

require spatial

require parquet

statement ok
COPY (select 'POINT EMPTY'::GEOMETRY as geom) TO '__TEST_DIR__/test.parquet' (format parquet);

# Dont write bbox metadata for empty geometries
query I
select geo_bbox from parquet_metadata('__TEST_DIR__/test.parquet');
----
NULL

query I
select geo_types from parquet_metadata('__TEST_DIR__/test.parquet');
----
NULL

query I
SELECT (decode(value)) as col FROM parquet_kv_metadata('__TEST_DIR__/test.parquet');
----
{"version":"1.0.0","primary_column":"geom","columns":{"geom":{"encoding":"WKB","geometry_types":["Point"]}}}

statement ok
COPY (select 'POINT EMPTY'::GEOMETRY as geom) TO '__TEST_DIR__/test1.parquet' (format parquet, geoparquet_version 'BOTH');

query I
select geo_bbox from parquet_metadata('__TEST_DIR__/test1.parquet');
----
NULL

query I
select geo_types from parquet_metadata('__TEST_DIR__/test1.parquet');
----
[point]

query I
SELECT (decode(value)) as col FROM parquet_kv_metadata('__TEST_DIR__/test1.parquet');
----
{"version":"1.0.0","primary_column":"geom","columns":{"geom":{"encoding":"WKB","geometry_types":["Point"]}}}

