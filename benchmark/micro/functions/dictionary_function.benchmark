# name: benchmark/micro/functions/dictionary_function.benchmark
# description: Function Over Dictionary Vectors
# group: [functions]

name Function Over Dictionary Vectors
group functions
storage persistent

load
CREATE TABLE t AS SELECT CONCAT('thisisastringwithrepetitions', i%100) AS grp, i FROM range(100_000_000) tbl(i);

run
SELECT grp, sum(i) FROM (SELECT regexp_extract(grp, '[0-9]+') AS grp, i FROM t) GROUP BY grp ORDER BY ALL;

result II
0	49999950000000
1	49999951000000
10	49999960000000
11	49999961000000
12	49999962000000
13	49999963000000
14	49999964000000
15	49999965000000
16	49999966000000
17	49999967000000
18	49999968000000
19	49999969000000
2	49999952000000
20	49999970000000
21	49999971000000
22	49999972000000
23	49999973000000
24	49999974000000
25	49999975000000
26	49999976000000
27	49999977000000
28	49999978000000
29	49999979000000
3	49999953000000
30	49999980000000
31	49999981000000
32	49999982000000
33	49999983000000
34	49999984000000
35	49999985000000
36	49999986000000
37	49999987000000
38	49999988000000
39	49999989000000
4	49999954000000
40	49999990000000
41	49999991000000
42	49999992000000
43	49999993000000
44	49999994000000
45	49999995000000
46	49999996000000
47	49999997000000
48	49999998000000
49	49999999000000
5	49999955000000
50	50000000000000
51	50000001000000
52	50000002000000
53	50000003000000
54	50000004000000
55	50000005000000
56	50000006000000
57	50000007000000
58	50000008000000
59	50000009000000
6	49999956000000
60	50000010000000
61	50000011000000
62	50000012000000
63	50000013000000
64	50000014000000
65	50000015000000
66	50000016000000
67	50000017000000
68	50000018000000
69	50000019000000
7	49999957000000
70	50000020000000
71	50000021000000
72	50000022000000
73	50000023000000
74	50000024000000
75	50000025000000
76	50000026000000
77	50000027000000
78	50000028000000
79	50000029000000
8	49999958000000
80	50000030000000
81	50000031000000
82	50000032000000
83	50000033000000
84	50000034000000
85	50000035000000
86	50000036000000
87	50000037000000
88	50000038000000
89	50000039000000
9	49999959000000
90	50000040000000
91	50000041000000
92	50000042000000
93	50000043000000
94	50000044000000
95	50000045000000
96	50000046000000
97	50000047000000
98	50000048000000
99	50000049000000
