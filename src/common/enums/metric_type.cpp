// This file is automatically generated by scripts/generate_metric_enums.py
// Do not edit this file manually, your changes will be overwritten

#include "duckdb/common/enums/metric_type.hpp"
#include "duckdb/common/enum_util.hpp"

namespace duckdb {

profiler_settings_t MetricsUtils::GetAllMetrics() {
	return {
		MetricsType::ALL_OPTIMIZERS,
		MetricsType::ATTACH_LOAD_STORAGE_LATENCY,
		MetricsType::ATTACH_REPLAY_WAL_LATENCY,
		MetricsType::BLOCKED_THREAD_TIME,
		MetricsType::CHECKPOINT_LATENCY,
		MetricsType::CPU_TIME,
		MetricsType::CUMULATIVE_CARDINALITY,
		MetricsType::CUMULATIVE_OPTIMIZER_TIMING,
		MetricsType::CUMULATIVE_ROWS_SCANNED,
		MetricsType::EXTRA_INFO,
		MetricsType::LATENCY,
		MetricsType::OPERATOR_CARDINALITY,
		MetricsType::OPERATOR_NAME,
		MetricsType::OPERATOR_ROWS_SCANNED,
		MetricsType::OPERATOR_TIMING,
		MetricsType::OPERATOR_TYPE,
		MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE,
		MetricsType::OPTIMIZER_COLUMN_LIFETIME,
		MetricsType::OPTIMIZER_COMMON_AGGREGATE,
		MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS,
		MetricsType::OPTIMIZER_COMMON_SUBPLAN,
		MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION,
		MetricsType::OPTIMIZER_CTE_FILTER_PUSHER,
		MetricsType::OPTIMIZER_CTE_INLINING,
		MetricsType::OPTIMIZER_DELIMINATOR,
		MetricsType::OPTIMIZER_DUPLICATE_GROUPS,
		MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP,
		MetricsType::OPTIMIZER_EXPRESSION_REWRITER,
		MetricsType::OPTIMIZER_EXTENSION,
		MetricsType::OPTIMIZER_FILTER_PULLUP,
		MetricsType::OPTIMIZER_FILTER_PUSHDOWN,
		MetricsType::OPTIMIZER_IN_CLAUSE,
		MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN,
		MetricsType::OPTIMIZER_JOIN_ORDER,
		MetricsType::OPTIMIZER_LATE_MATERIALIZATION,
		MetricsType::OPTIMIZER_LIMIT_PUSHDOWN,
		MetricsType::OPTIMIZER_MATERIALIZED_CTE,
		MetricsType::OPTIMIZER_REGEX_RANGE,
		MetricsType::OPTIMIZER_REORDER_FILTER,
		MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN,
		MetricsType::OPTIMIZER_STATISTICS_PROPAGATION,
		MetricsType::OPTIMIZER_SUM_REWRITER,
		MetricsType::OPTIMIZER_TOP_N,
		MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION,
		MetricsType::OPTIMIZER_UNNEST_REWRITER,
		MetricsType::OPTIMIZER_UNUSED_COLUMNS,
		MetricsType::PHYSICAL_PLANNER,
		MetricsType::PHYSICAL_PLANNER_COLUMN_BINDING,
		MetricsType::PHYSICAL_PLANNER_CREATE_PLAN,
		MetricsType::PHYSICAL_PLANNER_RESOLVE_TYPES,
		MetricsType::PLANNER,
		MetricsType::PLANNER_BINDING,
		MetricsType::QUERY_NAME,
		MetricsType::RESULT_SET_SIZE,
		MetricsType::ROWS_RETURNED,
		MetricsType::SYSTEM_PEAK_BUFFER_MEMORY,
		MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE,
		MetricsType::TOTAL_BYTES_READ,
		MetricsType::TOTAL_BYTES_WRITTEN,
		MetricsType::WAITING_TO_ATTACH_LATENCY,
	};
}

profiler_settings_t MetricsUtils::GetMetricsByGroupType(MetricGroup type) {
	switch(type) {
	case MetricGroup::ALL:
		return {
			MetricsType::ALL_OPTIMIZERS,
			MetricsType::ATTACH_LOAD_STORAGE_LATENCY,
			MetricsType::ATTACH_REPLAY_WAL_LATENCY,
			MetricsType::BLOCKED_THREAD_TIME,
			MetricsType::CHECKPOINT_LATENCY,
			MetricsType::CPU_TIME,
			MetricsType::CUMULATIVE_CARDINALITY,
			MetricsType::CUMULATIVE_OPTIMIZER_TIMING,
			MetricsType::CUMULATIVE_ROWS_SCANNED,
			MetricsType::EXTRA_INFO,
			MetricsType::LATENCY,
			MetricsType::OPERATOR_CARDINALITY,
			MetricsType::OPERATOR_NAME,
			MetricsType::OPERATOR_ROWS_SCANNED,
			MetricsType::OPERATOR_TIMING,
			MetricsType::OPERATOR_TYPE,
			MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE,
			MetricsType::OPTIMIZER_COLUMN_LIFETIME,
			MetricsType::OPTIMIZER_COMMON_AGGREGATE,
			MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS,
			MetricsType::OPTIMIZER_COMMON_SUBPLAN,
			MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION,
			MetricsType::OPTIMIZER_CTE_FILTER_PUSHER,
			MetricsType::OPTIMIZER_CTE_INLINING,
			MetricsType::OPTIMIZER_DELIMINATOR,
			MetricsType::OPTIMIZER_DUPLICATE_GROUPS,
			MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP,
			MetricsType::OPTIMIZER_EXPRESSION_REWRITER,
			MetricsType::OPTIMIZER_EXTENSION,
			MetricsType::OPTIMIZER_FILTER_PULLUP,
			MetricsType::OPTIMIZER_FILTER_PUSHDOWN,
			MetricsType::OPTIMIZER_IN_CLAUSE,
			MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN,
			MetricsType::OPTIMIZER_JOIN_ORDER,
			MetricsType::OPTIMIZER_LATE_MATERIALIZATION,
			MetricsType::OPTIMIZER_LIMIT_PUSHDOWN,
			MetricsType::OPTIMIZER_MATERIALIZED_CTE,
			MetricsType::OPTIMIZER_REGEX_RANGE,
			MetricsType::OPTIMIZER_REORDER_FILTER,
			MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN,
			MetricsType::OPTIMIZER_STATISTICS_PROPAGATION,
			MetricsType::OPTIMIZER_SUM_REWRITER,
			MetricsType::OPTIMIZER_TOP_N,
			MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION,
			MetricsType::OPTIMIZER_UNNEST_REWRITER,
			MetricsType::OPTIMIZER_UNUSED_COLUMNS,
			MetricsType::PHYSICAL_PLANNER,
			MetricsType::PHYSICAL_PLANNER_COLUMN_BINDING,
			MetricsType::PHYSICAL_PLANNER_CREATE_PLAN,
			MetricsType::PHYSICAL_PLANNER_RESOLVE_TYPES,
			MetricsType::PLANNER,
			MetricsType::PLANNER_BINDING,
			MetricsType::QUERY_NAME,
			MetricsType::RESULT_SET_SIZE,
			MetricsType::ROWS_RETURNED,
			MetricsType::SYSTEM_PEAK_BUFFER_MEMORY,
			MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE,
			MetricsType::TOTAL_BYTES_READ,
			MetricsType::TOTAL_BYTES_WRITTEN,
			MetricsType::WAITING_TO_ATTACH_LATENCY,
			};
	case MetricGroup::DEFAULT:
		return {
			MetricsType::CPU_TIME,
			MetricsType::CUMULATIVE_CARDINALITY,
			MetricsType::CUMULATIVE_ROWS_SCANNED,
			MetricsType::EXTRA_INFO,
			MetricsType::LATENCY,
			MetricsType::QUERY_NAME,
			MetricsType::RESULT_SET_SIZE,
			MetricsType::ROWS_RETURNED,
			};
	case MetricGroup::EXECUTION:
		return {
			MetricsType::BLOCKED_THREAD_TIME,
			MetricsType::SYSTEM_PEAK_BUFFER_MEMORY,
			MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE,
			};
	case MetricGroup::FILE:
		return {
			MetricsType::ATTACH_LOAD_STORAGE_LATENCY,
			MetricsType::ATTACH_REPLAY_WAL_LATENCY,
			MetricsType::CHECKPOINT_LATENCY,
			MetricsType::TOTAL_BYTES_READ,
			MetricsType::TOTAL_BYTES_WRITTEN,
			MetricsType::WAITING_TO_ATTACH_LATENCY,
			};
	case MetricGroup::OPERATOR:
		return {
			MetricsType::OPERATOR_CARDINALITY,
			MetricsType::OPERATOR_NAME,
			MetricsType::OPERATOR_ROWS_SCANNED,
			MetricsType::OPERATOR_TIMING,
			MetricsType::OPERATOR_TYPE,
			};
	case MetricGroup::OPTIMIZER:
		return {
			MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE,
			MetricsType::OPTIMIZER_COLUMN_LIFETIME,
			MetricsType::OPTIMIZER_COMMON_AGGREGATE,
			MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS,
			MetricsType::OPTIMIZER_COMMON_SUBPLAN,
			MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION,
			MetricsType::OPTIMIZER_CTE_FILTER_PUSHER,
			MetricsType::OPTIMIZER_CTE_INLINING,
			MetricsType::OPTIMIZER_DELIMINATOR,
			MetricsType::OPTIMIZER_DUPLICATE_GROUPS,
			MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP,
			MetricsType::OPTIMIZER_EXPRESSION_REWRITER,
			MetricsType::OPTIMIZER_EXTENSION,
			MetricsType::OPTIMIZER_FILTER_PULLUP,
			MetricsType::OPTIMIZER_FILTER_PUSHDOWN,
			MetricsType::OPTIMIZER_IN_CLAUSE,
			MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN,
			MetricsType::OPTIMIZER_JOIN_ORDER,
			MetricsType::OPTIMIZER_LATE_MATERIALIZATION,
			MetricsType::OPTIMIZER_LIMIT_PUSHDOWN,
			MetricsType::OPTIMIZER_MATERIALIZED_CTE,
			MetricsType::OPTIMIZER_REGEX_RANGE,
			MetricsType::OPTIMIZER_REORDER_FILTER,
			MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN,
			MetricsType::OPTIMIZER_STATISTICS_PROPAGATION,
			MetricsType::OPTIMIZER_SUM_REWRITER,
			MetricsType::OPTIMIZER_TOP_N,
			MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION,
			MetricsType::OPTIMIZER_UNNEST_REWRITER,
			MetricsType::OPTIMIZER_UNUSED_COLUMNS,
			};
	case MetricGroup::PHASE_TIMING:
		return {
			MetricsType::ALL_OPTIMIZERS,
			MetricsType::CUMULATIVE_OPTIMIZER_TIMING,
			MetricsType::PHYSICAL_PLANNER,
			MetricsType::PHYSICAL_PLANNER_COLUMN_BINDING,
			MetricsType::PHYSICAL_PLANNER_CREATE_PLAN,
			MetricsType::PHYSICAL_PLANNER_RESOLVE_TYPES,
			MetricsType::PLANNER,
			MetricsType::PLANNER_BINDING,
			};
	default:
		throw InternalException("The MetricGroup passed is invalid");
	}
}
profiler_settings_t MetricsUtils::GetDefaultMetrics() {
	return {
		MetricsType::CPU_TIME,
		MetricsType::CUMULATIVE_CARDINALITY,
		MetricsType::CUMULATIVE_ROWS_SCANNED,
		MetricsType::EXTRA_INFO,
		MetricsType::LATENCY,
		MetricsType::QUERY_NAME,
		MetricsType::RESULT_SET_SIZE,
		MetricsType::ROWS_RETURNED,
	};
}

bool MetricsUtils::IsDefaultMetric(MetricsType type) {
	switch(type) {
		case MetricsType::CPU_TIME:
		case MetricsType::CUMULATIVE_CARDINALITY:
		case MetricsType::CUMULATIVE_ROWS_SCANNED:
		case MetricsType::EXTRA_INFO:
		case MetricsType::LATENCY:
		case MetricsType::QUERY_NAME:
		case MetricsType::RESULT_SET_SIZE:
		case MetricsType::ROWS_RETURNED:
			return true;
		default:
			return false;
	}
}

profiler_settings_t MetricsUtils::GetExecutionMetrics() {
	return {
		MetricsType::BLOCKED_THREAD_TIME,
		MetricsType::SYSTEM_PEAK_BUFFER_MEMORY,
		MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE,
	};
}

bool MetricsUtils::IsExecutionMetric(MetricsType type) {
	switch(type) {
		case MetricsType::BLOCKED_THREAD_TIME:
		case MetricsType::SYSTEM_PEAK_BUFFER_MEMORY:
		case MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE:
			return true;
		default:
			return false;
	}
}

profiler_settings_t MetricsUtils::GetFileMetrics() {
	return {
		MetricsType::ATTACH_LOAD_STORAGE_LATENCY,
		MetricsType::ATTACH_REPLAY_WAL_LATENCY,
		MetricsType::CHECKPOINT_LATENCY,
		MetricsType::TOTAL_BYTES_READ,
		MetricsType::TOTAL_BYTES_WRITTEN,
		MetricsType::WAITING_TO_ATTACH_LATENCY,
	};
}

bool MetricsUtils::IsFileMetric(MetricsType type) {
	switch(type) {
		case MetricsType::ATTACH_LOAD_STORAGE_LATENCY:
		case MetricsType::ATTACH_REPLAY_WAL_LATENCY:
		case MetricsType::CHECKPOINT_LATENCY:
		case MetricsType::TOTAL_BYTES_READ:
		case MetricsType::TOTAL_BYTES_WRITTEN:
		case MetricsType::WAITING_TO_ATTACH_LATENCY:
			return true;
		default:
			return false;
	}
}

profiler_settings_t MetricsUtils::GetOperatorMetrics() {
	return {
		MetricsType::OPERATOR_CARDINALITY,
		MetricsType::OPERATOR_NAME,
		MetricsType::OPERATOR_ROWS_SCANNED,
		MetricsType::OPERATOR_TIMING,
		MetricsType::OPERATOR_TYPE,
	};
}

bool MetricsUtils::IsOperatorMetric(MetricsType type) {
	switch(type) {
		case MetricsType::OPERATOR_CARDINALITY:
		case MetricsType::OPERATOR_NAME:
		case MetricsType::OPERATOR_ROWS_SCANNED:
		case MetricsType::OPERATOR_TIMING:
		case MetricsType::OPERATOR_TYPE:
			return true;
		default:
			return false;
	}
}

profiler_settings_t MetricsUtils::GetOptimizerMetrics() {
	return {
		MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE,
		MetricsType::OPTIMIZER_COLUMN_LIFETIME,
		MetricsType::OPTIMIZER_COMMON_AGGREGATE,
		MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS,
		MetricsType::OPTIMIZER_COMMON_SUBPLAN,
		MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION,
		MetricsType::OPTIMIZER_CTE_FILTER_PUSHER,
		MetricsType::OPTIMIZER_CTE_INLINING,
		MetricsType::OPTIMIZER_DELIMINATOR,
		MetricsType::OPTIMIZER_DUPLICATE_GROUPS,
		MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP,
		MetricsType::OPTIMIZER_EXPRESSION_REWRITER,
		MetricsType::OPTIMIZER_EXTENSION,
		MetricsType::OPTIMIZER_FILTER_PULLUP,
		MetricsType::OPTIMIZER_FILTER_PUSHDOWN,
		MetricsType::OPTIMIZER_IN_CLAUSE,
		MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN,
		MetricsType::OPTIMIZER_JOIN_ORDER,
		MetricsType::OPTIMIZER_LATE_MATERIALIZATION,
		MetricsType::OPTIMIZER_LIMIT_PUSHDOWN,
		MetricsType::OPTIMIZER_MATERIALIZED_CTE,
		MetricsType::OPTIMIZER_REGEX_RANGE,
		MetricsType::OPTIMIZER_REORDER_FILTER,
		MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN,
		MetricsType::OPTIMIZER_STATISTICS_PROPAGATION,
		MetricsType::OPTIMIZER_SUM_REWRITER,
		MetricsType::OPTIMIZER_TOP_N,
		MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION,
		MetricsType::OPTIMIZER_UNNEST_REWRITER,
		MetricsType::OPTIMIZER_UNUSED_COLUMNS,
	};
}

bool MetricsUtils::IsOptimizerMetric(MetricsType type) {
	switch(type) {
		case MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE:
		case MetricsType::OPTIMIZER_COLUMN_LIFETIME:
		case MetricsType::OPTIMIZER_COMMON_AGGREGATE:
		case MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS:
		case MetricsType::OPTIMIZER_COMMON_SUBPLAN:
		case MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION:
		case MetricsType::OPTIMIZER_CTE_FILTER_PUSHER:
		case MetricsType::OPTIMIZER_CTE_INLINING:
		case MetricsType::OPTIMIZER_DELIMINATOR:
		case MetricsType::OPTIMIZER_DUPLICATE_GROUPS:
		case MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP:
		case MetricsType::OPTIMIZER_EXPRESSION_REWRITER:
		case MetricsType::OPTIMIZER_EXTENSION:
		case MetricsType::OPTIMIZER_FILTER_PULLUP:
		case MetricsType::OPTIMIZER_FILTER_PUSHDOWN:
		case MetricsType::OPTIMIZER_IN_CLAUSE:
		case MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN:
		case MetricsType::OPTIMIZER_JOIN_ORDER:
		case MetricsType::OPTIMIZER_LATE_MATERIALIZATION:
		case MetricsType::OPTIMIZER_LIMIT_PUSHDOWN:
		case MetricsType::OPTIMIZER_MATERIALIZED_CTE:
		case MetricsType::OPTIMIZER_REGEX_RANGE:
		case MetricsType::OPTIMIZER_REORDER_FILTER:
		case MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN:
		case MetricsType::OPTIMIZER_STATISTICS_PROPAGATION:
		case MetricsType::OPTIMIZER_SUM_REWRITER:
		case MetricsType::OPTIMIZER_TOP_N:
		case MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION:
		case MetricsType::OPTIMIZER_UNNEST_REWRITER:
		case MetricsType::OPTIMIZER_UNUSED_COLUMNS:
			return true;
		default:
			return false;
	}
}

MetricsType MetricsUtils::GetOptimizerMetricByType(OptimizerType type) {
	switch(type) {
		case OptimizerType::BUILD_SIDE_PROBE_SIDE:
			return MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE;
		case OptimizerType::COLUMN_LIFETIME:
			return MetricsType::OPTIMIZER_COLUMN_LIFETIME;
		case OptimizerType::COMMON_AGGREGATE:
			return MetricsType::OPTIMIZER_COMMON_AGGREGATE;
		case OptimizerType::COMMON_SUBEXPRESSIONS:
			return MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS;
		case OptimizerType::COMMON_SUBPLAN:
			return MetricsType::OPTIMIZER_COMMON_SUBPLAN;
		case OptimizerType::COMPRESSED_MATERIALIZATION:
			return MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION;
		case OptimizerType::CTE_FILTER_PUSHER:
			return MetricsType::OPTIMIZER_CTE_FILTER_PUSHER;
		case OptimizerType::CTE_INLINING:
			return MetricsType::OPTIMIZER_CTE_INLINING;
		case OptimizerType::DELIMINATOR:
			return MetricsType::OPTIMIZER_DELIMINATOR;
		case OptimizerType::DUPLICATE_GROUPS:
			return MetricsType::OPTIMIZER_DUPLICATE_GROUPS;
		case OptimizerType::EMPTY_RESULT_PULLUP:
			return MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP;
		case OptimizerType::EXPRESSION_REWRITER:
			return MetricsType::OPTIMIZER_EXPRESSION_REWRITER;
		case OptimizerType::EXTENSION:
			return MetricsType::OPTIMIZER_EXTENSION;
		case OptimizerType::FILTER_PULLUP:
			return MetricsType::OPTIMIZER_FILTER_PULLUP;
		case OptimizerType::FILTER_PUSHDOWN:
			return MetricsType::OPTIMIZER_FILTER_PUSHDOWN;
		case OptimizerType::IN_CLAUSE:
			return MetricsType::OPTIMIZER_IN_CLAUSE;
		case OptimizerType::JOIN_FILTER_PUSHDOWN:
			return MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN;
		case OptimizerType::JOIN_ORDER:
			return MetricsType::OPTIMIZER_JOIN_ORDER;
		case OptimizerType::LATE_MATERIALIZATION:
			return MetricsType::OPTIMIZER_LATE_MATERIALIZATION;
		case OptimizerType::LIMIT_PUSHDOWN:
			return MetricsType::OPTIMIZER_LIMIT_PUSHDOWN;
		case OptimizerType::MATERIALIZED_CTE:
			return MetricsType::OPTIMIZER_MATERIALIZED_CTE;
		case OptimizerType::REGEX_RANGE:
			return MetricsType::OPTIMIZER_REGEX_RANGE;
		case OptimizerType::REORDER_FILTER:
			return MetricsType::OPTIMIZER_REORDER_FILTER;
		case OptimizerType::SAMPLING_PUSHDOWN:
			return MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN;
		case OptimizerType::STATISTICS_PROPAGATION:
			return MetricsType::OPTIMIZER_STATISTICS_PROPAGATION;
		case OptimizerType::SUM_REWRITER:
			return MetricsType::OPTIMIZER_SUM_REWRITER;
		case OptimizerType::TOP_N:
			return MetricsType::OPTIMIZER_TOP_N;
		case OptimizerType::TOP_N_WINDOW_ELIMINATION:
			return MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION;
		case OptimizerType::UNNEST_REWRITER:
			return MetricsType::OPTIMIZER_UNNEST_REWRITER;
		case OptimizerType::UNUSED_COLUMNS:
			return MetricsType::OPTIMIZER_UNUSED_COLUMNS;
		default:
			throw InternalException("OptimizerType %s cannot be converted to a MetricsType", EnumUtil::ToString(type));
	}
}

OptimizerType MetricsUtils::GetOptimizerTypeByMetric(MetricsType type) {
	switch(type) {
		case MetricsType::OPTIMIZER_BUILD_SIDE_PROBE_SIDE:
			return OptimizerType::BUILD_SIDE_PROBE_SIDE;
		case MetricsType::OPTIMIZER_COLUMN_LIFETIME:
			return OptimizerType::COLUMN_LIFETIME;
		case MetricsType::OPTIMIZER_COMMON_AGGREGATE:
			return OptimizerType::COMMON_AGGREGATE;
		case MetricsType::OPTIMIZER_COMMON_SUBEXPRESSIONS:
			return OptimizerType::COMMON_SUBEXPRESSIONS;
		case MetricsType::OPTIMIZER_COMMON_SUBPLAN:
			return OptimizerType::COMMON_SUBPLAN;
		case MetricsType::OPTIMIZER_COMPRESSED_MATERIALIZATION:
			return OptimizerType::COMPRESSED_MATERIALIZATION;
		case MetricsType::OPTIMIZER_CTE_FILTER_PUSHER:
			return OptimizerType::CTE_FILTER_PUSHER;
		case MetricsType::OPTIMIZER_CTE_INLINING:
			return OptimizerType::CTE_INLINING;
		case MetricsType::OPTIMIZER_DELIMINATOR:
			return OptimizerType::DELIMINATOR;
		case MetricsType::OPTIMIZER_DUPLICATE_GROUPS:
			return OptimizerType::DUPLICATE_GROUPS;
		case MetricsType::OPTIMIZER_EMPTY_RESULT_PULLUP:
			return OptimizerType::EMPTY_RESULT_PULLUP;
		case MetricsType::OPTIMIZER_EXPRESSION_REWRITER:
			return OptimizerType::EXPRESSION_REWRITER;
		case MetricsType::OPTIMIZER_EXTENSION:
			return OptimizerType::EXTENSION;
		case MetricsType::OPTIMIZER_FILTER_PULLUP:
			return OptimizerType::FILTER_PULLUP;
		case MetricsType::OPTIMIZER_FILTER_PUSHDOWN:
			return OptimizerType::FILTER_PUSHDOWN;
		case MetricsType::OPTIMIZER_IN_CLAUSE:
			return OptimizerType::IN_CLAUSE;
		case MetricsType::OPTIMIZER_JOIN_FILTER_PUSHDOWN:
			return OptimizerType::JOIN_FILTER_PUSHDOWN;
		case MetricsType::OPTIMIZER_JOIN_ORDER:
			return OptimizerType::JOIN_ORDER;
		case MetricsType::OPTIMIZER_LATE_MATERIALIZATION:
			return OptimizerType::LATE_MATERIALIZATION;
		case MetricsType::OPTIMIZER_LIMIT_PUSHDOWN:
			return OptimizerType::LIMIT_PUSHDOWN;
		case MetricsType::OPTIMIZER_MATERIALIZED_CTE:
			return OptimizerType::MATERIALIZED_CTE;
		case MetricsType::OPTIMIZER_REGEX_RANGE:
			return OptimizerType::REGEX_RANGE;
		case MetricsType::OPTIMIZER_REORDER_FILTER:
			return OptimizerType::REORDER_FILTER;
		case MetricsType::OPTIMIZER_SAMPLING_PUSHDOWN:
			return OptimizerType::SAMPLING_PUSHDOWN;
		case MetricsType::OPTIMIZER_STATISTICS_PROPAGATION:
			return OptimizerType::STATISTICS_PROPAGATION;
		case MetricsType::OPTIMIZER_SUM_REWRITER:
			return OptimizerType::SUM_REWRITER;
		case MetricsType::OPTIMIZER_TOP_N:
			return OptimizerType::TOP_N;
		case MetricsType::OPTIMIZER_TOP_N_WINDOW_ELIMINATION:
			return OptimizerType::TOP_N_WINDOW_ELIMINATION;
		case MetricsType::OPTIMIZER_UNNEST_REWRITER:
			return OptimizerType::UNNEST_REWRITER;
		case MetricsType::OPTIMIZER_UNUSED_COLUMNS:
			return OptimizerType::UNUSED_COLUMNS;
		default:
			return OptimizerType::INVALID;
	}
}

profiler_settings_t MetricsUtils::GetPhaseTimingMetrics() {
	return {
		MetricsType::ALL_OPTIMIZERS,
		MetricsType::CUMULATIVE_OPTIMIZER_TIMING,
		MetricsType::PHYSICAL_PLANNER,
		MetricsType::PHYSICAL_PLANNER_COLUMN_BINDING,
		MetricsType::PHYSICAL_PLANNER_CREATE_PLAN,
		MetricsType::PHYSICAL_PLANNER_RESOLVE_TYPES,
		MetricsType::PLANNER,
		MetricsType::PLANNER_BINDING,
	};
}

bool MetricsUtils::IsPhaseTimingMetric(MetricsType type) {
	switch(type) {
		case MetricsType::ALL_OPTIMIZERS:
		case MetricsType::CUMULATIVE_OPTIMIZER_TIMING:
		case MetricsType::PHYSICAL_PLANNER:
		case MetricsType::PHYSICAL_PLANNER_COLUMN_BINDING:
		case MetricsType::PHYSICAL_PLANNER_CREATE_PLAN:
		case MetricsType::PHYSICAL_PLANNER_RESOLVE_TYPES:
		case MetricsType::PLANNER:
		case MetricsType::PLANNER_BINDING:
			return true;
		default:
			return false;
	}
}

profiler_settings_t MetricsUtils::GetRootScopeMetrics() {
	return {
		MetricsType::ATTACH_LOAD_STORAGE_LATENCY,
		MetricsType::ATTACH_REPLAY_WAL_LATENCY,
		MetricsType::BLOCKED_THREAD_TIME,
		MetricsType::CHECKPOINT_LATENCY,
		MetricsType::LATENCY,
		MetricsType::QUERY_NAME,
		MetricsType::ROWS_RETURNED,
		MetricsType::SYSTEM_PEAK_BUFFER_MEMORY,
		MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE,
		MetricsType::TOTAL_BYTES_READ,
		MetricsType::TOTAL_BYTES_WRITTEN,
		MetricsType::WAITING_TO_ATTACH_LATENCY,
	};
}

bool MetricsUtils::IsRootScopeMetric(MetricsType type) {
	switch(type) {
		case MetricsType::ATTACH_LOAD_STORAGE_LATENCY:
		case MetricsType::ATTACH_REPLAY_WAL_LATENCY:
		case MetricsType::BLOCKED_THREAD_TIME:
		case MetricsType::CHECKPOINT_LATENCY:
		case MetricsType::LATENCY:
		case MetricsType::QUERY_NAME:
		case MetricsType::ROWS_RETURNED:
		case MetricsType::SYSTEM_PEAK_BUFFER_MEMORY:
		case MetricsType::SYSTEM_PEAK_TEMP_DIR_SIZE:
		case MetricsType::TOTAL_BYTES_READ:
		case MetricsType::TOTAL_BYTES_WRITTEN:
		case MetricsType::WAITING_TO_ATTACH_LATENCY:
			return true;
		default:
			return false;
	}
}

}
