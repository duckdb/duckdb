//===----------------------------------------------------------------------===//
// This file is automatically generated by scripts/generate_serialization.py
// Do not edit this file manually, your changes will be overwritten
//===----------------------------------------------------------------------===//

#include "duckdb/common/serializer/serializer.hpp"
#include "duckdb/common/serializer/deserializer.hpp"
#include "duckdb/parser/query_node/list.hpp"

namespace duckdb {

void QueryNode::Serialize(Serializer &serializer) const {
	serializer.WriteProperty(100, "type", type);
	serializer.WriteProperty(101, "modifiers", modifiers);
	serializer.WriteProperty(102, "cte_map", cte_map);
}

unique_ptr<QueryNode> QueryNode::Deserialize(Deserializer &deserializer) {
	auto type = deserializer.ReadProperty<QueryNodeType>(100, "type");
	auto modifiers = deserializer.ReadProperty<vector<unique_ptr<ResultModifier>>>(101, "modifiers");
	auto cte_map = deserializer.ReadProperty<CommonTableExpressionMap>(102, "cte_map");
	unique_ptr<QueryNode> result;
	switch (type) {
	case QueryNodeType::CTE_NODE:
		result = CTENode::Deserialize(deserializer);
		break;
	case QueryNodeType::RECURSIVE_CTE_NODE:
		result = RecursiveCTENode::Deserialize(deserializer);
		break;
	case QueryNodeType::SELECT_NODE:
		result = SelectNode::Deserialize(deserializer);
		break;
	case QueryNodeType::SET_OPERATION_NODE:
		result = SetOperationNode::Deserialize(deserializer);
		break;
	default:
		throw SerializationException("Unsupported type for deserialization of QueryNode!");
	}
	result->modifiers = std::move(modifiers);
	result->cte_map = std::move(cte_map);
	return result;
}

void CTENode::Serialize(Serializer &serializer) const {
	QueryNode::Serialize(serializer);
	serializer.WriteProperty(200, "cte_name", ctename);
	serializer.WriteProperty(201, "query", query);
	serializer.WriteProperty(202, "child", child);
	serializer.WriteProperty(203, "aliases", aliases);
}

unique_ptr<QueryNode> CTENode::Deserialize(Deserializer &deserializer) {
	auto result = duckdb::unique_ptr<CTENode>(new CTENode());
	deserializer.ReadProperty(200, "cte_name", result->ctename);
	deserializer.ReadProperty(201, "query", result->query);
	deserializer.ReadProperty(202, "child", result->child);
	deserializer.ReadProperty(203, "aliases", result->aliases);
	return std::move(result);
}

void RecursiveCTENode::Serialize(Serializer &serializer) const {
	QueryNode::Serialize(serializer);
	serializer.WriteProperty(200, "cte_name", ctename);
	serializer.WriteProperty(201, "union_all", union_all);
	serializer.WriteProperty(202, "left", left);
	serializer.WriteProperty(203, "right", right);
	serializer.WriteProperty(204, "aliases", aliases);
}

unique_ptr<QueryNode> RecursiveCTENode::Deserialize(Deserializer &deserializer) {
	auto result = duckdb::unique_ptr<RecursiveCTENode>(new RecursiveCTENode());
	deserializer.ReadProperty(200, "cte_name", result->ctename);
	deserializer.ReadProperty(201, "union_all", result->union_all);
	deserializer.ReadProperty(202, "left", result->left);
	deserializer.ReadProperty(203, "right", result->right);
	deserializer.ReadProperty(204, "aliases", result->aliases);
	return std::move(result);
}

void SelectNode::Serialize(Serializer &serializer) const {
	QueryNode::Serialize(serializer);
	serializer.WriteProperty(200, "select_list", select_list);
	serializer.WritePropertyWithDefault(201, "from_table", from_table, unique_ptr<TableRef>());
	serializer.WritePropertyWithDefault(202, "where_clause", where_clause, unique_ptr<ParsedExpression>());
	serializer.WriteProperty(203, "group_expressions", groups.group_expressions);
	serializer.WriteProperty(204, "group_sets", groups.grouping_sets);
	serializer.WriteProperty(205, "aggregate_handling", aggregate_handling);
	serializer.WritePropertyWithDefault(206, "having", having, unique_ptr<ParsedExpression>());
	serializer.WritePropertyWithDefault(207, "sample", sample, unique_ptr<SampleOptions>());
	serializer.WritePropertyWithDefault(208, "qualify", qualify, unique_ptr<ParsedExpression>());
}

unique_ptr<QueryNode> SelectNode::Deserialize(Deserializer &deserializer) {
	auto result = duckdb::unique_ptr<SelectNode>(new SelectNode());
	deserializer.ReadProperty(200, "select_list", result->select_list);
	deserializer.ReadPropertyWithDefault(201, "from_table", result->from_table, unique_ptr<TableRef>());
	deserializer.ReadPropertyWithDefault(202, "where_clause", result->where_clause, unique_ptr<ParsedExpression>());
	deserializer.ReadProperty(203, "group_expressions", result->groups.group_expressions);
	deserializer.ReadProperty(204, "group_sets", result->groups.grouping_sets);
	deserializer.ReadProperty(205, "aggregate_handling", result->aggregate_handling);
	deserializer.ReadPropertyWithDefault(206, "having", result->having, unique_ptr<ParsedExpression>());
	deserializer.ReadPropertyWithDefault(207, "sample", result->sample, unique_ptr<SampleOptions>());
	deserializer.ReadPropertyWithDefault(208, "qualify", result->qualify, unique_ptr<ParsedExpression>());
	return std::move(result);
}

void SetOperationNode::Serialize(Serializer &serializer) const {
	QueryNode::Serialize(serializer);
	serializer.WriteProperty(200, "setop_type", setop_type);
	serializer.WriteProperty(201, "left", left);
	serializer.WriteProperty(202, "right", right);
}

unique_ptr<QueryNode> SetOperationNode::Deserialize(Deserializer &deserializer) {
	auto result = duckdb::unique_ptr<SetOperationNode>(new SetOperationNode());
	deserializer.ReadProperty(200, "setop_type", result->setop_type);
	deserializer.ReadProperty(201, "left", result->left);
	deserializer.ReadProperty(202, "right", result->right);
	return std::move(result);
}

} // namespace duckdb
