//===----------------------------------------------------------------------===//
//
//                         DuckDB
//
// duckdb/common/enums/metric_type.hpp
//
// This file is automatically generated by scripts/generate_metric_enums.py
// Do not edit this file manually, your changes will be overwritten
//===----------------------------------------------------------------------===//

#pragma once

#include "duckdb/common/types/value.hpp"
#include "duckdb/common/unordered_set.hpp"
#include "duckdb/common/constants.hpp"
#include "duckdb/common/enums/optimizer_type.hpp"

namespace duckdb {

enum class MetricGroup : uint8_t {
	ALL,
	CORE,
	DEFAULT,
	EXECUTION,
	FILE,
	OPERATOR,
	OPTIMIZER,
	PHASE_TIMING,
	INVALID,
};

enum class MetricType : uint8_t {
	// DOUBLE
	START_DOUBLE = 0,
	ALL_OPTIMIZERS = START_DOUBLE,
	ATTACH_LOAD_STORAGE_LATENCY,
	ATTACH_REPLAY_WAL_LATENCY,
	BLOCKED_THREAD_TIME,
	CHECKPOINT_LATENCY,
	COMMIT_LOCAL_STORAGE_LATENCY,
	CPU_TIME,
	CUMULATIVE_OPTIMIZER_TIMING,
	LATENCY,
	OPERATOR_TIMING,
	PHYSICAL_PLANNER,
	PHYSICAL_PLANNER_COLUMN_BINDING,
	PHYSICAL_PLANNER_CREATE_PLAN,
	PHYSICAL_PLANNER_RESOLVE_TYPES,
	PLANNER,
	PLANNER_BINDING,
	WAITING_TO_ATTACH_LATENCY,
	WRITE_TO_WAL_LATENCY,
	END_DOUBLE = WRITE_TO_WAL_LATENCY,
	// UINT64
	START_UINT64 = END_DOUBLE,
	CUMULATIVE_CARDINALITY = START_UINT64,
	CUMULATIVE_ROWS_SCANNED,
	OPERATOR_CARDINALITY,
	OPERATOR_ROWS_SCANNED,
	RESULT_SET_SIZE,
	ROWS_RETURNED,
	SYSTEM_PEAK_BUFFER_MEMORY,
	SYSTEM_PEAK_TEMP_DIR_SIZE,
	TOTAL_BYTES_READ,
	TOTAL_BYTES_WRITTEN,
	TOTAL_MEMORY_ALLOCATED,
	WAL_REPLAY_ENTRY_COUNT,
	END_UINT64 = WAL_REPLAY_ENTRY_COUNT,
	// MAP
	START_MAP = END_UINT64,
	EXTRA_INFO = START_MAP,
	END_MAP = EXTRA_INFO,
	// STRING
	START_STRING = END_MAP,
	OPERATOR_NAME = START_STRING,
	QUERY_NAME,
	END_STRING = QUERY_NAME,
	// UINT8
	START_UINT8 = END_STRING,
	OPERATOR_TYPE = START_UINT8,
	END_UINT8 = OPERATOR_TYPE,
};

struct MetricTypeHashFunction {
    uint64_t operator()(const MetricType &index) const {
        return std::hash<uint8_t>()(static_cast<uint8_t>(index));
    }
};

typedef unordered_set<MetricType, MetricTypeHashFunction> profiler_settings_t;
typedef unordered_map<MetricType, Value, MetricTypeHashFunction> profiler_metrics_t;

class MetricsUtils {
public:
	static constexpr const idx_t DOUBLE_METRIC_COUNT = 18;
	static constexpr const idx_t UINT64_METRIC_COUNT = 12;
	static constexpr const idx_t MAP_METRIC_COUNT = 1;
	static constexpr const idx_t STRING_METRIC_COUNT = 2;
	static constexpr const idx_t UINT8_METRIC_COUNT = 1;

public:

	// All metrics
	static profiler_settings_t GetAllMetrics();
	static profiler_settings_t GetMetricsByGroupType(MetricGroup type);

	// Core metrics
	static profiler_settings_t GetCoreMetrics();
	static bool IsCoreMetric(MetricType type);

	// Default metrics
	static profiler_settings_t GetDefaultMetrics();
	static bool IsDefaultMetric(MetricType type);

	// Execution metrics
	static profiler_settings_t GetExecutionMetrics();
	static bool IsExecutionMetric(MetricType type);

	// File metrics
	static profiler_settings_t GetFileMetrics();
	static bool IsFileMetric(MetricType type);

	// Operator metrics
	static profiler_settings_t GetOperatorMetrics();
	static bool IsOperatorMetric(MetricType type);

	// Optimizer metrics
	static profiler_settings_t GetOptimizerMetrics();
	static bool IsOptimizerMetric(MetricType type);
	static MetricType GetOptimizerMetricByType(OptimizerType type);
	static OptimizerType GetOptimizerTypeByMetric(MetricType type);

	// PhaseTiming metrics
	static profiler_settings_t GetPhaseTimingMetrics();
	static bool IsPhaseTimingMetric(MetricType type);

	// RootScope metrics
	static profiler_settings_t GetRootScopeMetrics();
	static bool IsRootScopeMetric(MetricType type);
};
} // namespace duckdb
