diff --git a/src/include/storage/postgres_delete.hpp b/src/include/storage/postgres_delete.hpp
index e709cee..4e878de 100644
--- a/src/include/storage/postgres_delete.hpp
+++ b/src/include/storage/postgres_delete.hpp
@@ -22,7 +22,7 @@ public:
 
 public:
 	// Source interface
-	SourceResultType GetData(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
+	SourceResultType GetDataInternal(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
 
 	bool IsSource() const override {
 		return true;
diff --git a/src/include/storage/postgres_index.hpp b/src/include/storage/postgres_index.hpp
index 47c46c0..76593a0 100644
--- a/src/include/storage/postgres_index.hpp
+++ b/src/include/storage/postgres_index.hpp
@@ -24,7 +24,7 @@ public:
 
 public:
 	// Source interface
-	SourceResultType GetData(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
+	SourceResultType GetDataInternal(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
 
 	bool IsSource() const override {
 		return true;
diff --git a/src/include/storage/postgres_insert.hpp b/src/include/storage/postgres_insert.hpp
index d22b4f1..4bd0e29 100644
--- a/src/include/storage/postgres_insert.hpp
+++ b/src/include/storage/postgres_insert.hpp
@@ -35,7 +35,7 @@ public:
 
 public:
 	// Source interface
-	SourceResultType GetData(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
+	SourceResultType GetDataInternal(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
 
 	bool IsSource() const override {
 		return true;
diff --git a/src/include/storage/postgres_optimizer.hpp b/src/include/storage/postgres_optimizer.hpp
index 1e573f0..832a5d8 100644
--- a/src/include/storage/postgres_optimizer.hpp
+++ b/src/include/storage/postgres_optimizer.hpp
@@ -9,6 +9,7 @@
 #pragma once
 
 #include "duckdb/main/config.hpp"
+#include "duckdb/optimizer/optimizer_extension.hpp"
 
 namespace duckdb {
 
diff --git a/src/include/storage/postgres_update.hpp b/src/include/storage/postgres_update.hpp
index 12b5e5e..dd25e75 100644
--- a/src/include/storage/postgres_update.hpp
+++ b/src/include/storage/postgres_update.hpp
@@ -29,7 +29,7 @@ public:
 
 public:
 	// Source interface
-	SourceResultType GetData(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
+	SourceResultType GetDataInternal(ExecutionContext &context, DataChunk &chunk, OperatorSourceInput &input) const override;
 
 	bool IsSource() const override {
 		return true;
diff --git a/src/postgres_extension.cpp b/src/postgres_extension.cpp
index 4246555..95b0112 100644
--- a/src/postgres_extension.cpp
+++ b/src/postgres_extension.cpp
@@ -160,7 +160,7 @@ static void LoadInternal(ExtensionLoader &loader) {
 	loader.RegisterFunction(postgres_secret_function);
 
 	auto &config = DBConfig::GetConfig(loader.GetDatabaseInstance());
-	config.storage_extensions["postgres_scanner"] = make_uniq<PostgresStorageExtension>();
+	StorageExtension::Register(config, "postgres_scanner", make_shared_ptr<PostgresStorageExtension>());
 
 	config.AddExtensionOption("pg_use_binary_copy", "Whether or not to use BINARY copy to read data",
 	                          LogicalType::BOOLEAN, Value::BOOLEAN(true));
@@ -190,9 +190,9 @@ static void LoadInternal(ExtensionLoader &loader) {
 
 	OptimizerExtension postgres_optimizer;
 	postgres_optimizer.optimize_function = PostgresOptimizer::Optimize;
-	config.optimizer_extensions.push_back(std::move(postgres_optimizer));
+	OptimizerExtension::Register(config, std::move(postgres_optimizer));
 
-	config.extension_callbacks.push_back(make_uniq<PostgresExtensionCallback>());
+	ExtensionCallback::Register(config, make_shared_ptr<PostgresExtensionCallback>());
 	for (auto &connection : ConnectionManager::Get(loader.GetDatabaseInstance()).GetConnectionList()) {
 		connection->registered_state->Insert("postgres_extension", make_shared_ptr<PostgresExtensionState>());
 	}
diff --git a/src/postgres_storage.cpp b/src/postgres_storage.cpp
index cfff746..7963170 100644
--- a/src/postgres_storage.cpp
+++ b/src/postgres_storage.cpp
@@ -1,5 +1,5 @@
 #include "duckdb.hpp"
-
+#include "duckdb/main/settings.hpp"
 #include "postgres_storage.hpp"
 #include "storage/postgres_catalog.hpp"
 #include "duckdb/parser/parsed_data/attach_info.hpp"
@@ -10,8 +10,7 @@ namespace duckdb {
 static unique_ptr<Catalog> PostgresAttach(optional_ptr<StorageExtensionInfo> storage_info, ClientContext &context,
                                           AttachedDatabase &db, const string &name, AttachInfo &info,
                                           AttachOptions &attach_options) {
-	auto &config = DBConfig::GetConfig(context);
-	if (!config.options.enable_external_access) {
+	if (!Settings::Get<EnableExternalAccessSetting>(context)) {
 		throw PermissionException("Attaching Postgres databases is disabled through configuration");
 	}
 	string attach_path = info.path;
diff --git a/src/storage/postgres_delete.cpp b/src/storage/postgres_delete.cpp
index 8e1c014..b50fbc1 100644
--- a/src/storage/postgres_delete.cpp
+++ b/src/storage/postgres_delete.cpp
@@ -96,7 +96,7 @@ SinkFinalizeType PostgresDelete::Finalize(Pipeline &pipeline, Event &event, Clie
 //===--------------------------------------------------------------------===//
 // GetData
 //===--------------------------------------------------------------------===//
-SourceResultType PostgresDelete::GetData(ExecutionContext &context, DataChunk &chunk,
+SourceResultType PostgresDelete::GetDataInternal(ExecutionContext &context, DataChunk &chunk,
                                          OperatorSourceInput &input) const {
 	auto &insert_gstate = sink_state->Cast<PostgresDeleteGlobalState>();
 	chunk.SetCardinality(1);
diff --git a/src/storage/postgres_index.cpp b/src/storage/postgres_index.cpp
index d2de80e..eae13de 100644
--- a/src/storage/postgres_index.cpp
+++ b/src/storage/postgres_index.cpp
@@ -20,7 +20,7 @@ PostgresCreateIndex::PostgresCreateIndex(PhysicalPlan &physical_plan, unique_ptr
 //===--------------------------------------------------------------------===//
 // Source
 //===--------------------------------------------------------------------===//
-SourceResultType PostgresCreateIndex::GetData(ExecutionContext &context, DataChunk &chunk,
+SourceResultType PostgresCreateIndex::GetDataInternal(ExecutionContext &context, DataChunk &chunk,
                                               OperatorSourceInput &input) const {
 	auto &catalog = table.catalog;
 	auto &schema = table.schema;
diff --git a/src/storage/postgres_index_set.cpp b/src/storage/postgres_index_set.cpp
index aacdb83..f49a233 100644
--- a/src/storage/postgres_index_set.cpp
+++ b/src/storage/postgres_index_set.cpp
@@ -4,6 +4,7 @@
 #include "duckdb/parser/parsed_data/create_schema_info.hpp"
 #include "storage/postgres_index_entry.hpp"
 #include "duckdb/parser/parsed_expression_iterator.hpp"
+#include "duckdb/parser/expression/columnref_expression.hpp"
 
 namespace duckdb {
 
diff --git a/src/storage/postgres_insert.cpp b/src/storage/postgres_insert.cpp
index e3961e4..385351d 100644
--- a/src/storage/postgres_insert.cpp
+++ b/src/storage/postgres_insert.cpp
@@ -148,7 +148,7 @@ SinkFinalizeType PostgresInsert::Finalize(Pipeline &pipeline, Event &event, Clie
 //===--------------------------------------------------------------------===//
 // GetData
 //===--------------------------------------------------------------------===//
-SourceResultType PostgresInsert::GetData(ExecutionContext &context, DataChunk &chunk,
+SourceResultType PostgresInsert::GetDataInternal(ExecutionContext &context, DataChunk &chunk,
                                          OperatorSourceInput &input) const {
 	auto &insert_gstate = sink_state->Cast<PostgresInsertGlobalState>();
 	chunk.SetCardinality(1);
diff --git a/src/storage/postgres_update.cpp b/src/storage/postgres_update.cpp
index 8c3b8a3..6a22b81 100644
--- a/src/storage/postgres_update.cpp
+++ b/src/storage/postgres_update.cpp
@@ -177,7 +177,7 @@ SinkFinalizeType PostgresUpdate::Finalize(Pipeline &pipeline, Event &event, Clie
 //===--------------------------------------------------------------------===//
 // GetData
 //===--------------------------------------------------------------------===//
-SourceResultType PostgresUpdate::GetData(ExecutionContext &context, DataChunk &chunk,
+SourceResultType PostgresUpdate::GetDataInternal(ExecutionContext &context, DataChunk &chunk,
                                          OperatorSourceInput &input) const {
 	auto &insert_gstate = sink_state->Cast<PostgresUpdateGlobalState>();
 	chunk.SetCardinality(1);
